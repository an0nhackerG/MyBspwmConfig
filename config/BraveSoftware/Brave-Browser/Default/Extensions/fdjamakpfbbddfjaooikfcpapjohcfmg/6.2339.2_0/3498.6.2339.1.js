"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[3498],{628722:(e,t,a)=>{a.r(t),a.d(t,{IdCardEditPanel:()=>E,IdGroupTab:()=>_});var i=a(696832),n=a(382706),r=a(66941),s=a(343966),o=a(157631),l=a(469869),c=a(126750);const d={HEADER_DESCRIPTION:"webapp_id_edition_idcard_header_description",DIALOG_DELETE_TITLE:"webapp_id_edition_idcard_dialog_delete_title",ALERT_DELETE:"webapp_id_edition_idcard_alert_delete",ALERT_EDIT:"webapp_id_edition_idcard_alert_edit",COPY_SUCCESS:"webapp_id_copy_success_id_card_number"},u=e=>async()=>(await r.C.deleteIdCard({id:e})).success,m=(e,t)=>a=>{const i=(0,o.h)(t,a,s.jx),{expirationDate:n,issueDate:l}=i;return r.C.editIdCard({...i,expirationDate:n?Date.parse(n)/1e3:void 0,issueDate:l?Date.parse(l)/1e3:void 0,name:i.idName,id:e})};let _;!function(e){e[e.DETAILS=0]="DETAILS",e[e.ATTACHMENTS=1]="ATTACHMENTS"}(_||(_={}));const E=({listRoute:e,id:t,setDialogActive:a,lee:r,hasUnsavedData:s,setHasUnsavedData:o})=>t?i.createElement(c.y,{listRoute:e,id:`{${t}}`,setDialogActive:a,lee:r,hasUnsavedData:s,setHasUnsavedData:o,ID_TYPE:n.U.IdCard,I18N_KEYS:d,deleteItem:u,editItem:m},(({handleCopy:e,values:t})=>i.createElement(l.P,{variant:"edit",handleCopy:e,country:t.country}))):null},126750:(e,t,a)=>{a.d(t,{y:()=>x});var i=a(696832),n=a(148038),r=a(201389),s=a(723815),o=a(799852),l=a(382706),c=a(448430);const d={[l.U.DriversLicense]:"driversLicensesResult",[l.U.FiscalId]:"fiscalIdsResult",[l.U.IdCard]:"idCardsResult",[l.U.Passport]:"passportsResult",[l.U.SocialSecurityId]:"socialSecurityIdsResult"};var u=a(592233),m=a(111768),_=a(635164),E=a(62429),p=a(900125),D=a(702394),I=a(450582),T=a(628722),b=a(65255),f=a(915970);const C=e=>`id-edit-panel-${e}`,h=e=>{const t=window.sessionStorage.getItem(C(e));return t?parseInt(t,10):null};var g,A,L=a(238250),S=a(854169),y=a(5727),w=a(441217);const v=({formId:e,handleCancel:t,handleDelete:a,hasDataBeenModified:i,isSubmitting:n,focusAttachmentTab:s})=>{const{translate:o}=(0,r.Z)();return(0,y.tZ)(w.Ejs,{sx:{padding:"24px"},as:"footer",justifyContent:"flex-start",flexDirection:"row",flexWrap:"nowrap"},(0,y.tZ)(w.zxk,{nature:"secondary",onClick:a,type:"button",disabled:n,sx:{marginRight:"16px"}},g||(g=(0,y.tZ)(w.XHJ,null)),o("webapp_panel_edition_generic_delete")),!!s&&(0,y.tZ)(w.zxk,{key:"attach",nature:"secondary",onClick:s,type:"button"},A||(A=(0,y.tZ)(w.FKb,null)),o("webapp_secure_notes_add_attachment_action_name")),i?(0,y.tZ)(w.Ejs,{flexDirection:"row",flexWrap:"nowrap",sx:{marginLeft:"auto"}},(0,y.tZ)(w.zxk,{type:"submit",form:e,disabled:n},o("webapp_panel_edition_generic_save_changes")),(0,y.tZ)(w.zxk,{sx:{marginLeft:"16px"},nature:"secondary",onClick:t,type:"button"},o("webapp_panel_edition_generic_cancel_changes"))):(0,y.tZ)(w.zxk,{nature:"secondary",onClick:t,type:"button",sx:{marginLeft:"auto"}},o("webapp_panel_edition_generic_close")))};var R=a(276846);const U="id-edit-form",N=({itemId:e,type:t,editItem:a,openConfirmDeleteDialog:n,editAlertTranslation:s,reportError:o,initialValues:l,hasUnsavedData:c,setHasUnsavedData:d,setCurrentCountry:_,copySuccessKey:p,hasTabs:D,focusAttachment:I,children:T,showListView:b})=>{const{translate:f}=(0,r.Z)(),[C,h]=i.useState(!1),g=i.useRef((e=>{if(null!==e){const{dirty:t,isSubmitting:a,values:i}=e;d(t),h(a),_(i.country)}})),{showToast:A}=(0,m.pm)(),y=(a,i)=>{(0,E.Kz)(new u.UserCopyVaultItemFieldEvent({itemType:S.L[t],field:S.H[t],itemId:e,isProtected:!1})),a&&A({description:f(p)}),i&&"function"==typeof o&&o(i,"[id-form] Unable to copy to clipboard")};return i.createElement(i.Fragment,null,i.createElement(R.P,{formId:U,formRef:g.current,handleSubmit:async(e,{setSubmitting:t,setFieldError:i})=>{try{t(!0);const n=await a(e);!0===n.success?(A({description:f(s)}),b()):(t(!1),n.error?.code===L.UpdateIdResultErrorCode.MISSING_ID_NUMBER?i("idNumber",""):n.error&&(A({description:f("_common_generic_error"),mood:"danger",isManualDismiss:!0}),o(new Error("[ids][edit] Unable to update id"),n.error.code)))}catch(e){t(!1),o(e,"[ids][edit] Unexpected exception while updating id")}},initialValues:l,variant:"edit"},(e=>T({handleCopy:y,values:e}))),i.createElement(v,{formId:U,handleCancel:()=>{b()},handleDelete:n,hasDataBeenModified:c,isSubmitting:C,focusAttachmentTab:D?I:void 0}))},G={DIALOG_DELETE_SUBTITLE:"webapp_id_edition_dialog_delete_subtitle",DIALOG_DELETE_DISMISS:"webapp_id_edition_dialog_delete_dismiss",DIALOG_DELETE_CONFIRM:"webapp_id_edition_dialog_delete_confirm",GENERIC_ERROR:"_common_generic_error"};function P({getDescription:e,title:t,...a}){const{translate:n}=(0,r.Z)(),{item:s,initialValues:o,type:c,children:d,showConfirmDelete:g,closeConfirmDeleteDialog:A,deleteDialogTitle:L,deleteItem:S,deleteAlertTranslation:y,listRoute:w}=a,{hasTabs:v,activeTab:R,tabs:U,focusAttachment:P,cleanActiveTab:k}=function(e){var t;const a=(0,f.w)(b.w.TechweekWebAttachmentsForIdsV1),n=(0,i.useRef)(null),[s,o]=(0,i.useState)(null!=(t=h(e))?t:T.IdGroupTab.DETAILS),l=(0,i.useCallback)((t=>{window.sessionStorage.setItem(C(e),t.toString()),o(t)}),[e]),c=(0,i.useCallback)((()=>{window.sessionStorage.removeItem(C(e))}),[e]),d=(0,i.useCallback)((()=>l(T.IdGroupTab.ATTACHMENTS)),[l]),{translate:u}=(0,r.Z)(),m=(0,i.useMemo)((()=>[{active:s===T.IdGroupTab.DETAILS,label:u("webapp_secure_notes_addition_tab_title_details"),onClick:()=>l(T.IdGroupTab.DETAILS)},{active:s===T.IdGroupTab.ATTACHMENTS,label:u("webapp_secure_notes_edition_field_tab_title_attachments"),onClick:d}]),[s,d,u,l]);return(0,i.useEffect)((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&c()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[c,n]),{editPanelRef:n,hasTabs:a,activeTab:s,tabs:m,focusAttachment:d,cleanActiveTab:c}}(s.id),[x,O]=i.useState(o.country);i.useEffect((()=>{(0,I.w)()}),[]),i.useEffect((()=>{const e={[l.U.DriversLicense]:u.PageView.ItemDriverLicenceDetails,[l.U.FiscalId]:u.PageView.ItemFiscalStatementDetails,[l.U.IdCard]:u.PageView.ItemIdCardDetails,[l.U.Passport]:u.PageView.ItemPassportDetails,[l.U.SocialSecurityId]:u.PageView.ItemSocialSecurityStatementDetails};(0,E.Nc)(e[c])}),[c]);const M=i.useMemo((()=>({confirmDeleteConfirm:n(G.DIALOG_DELETE_CONFIRM),confirmDeleteDismiss:n(G.DIALOG_DELETE_DISMISS),confirmDeleteSubtitle:n(G.DIALOG_DELETE_SUBTITLE),confirmDeleteTitle:n(L)})),[L,n]),{showToast:Z}=(0,m.pm)(),H=()=>{k(),(0,E.Nc)(u.PageView.ItemIdList),(0,_.uX)(w)},V=!v||T.IdGroupTab.DETAILS===R;return i.createElement(i.Fragment,null,i.createElement(p.h,{country:x,description:e(x),title:t,type:c,tabs:v?U:void 0}),V?i.createElement(N,{...a,setCurrentCountry:O,hasTabs:v,focusAttachment:P,cleanActiveTab:k,showListView:H},d):null,g?i.createElement(D.h,{closeConfirmDeleteDialog:A,onDeleteConfirm:async function(){let e;try{e=await S()}catch(t){e=!1}e?(Z({description:n(y)}),H()):Z({description:n(G.GENERIC_ERROR),mood:"danger",isManualDismiss:!0})},translations:M}):null)}var k=a(157631);const x=({ID_TYPE:e,I18N_KEYS:t,listRoute:a,id:l,setDialogActive:u,lee:m,hasUnsavedData:_,setHasUnsavedData:E,deleteItem:p,editItem:D,children:I})=>{const{translate:T}=(0,r.Z)(),{status:b,item:f}=function(e,t){const{status:a,data:i}=(0,o.k)(c.L,"query",{vaultItemTypes:[e],ids:[t]});return{status:a,item:i?.[d[e]].items[0]}}(e,l),{showConfirmDelete:C,openConfirmDeleteDialog:h,closeConfirmDeleteDialog:g}=function(e){const[t,a]=i.useState(!1);return{showConfirmDelete:t,openConfirmDeleteDialog:()=>{a(!0),e(!0)},closeConfirmDeleteDialog:()=>{a(!1),e(!1)}}}(u);return b===n.rq.Success&&void 0!==f?i.createElement(P,{itemId:l,item:f,copySuccessKey:t.COPY_SUCCESS,deleteAlertTranslation:t.ALERT_DELETE,deleteDialogTitle:t.DIALOG_DELETE_TITLE,deleteItem:p(f.id),editAlertTranslation:t.ALERT_EDIT,editItem:D(f.id,f),initialValues:f,listRoute:a,reportError:m.reportError,showConfirmDelete:C,openConfirmDeleteDialog:h,closeConfirmDeleteDialog:g,hasUnsavedData:_,setHasUnsavedData:E,type:e,getDescription:e=>(0,s.Il)(T(t.HEADER_DESCRIPTION),T.getLocale(),e),title:(0,k.Y)(f)},I):null}},157631:(e,t,a)=>{a.d(t,{Y:()=>r,h:()=>i});const i=(e,t,a)=>{const i={};return a.forEach((a=>{e[a]!==t[a]&&(i[a]=t[a])})),i};function n(e,t){return e.hasOwnProperty(t)}function r(e){return n(e,"idName")?e.idName:n(e,"idNumber")?e.idNumber:e.fiscalNumber}},479055:(e,t,a)=>{a.d(t,{a:()=>n});var i=a(453576);const n=new Set([i.Country.AU,i.Country.GB,i.Country.IE,i.Country.NZ])},469869:(e,t,a)=>{a.d(t,{P:()=>_});var i,n,r=a(696832),s=a(201389),o=a(778089),l=a(803057),c=a(479055),d=a(754171),u=a(670570);const m={...d.k},_=r.memo((({variant:e,handleCopy:t,country:a})=>{const{translate:d}=(0,s.Z)(),_=r.useRef(null);return r.useEffect("add"===e?()=>{const e=setTimeout((()=>{_.current?.focus()}),o.sc);return()=>clearTimeout(e)}:()=>{},[]),r.createElement(r.Fragment,null,r.createElement(u.YI,{name:"idName",label:d(m.NAME_LABEL),placeholder:d(m.NAME_PLACEHOLDER),ref:_}),r.createElement(u.G1,{name:"idNumber",label:d(m.ID_NUMBER_LABEL),placeholder:d(m.ID_NUMBER_PLACEHOLDER),handleCopy:"edit"===e?t:void 0}),r.createElement(u.Nn,{name:"issueDate",label:d(m.ISSUE_DATE_LABEL)}),r.createElement(u.Nn,{name:"expirationDate",label:d(c.a.has(a)?m.EXPIRATION_DATE_LABEL_UK:m.EXPIRATION_DATE_LABEL_US)}),r.createElement(u.Dz,{name:"country",label:d(m.COUNTRY_LABEL)}),i||(i=r.createElement(l.c,{height:24})),n||(n=r.createElement(u.A0,{name:"spaceId"})))}))},702394:(e,t,a)=>{a.d(t,{Z:()=>d,h:()=>c});var i=a(696832),n=a(111768),r=a(159515),s=a(151796),o=a(201389),l=a(177704);const c=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:a})=>{const{translate:r}=(0,o.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:c,confirmDeleteDismiss:d,confirmDeleteConfirm:u}=a;return i.createElement(n.Vq,{title:c,onClose:e,isOpen:!0,dialogClassName:l.Ht,closeActionLabel:r("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:u,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:d,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}}},s)},d=({reason:e,translations:t,goToSharingAccess:a,closeCantDeleteDialog:l})=>{const{translate:c}=(0,o.Z)(),d=((e,t)=>{const{groupSharingTitle:a,lastAdminTitle:i,genericErrorTitle:n}=e;switch(t){case r.J.LastAdmin:return i;case r.J.GroupSharing:return a;case r.J.Generic:return n;default:return(0,s.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:a,lastAdminSubtitle:i,genericErrorSubtitle:n}=e;switch(t){case r.J.LastAdmin:return i;case r.J.GroupSharing:return a;case r.J.Generic:return n;default:return(0,s.U)(t)}})(t,e);return i.createElement(n.Vq,{isOpen:!0,onClose:l,title:null!=d?d:"",closeActionLabel:c("_common_dialog_dismiss_button"),actions:e===r.J.LastAdmin?{primary:{children:t.lastAdminActionLabel,onClick:a}}:void 0},u)}},159515:(e,t,a)=>{let i;a.d(t,{J:()=>i}),function(e){e[e.LastAdmin=0]="LastAdmin",e[e.GroupSharing=1]="GroupSharing",e[e.Generic=2]="Generic"}(i||(i={}))}}]);