"use strict";(self.webpackChunk_dashlane_amphora=self.webpackChunk_dashlane_amphora||[]).push([[280],{55328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchABTestingVersionDetails=void 0;const o=r(95623),a=r(50884);t.fetchABTestingVersionDetails=(e,t)=>{const r=e.storeService,i={capacity:"",language:r.getPlatform().info.lang,platform:"real_website"};return t?.abTestForcedVersion&&(i.forceVersion3=t.abTestForcedVersion),e.wsService.premium.getABTestingVersionDetails(i).then((e=>{r.dispatch((0,a.saveABTestingInfo)(e))})).catch((e=>{o.default.error("Carbon init - Error while calling getABTestingVersionDetails: ",e)}))}},35673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(92082),a=r(72525),i=r(62627);t.config={commands:{participateToUserABTest:{handler:a.participateToUserABTest}},queries:{getUserABTestVariant:{selector:i.userABTestVariantSelector}},liveQueries:{liveUserABTestVariant:{operator:o.userABTestVariant$}}}},50884:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveABTestingInfo=t.SAVE_ABTESTING_INFO=void 0,t.SAVE_ABTESTING_INFO="SAVE_ABTESTING_INFO";t.saveABTestingInfo=e=>({type:t.SAVE_ABTESTING_INFO,data:Object.assign({},e)})},34007:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyABTesting=void 0;const o=r(50884);function a(){return{details:[],version:"control2016_all",success:null}}t.default=(e={details:[],version:"control2016_all",success:null},t)=>t.type===o.SAVE_ABTESTING_INFO?Object.assign({},e,{...t.data}):e,t.getEmptyABTesting=a},80755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(35673);t.bootstrap=e=>{e.register(o.config)}},8481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshUserABTest=void 0;const o=r(41075),a=r(70252),i=r(90503),n=r(30913),s=r(46298),c=r(43416),l=r(9272),d=r(25899);t.refreshUserABTest=async function(e,t,r){try{const a=(0,n.abTestsNamesSelector)(e.getState());if(0===a.length)return;const i=await(0,o.getAndEvaluateForUser)(e,r,{abtests:a});if((0,s.isApiError)(i))throw new Error(`Failed to refresh user AB tests: ${i}`);const u=(0,l.mapGetUserABServerResponse)(a,i.abtests);e.dispatch((0,c.refreshedUserABTests)(u)),(0,d.persistUserTests)(t,e)}catch(e){const t=new Error(`[ABTests] - refreshUserABTest: ${e}`);(0,a.sendExceptionLog)({error:t,code:i.ExceptionCriticality.WARNING})}}},21587:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(80755);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},92082:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariant$=void 0;const o=r(18948),a=r(3343),i=r(62627);t.userABTestVariant$=e=>(0,o.pipe)((0,a.map)((t=>(0,i.userABTestVariantSelector)(t,e))),(0,a.distinctUntilChanged)())},9272:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapGetUserABServerResponse=t.NOT_PARTICIPATING=void 0,t.NOT_PARTICIPATING="not-participating",t.mapGetUserABServerResponse=function(e,r){return e.reduce(((e,o)=>{const a=r.find((e=>o===e.name));return e[o]=a?{variant:a.variant,version:a.abtestVersion}:{variant:t.NOT_PARTICIPATING},e}),{})}},72525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.participateToUserABTest=void 0;const o=r(62627),a=r(9272),i=r(25899);t.participateToUserABTest=async function(e,t){const r=(0,o.userABTestSelector)(e.storeService.getState(),t);r&&a.NOT_PARTICIPATING!==r.variant&&(0,i.persistUserTests)(e.localStorageService.getInstance(),e.storeService)}},25899:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserTests=void 0;const o=r(25576),a=r(62627);t.persistUserTests=async function(e,t){if(t.getAccountInfo().persistData===o.PersistData.PERSIST_DATA_NO)return Promise.resolve();e&&await e.storeUserABTests((0,a.userABTestsSelector)(t.getState()))}},52346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(18216),a=r(55328),i=r(9486);t.setupSubscriptions=function(e,t){e.appInitialized.on((async e=>{if(e.initMode===o.InitMode.FirstInit){await(0,a.fetchABTestingVersionDetails)(t,{abTestForcedVersion:e.abTestForcedVersion});const r=t.storeService.getABTesting();(0,i.triggerABTestingChanged)(r)}}))}},39811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(95667),a=r(88544),i=r(71594);t.config={commands:{editContactInfo:{handler:o.editContactInfoHandler}},queries:{getContactInfo:{selector:a.contactInfoSelector}},liveQueries:{liveContactInfo:{operator:i.contactInfo$}}}},13044:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(92925),t)},1463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(39811);t.bootstrap=e=>{e.register(o.config)}},66650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editContactInfoHandler=void 0;const o=r(92925),a=r(46298),i=r(45956),n=r(16593),s=r(5464),c={contact_email_required:o.EditContactInfoErrorCode.EMPTY_EMAIL,invalid_contact_email:o.EditContactInfoErrorCode.INVALID_EMAIL,UNKNOWN_ERROR:o.EditContactInfoErrorCode.UNKNOWN_ERROR};t.editContactInfoHandler=async function(e,t){const{storeService:r,wsService:l,sessionService:d}=e,u=r.getState(),p=(0,n.userLoginSelector)(u);if(!r.isAuthenticated())return{success:!1,error:{code:o.EditContactInfoErrorCode.UNKNOWN_ERROR}};try{const e=await(0,a.updateContactInfo)(r,p,t);return(0,a.isApiError)(e)?{success:!1,error:{code:c[e.code]}}:(await(0,s.getAndTriggerRefreshAccountInfo)(r,d,l),{success:!0})}catch(e){return{success:!1,error:{code:c[i.UnknownError]}}}}},95667:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(66650),t)},64369:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0,a(r(13044),t);var i=r(1463);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},71594:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfo$=void 0;const o=r(18948),a=r(3343),i=r(88544);t.contactInfo$=()=>(0,o.pipe)((0,a.map)(i.contactInfoSelector),(0,a.distinctUntilChanged)())},88544:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfoSelector=void 0;t.contactInfoSelector=e=>e.userSession.accountContactInfo},92925:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditContactInfoErrorCode=void 0,function(e){e[e.EMPTY_EMAIL=0]="EMPTY_EMAIL",e[e.INVALID_EMAIL=1]="INVALID_EMAIL",e[e.UNKNOWN_ERROR=2]="UNKNOWN_ERROR"}(t.EditContactInfoErrorCode||(t.EditContactInfoErrorCode={}))},71703:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAccountCreationController=t.encryptSettings=t.checkLogin=void 0;const o=r(53576),a=r(70252),i=r(32074),n=r(39362),s=r(36513),c=r(43461),l=r(95551),d=r(58639),u=r(7624),p=r(16356),S=r(61259),g=r(95623),m=r(65675),y=r(16038),h=r(46298);async function v(e,t){g.default.log("AccountCreationController.checkLogin");const r="SSO_BLOCKED",a=await(0,h.requestAccountCreation)(e,{login:t});if((0,h.isApiError)(a)){if(a.code===r)return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_SSO_NON_PROVISIONED};throw new Error(`[AccountCreationController] - checkLogin: ${a.message} (${a.code})`)}if(a.ssoServiceProviderUrl)return e.dispatch((0,u.storeSSOSettings)({serviceProviderUrl:a.ssoServiceProviderUrl,isNitroProvider:a.ssoIsNitroProvider})),a.ssoIsNitroProvider?{accountCreationCode:o.AccountCreationCode.USER_NITRO_SSO_PROVISIONED,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted}:((0,S.triggerServiceProviderUrlRedirect)(e.getState(),t),{accountCreationCode:o.AccountCreationCode.USER_SSO_PROVISIONED,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted});switch(a.exists){case h.AccountExistsStatus.AccountExists:return{accountCreationCode:o.AccountCreationCode.USER_EXISTS,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted};case h.AccountExistsStatus.AccountDoesntExistInvalid:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted};case h.AccountExistsStatus.AccountDoesntExistUnlikely:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_UNLIKELY_MX,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted};case h.AccountExistsStatus.AccountDoesntExist:default:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST,isUserProposed:a.isProposed,isUserAccepted:a.isAccepted}}}function f(e,t,r){return Promise.resolve().then((()=>{const o=e.getStore(),a=i.encryptSettings(e,t,r);o.dispatch((0,c.saveAccountSettings)(a));const n=(0,s.makeCryptoService)(),u={cryptoConfig:(0,m.parsePayload)(a.personalSettings.CryptoUserPayload).cryptoConfig,forceSalt:(0,y.base64ToBuffer)(a.personalSettings.CryptoFixedSalt)},p={promise:(0,l.generateRsaKeys)(t,n,u)};e.dispatch((0,c.saveAccountKeys)(p));const S={encryptSettingsRequest:r,valid:!0};return d.sendEncryptSettingsResult(S),S})).catch((e=>{const t=new Error(`[AccountCreation] - encryptSettings: ${e}`);throw g.default.error(t),(0,a.sendExceptionLog)({error:t}),t}))}t.checkLogin=v,t.encryptSettings=f,t.makeAccountCreationController=function(e){return{checkLogin:t=>v(e.storeService,t),createAccount:t=>(e.storeService.dispatch((0,c.accountCreationStarted)({isSSO:!1})),e.sessionService.close().then((()=>{e.masterPasswordEncryptorService.setInstance({raw:t.password},"");const{storeService:r,masterPasswordEncryptorService:o}=e;return f(r,o,t)}))),confirmAccountCreation:t=>function(e,t){return Promise.resolve().then((()=>{const r=e.storeService.getStore().getState().userSession.accountCreation.settings.personalSettings,o=e.storeService.getAccountCreation(),a=o.settings.promise;if(null===a)throw new Error("createAccount should be call before confirmAccountCreation");const i=o.accountKey.promise;if(null===i)throw new Error("createAccount should be call before confirmAccountCreation");return n.createAccount(e,t,a,r,i).then((t=>(d.sendConfirmCreateAccountResult(t),e.storeService.dispatch((0,p.updateIsFirstSessionAfterAccountCreation)()),t)))})).catch((e=>{const t=new Error(`[AccountCreation] - confirmAccountCreation: ${e}`);throw g.default.error(t),(0,a.sendExceptionLog)({error:t}),t}))}(e,t)}}},85591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(47542);t.config={commands:{},queries:{},liveQueries:{liveAccountCreated:{subject:o.getAccountCreated$}}}},81867:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(85591);t.bootstrap=e=>{e.register(o.config)}},7502:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(81867);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},47542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emitAccountCreated=t.getAccountCreated$=void 0;const o=new(r(18948).Subject);t.getAccountCreated$=()=>o;t.emitAccountCreated=()=>o.next()},32074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSettings=void 0;const o=r(63713),a=r(75270),i=r(56668),n=r(91301),s=r(16038),c=r(55623),l=r(12706),d=r(95648),u=r(78320),p=r(53);t.encryptSettings=function(e,t,r){const S=(0,u.generateItemUuid)(),g=(0,p.getUnixTimestamp)(),m=(0,c.getRandomValues)(16),y=e.getState(),h=(0,l.isSSOAccountCreationSelector)(y)?n.CRYPTO_NODERIVATION_HMAC64:i.ARGON2_DEFAULT_PAYLOAD,v={...(0,d.makeBasePersonalSettings)(),AnonymousUserId:r.anonymousUserId,UsagelogToken:S,Format:r.format,Language:r.language,SecurityEmail:r.login,RealLogin:r.login,accountCreationDatetime:g,SyncBackup:!0,CryptoFixedSalt:(0,s.bufferToBase64)(m),CryptoUserPayload:h},f=(0,a.getTransactionXml)(v),A={time:(0,p.getUnixTimestamp)(),backupDate:0,type:"SETTINGS",action:"BACKUP_EDIT",identifier:"SETTINGS_userId",content:f},P={forceSalt:m};return{personalSettings:v,promise:o.encryptSingleTransaction(t,A,P)}}},751:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOAccount=t.prepareRemoteDataEncryptionServices=void 0;const o=r(28354),a=r(71703),i=r(39362),n=r(56915),s=r(56668),c=r(16038),l=r(64910),d=r(33769),u=r(69530),p=r(46298),S=r(70252),g=r(61259),m=r(92029),y=r(16356),h=r(43461);t.prepareRemoteDataEncryptionServices=async(e,t)=>{const r=(0,o.v4)(),{remoteDataEncryptorService:a,masterPasswordEncryptorService:i}=e,n=await(0,u.generate64BytesKey)(),p=(0,c.base64BufferToText)(n),S=await(0,u.generate64BytesKey)(),g=(0,c.bufferToBase64)(S),m=(0,c.base64ToBuffer)(t),h=(0,d.getEncryptionKeyBuffer)(m,S,{skipDerivation:!0}),v=(0,c.arrayBufferToText)(h),f=(0,l.getNoDerivationCryptoConfig)();i.setInstance({raw:v},"",f);const A=(0,s.utf16ToDeflatedUtf8)(p,{skipUtf8Encoding:!0,skipDeflate:!0}),P=await i.getInstance().encrypt(A);return a.setInstance({raw:p},"",f),e.storeService.dispatch((0,y.updateRemoteKey)(p)),{remoteKey:{uuid:r,key:P,type:"sso"},serverKeyBase64:g}},t.createSSOAccount=async function(e,r){const{sessionService:o,storeService:s,remoteDataEncryptorService:c}=e,{consents:l,deviceName:d,login:u,ssoServiceProviderKey:S,ssoToken:g,anonymousUserId:f}=r,{appVersion:A,country:P,lang:b,platformName:w}=(0,n.platformInfoSelector)(s.getState());await o.close(),s.dispatch((0,h.accountCreationStarted)({isSSO:!0}));const{remoteKey:T,serverKeyBase64:_}=await(0,t.prepareRemoteDataEncryptionServices)(e,S),I={anonymousUserId:f,deviceName:d,format:P,language:b,login:u,password:S,subscribe:l.find((({consentType:e})=>"emailsOffersAndTips"===e)).status||!1};await(0,a.encryptSettings)(s,c,I);const E=s.getAccountCreation(),{content:C,time:D}=await E.settings.promise,O=await E.accountKey.promise,M=(0,p.makeSafeCountry)(s.getLocation().country||P),N={login:u,contactEmail:u,appVersion:A,sdkVersion:"1.0.0.0",platform:w,settings:{content:C,time:D},consents:l,deviceName:d,country:M,osCountry:M,language:(0,p.makeSafeLanguage)(b),osLanguage:(0,p.makeSafeLanguage)(b),remoteKeys:[T],ssoServerKey:_,ssoToken:g,sharingKeys:{publicKey:O.keys.publicKey,privateKey:O.encryptedPrivateKey},temporaryDevice:!0},F=await(0,p.createUserWithSSO)(s,N);if((0,p.isApiError)(F))return v(F);const U={createAccountResult:{encryptSettingsRequest:I,valid:!0},options:{flowIndicator:"memberAccount"},isStandAlone:!1,consents:l};return await(0,i.firstSync)(e,U,F,{useRemoteKey:!0}),e.storeService.dispatch((0,y.updateAnalyticsIds)(F.userAnalyticsId,F.deviceAnalyticsId)),{success:!0,code:m.LoginViaSsoCode.SUCCESS}};const v=e=>{const{code:t,message:r}=e;switch(f(t),t){case p.DomainNotValidForTeam:case p.InvalidUser:case p.InvalidSsoToken:case p.NotProposedNeitherAccepted:case p.NoFreeSlot:return(0,g.makeReturnErrorObject)(m.LoginViaSsoCode.SSO_VERIFICATION_FAILED,r);default:return(0,g.makeReturnErrorObject)(m.LoginViaSsoCode.UNKNOWN_ERROR,r)}},f=e=>{const t=new Error(`[createSSOAccount] - createUserWithSSO: ${e}`);(0,S.sendExceptionLog)({error:t})}},39362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.firstSync=t.createAccount=void 0;const o=r(53576),a=r(92233),i=r(25963),n=r(37898),s=r(25576),c=r(88610),l=r(16356),d=r(78320),u=r(1347),p=r(27517),S=r(19399),g=r(58582),m=r(60946),y=r(41007),h=r(17936),v=r(92221),f=r(46298),A=r(92215),P=r(47542),b=r(51064);async function w(e,t,r,l={useRemoteKey:!1}){const p=t.createAccountResult,{login:f}=p.encryptSettingsRequest,P=(0,d.generateItemUuid)(),w=(0,u.getEmptyPersonalDataState)();w.emails.push({AnonId:(0,d.generateItemUuid)(),Email:f,EmailName:"Email 1",Id:P,kwType:"KWEmail",LastBackupTime:0,LocaleFormat:o.Country.UNIVERSAL,SpaceId:"",Type:"PERSO"}),w.changesToUpload.push((0,b.createUploadChange)({action:"EDIT",itemId:P,kwType:"KWEmail"}));const{monitor:T,getSyncEvent:_}=(0,y.makeEventLoggerSyncMonitor)(e.eventLoggerService,{sendLogOnSyncComplete:!1}),I=(0,m.setupProbe)(T,(0,h.makeDiagnosticReportMonitor)(),(0,v.makeSyncLoggerMonitor)()),E={accessKey:r.deviceAccessKey,secretKey:r.deviceSecretKey},C=(0,A.convertDeviceKeysToUki)(E),D=l.useRemoteKey?e.remoteDataEncryptorService:e.masterPasswordEncryptorService,O=Date.now(),M=n.SyncType.FULL_SYNC,N={storeService:e.storeService,dataEncryptorService:D,login:f,uki:C,lastSyncTimestamp:O,personalData:w,syncType:M,needsKeys:!1,ws:e.wsService,announce:I};let F=null;try{I(g.announcements.syncStarted(a.Trigger.AccountCreation,M),g.announcements.chronologicalSyncStarted(w)),F=await(0,i.sync)(N),I(g.announcements.chronologicalSyncFinished(F.summary),g.announcements.syncFinished())}catch(e){throw I(g.announcements.chronologicalSyncFailed(e),g.announcements.syncFailed(e)),e}if(t.isStandAlone){const t=(0,c.makeLoginController)(e);await t.loadAccountCreationInfos(f,p.encryptSettingsRequest.password,(0,S.secureDeviceName)(p.encryptSettingsRequest.deviceName),E,F.lastSyncTimestamp,s.PersistData.PERSIST_DATA_YES),await t.openSession(f,{password:p.encryptSettingsRequest.password})}const U=async function(e,t){return await e.logSync(new a.UserSyncEvent({duration:t.duration,error:t.error,extent:t.extent,fullBackupSize:t.fullBackupSize,incomingDeleteCount:t.incomingDeleteCount,incomingUpdateCount:t.incomingUpdateCount,outgoingDeleteCount:t.outgoingDeleteCount,outgoingUpdateCount:t.outgoingUpdateCount,timestamp:t.timestamp,trigger:t.trigger,treatProblem:t.treatProblem})),e.flushEventQueue()}(e.eventLoggerService,_());t.isStandAlone||await U}t.createAccount=async function(e,t,r,o,a){const i=e.storeService.getPlatform().info;if(!t.createAccountResult.valid)throw new Error("Account creation: Will not perform API request for invalidated settings promise");const[n,s]=await Promise.all([r,a]),c=await async function(e,t,r,o,a,i){const{storeService:n}=e,{createAccountResult:s}=r,c=e.storeService.getABTesting().version;let d=r.consents;Array.isArray(d)||(d=[{consentType:"emailsOffersAndTips",status:s.encryptSettingsRequest.subscribe}]);const u=s.encryptSettingsRequest.login,g={abTestingVersion:c,askM2dToken:!0,country:(0,f.makeSafeCountry)(e.storeService.getLocation().country||t.country),deviceName:(0,f.makeSafeDeviceName)((0,S.secureDeviceName)(s.encryptSettingsRequest.deviceName)),language:(0,f.makeSafeLanguage)(t.lang),login:u,osCountry:(0,f.makeSafeCountry)(t.country),osLanguage:(0,f.makeSafeLanguage)(t.lang),platform:t.platformName,settings:{content:a.content,time:a.time},appVersion:t.appVersion,contactEmail:u,consents:d,sharingKeys:{publicKey:i.keys.publicKey,privateKey:i.encryptedPrivateKey},temporaryDevice:!r.isStandAlone},m=await(0,f.createUser)(n,g);if((0,f.isApiError)(m))throw new Error(`[AccountCreation] - createAccountOnServer : ${m.message} (${m.code})`);return e.storeService.dispatch((0,l.updateKeyPair)({publicKey:i.keys.publicKey,privateKey:i.keys.privateKey})),e.storeService.dispatch((0,p.loadStoredPersonalSettings)(o)),e.storeService.dispatch((0,l.updateAnalyticsIds)(m.userAnalyticsId,m.deviceAnalyticsId)),m}(e,i,t,o,n,s);await w(e,t,c);const d=(0,A.convertDeviceKeysToUki)({accessKey:c.deviceAccessKey,secretKey:c.deviceSecretKey});return t.isStandAlone&&t.createAccountResult.valid&&(0,P.emitAccountCreated)(),{m2dToken:c.token,abtestingversion:c.abTestingVersion,uki:d,origin:c.origin,openSession:t.isStandAlone}},t.firstSync=w},85902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(22021),a=r(34913);t.config={commands:{},queries:{getSubscriptionCode:{selector:o.subscriptionCodeSelector}},liveQueries:{liveSubscriptionCode:{operator:a.subscriptionCode$}}}},68904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(85902);t.bootstrap=e=>{e.register(o.config)}},93820:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(68904);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},34913:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionCode$=void 0;const o=r(18948),a=r(3343),i=r(22021);t.subscriptionCode$=()=>(0,o.pipe)((0,a.map)(i.subscriptionCodeSelector),(0,a.distinctUntilChanged)())},22021:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionCodeSelector=void 0;t.subscriptionCodeSelector=e=>e.userSession.account.subscriptionCode},65725:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingConfig=void 0;const o=r(48331);t.AntiPhishingConfig={commands:{},queries:{},liveQueries:{livePhishingURLList:{operator:o.antiPhishingURLList$}}}},26404:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAntiPhishingURLList=t.UPDATE_ANTI_PHISHING_URL_LIST=void 0,t.UPDATE_ANTI_PHISHING_URL_LIST="UPDATE_ANTI_PHISHING_URL_LIST";t.updateAntiPhishingURLList=e=>({type:t.UPDATE_ANTI_PHISHING_URL_LIST,phishingURLList:e})},56666:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(65725);t.bootstrap=e=>{e.register(o.AntiPhishingConfig)}},77820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REMOTE_PHISHING_FILE=void 0,t.REMOTE_PHISHING_FILE="phishing_urls_test.json"},25560:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(56666);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},48331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLList$=void 0;const o=r(18948),a=r(3343),i=r(68769);t.antiPhishingURLList$=()=>(0,o.pipe)((0,a.map)(i.antiPhishingURLListSelector),(0,a.distinctUntilChanged)())},69018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingReducer=t.getEmptyAntiPhishingState=void 0;const o=r(26404);t.getEmptyAntiPhishingState=()=>new Set([]);t.AntiPhishingReducer=(e=(0,t.getEmptyAntiPhishingState)(),r)=>r.type===o.UPDATE_ANTI_PHISHING_URL_LIST?r.phishingURLList:e},68769:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLListSelector=void 0;t.antiPhishingURLListSelector=e=>e.device.antiPhishing},46564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(85318);t.setupSubscriptions=async function(e,t){e.remoteFileChanged.on((e=>(0,o.triggerUpdatePhishingURLFile)(t,e)))}},85318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerUpdatePhishingURLFile=void 0;const o=r(70252),a=r(96405),i=r(26404),n=r(77820);const s=async e=>{const t=await(0,a.fileContentStrSelector)(e,n.REMOTE_PHISHING_FILE),r=t?JSON.parse(t):[];if(1!==(i=r).fileFormat||!Array.isArray(i.domains)){const e=new Error("[Anti-Phishing]: File format is invalid");return(0,o.sendExceptionLog)(e),null}var i;return{domains:new Set(r.domains),fileFormat:r.fileFormat}};t.triggerUpdatePhishingURLFile=async function(e,t){const{storeService:r}=e,o=r.getState();if(t===n.REMOTE_PHISHING_FILE){const e=await s(o);e&&r.dispatch((0,i.updateAntiPhishingURLList)(e.domains))}}},7036:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.connectLazySlot=void 0;const o=r(4939),a=["API","Live"];t.connectLazySlot=(e,t,r=!1)=>{const i=new Map;return e.lazy((n=>{r&&(0,o.logInfo)({message:`${e.slotName} subscribed on param ${n}`,tag:a});const s=t(n),c=((e,t,r,i)=>e?e=>((0,o.logInfo)({message:`Emitting on ${t.slotName} with param ${r}`,tag:a,details:{event:e}}),i(e)):i)(r,e,n,(t=>e(n,t).catch((()=>{})))),l=s.subscribe(c);i.set(n,l)}),(t=>{const n=i.get(t);n?(r&&(0,o.logInfo)({message:`${e.slotName} unsubscribed on param ${t}`,tag:a}),n.unsubscribe(),i.delete(t)):r&&(0,o.logWarn)({message:`Cannot unsubscribe from ${e.slotName} on param ${t}: subscription not found.`,tag:a})}))}},31249:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(66508),t)},50643:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.apiEvents=void 0;var o=r(31249);Object.defineProperty(t,"apiEvents",{enumerable:!0,get:function(){return o.apiEvents}})},38250:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(41248),t),a(r(36540),t),a(r(62922),t),a(r(90678),t),a(r(13044),t),a(r(61380),t),a(r(39319),t),a(r(37148),t),a(r(96463),t),a(r(7279),t),a(r(45968),t),a(r(6629),t),a(r(66869),t),a(r(83042),t),a(r(18982),t),a(r(41346),t),a(r(71661),t),a(r(45923),t),a(r(72658),t),a(r(40941),t),a(r(79562),t),a(r(42331),t),a(r(92987),t),a(r(35240),t),a(r(82481),t),a(r(69335),t),a(r(3790),t),a(r(74536),t)},2246:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncAppSetting=t.setDataDEBUGONLY=t.decipherApplicationSettings=t.loadAppSettings=t.getCommonAppSettings=t.getCommonAppSetting=t.storeCommonAppSetting=t.getUsersWithPublicSettings=t.deleteUsersPublicSettings=t.getUserPublicSetting=t.storeUserPublicSetting=t.initApplicationSettings=void 0;const o=r(95623),a=r(72365),i=r(56668),n=r(1860),s=r(80722),c=r(2356),l=r(30913),d=r(18216);let u=null,p=null,S=null;function g(){if(!S)throw new Error("ApplicationSettings not initialized");const e=(0,l.commonApplicationSettingsSelector)(S.getState());return e||{}}t.initApplicationSettings=function(e,t,r,o){return u=e,p=o&&o.dataEncryptorService||(0,n.makeKeyDataEncryptorService)(),S=t,(0,a.setObfuscatingKey)(p),r===d.InitMode.FirstInit?(o?.settings&&t.dispatch((0,c.storeApplicationSettings)(o.settings)),h()):Promise.resolve()},t.storeUserPublicSetting=function(e,t,r){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.storeUserPublicSetting)(e,{[t]:r})),y()},t.getUserPublicSetting=function(e,t){if(!S)throw new Error("ApplicationSettings not initialized");const r=(0,l.userPublicSettingsSelector)(S.getState(),e);return r&&r.hasOwnProperty(t)?r[t]:null},t.deleteUsersPublicSettings=async function(e){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.deleteUserPublicSettings)(e)),y()},t.getUsersWithPublicSettings=function(){if(!S)throw new Error("ApplicationSettings not initialized");return Object.keys((0,l.publicUsersSettingsSelector)(S.getState()))},t.storeCommonAppSetting=function(e,t){return g()[e]=t,y()},t.getCommonAppSetting=function(e){const t=g();return t.hasOwnProperty(e)?(t[e],t[e]):null},t.getCommonAppSettings=g;const m="ApplicationSettings.cdata";function y(){if(!S||!u||!p)throw new Error("ApplicationSettings not initialized");const e=u.getLocalStorage(),t={publicUsersSettings:(0,l.publicUsersSettingsSelector)(S.getState()),commonApplicationSettings:(0,l.commonApplicationSettingsSelector)(S.getState())||{}},r=JSON.stringify(t),o=(0,i.utf16ToDeflatedUtf8)(r);return p.getInstance().encrypt(o).then((t=>e.writeItem(m,t))).then((()=>{}))}function h(){if(!u||!p)throw new Error("ApplicationSettings not initialized");o.default.log("loadApplicationSettings");const e=u.getLocalStorage();return e.itemExists(m).then((t=>(o.default.log("loadApplicationSettings "+t),t?e.readItem(m).then((e=>{if(o.default.log("appSettings read"),o.default.log(e),null==e)throw new Error("storing empty or null value is not authorized");if("string"!=typeof e)throw new Error("value of ApplicationSettings.cdata is expected to be a string");return v(p,e).then((e=>JSON.parse(e))).then((e=>{f(e)}))})):f({publicUsersSettings:{},commonApplicationSettings:{}})))).catch((e=>{o.default.error(e,"loadAppSettings"),f({publicUsersSettings:{},commonApplicationSettings:{}})}))}function v(e,t){return e.getInstance().decrypt(t).then((e=>(0,i.deflatedUtf8ToUtf16)(e))).catch((()=>{const e=(0,a.makeDataEncryptorService)((0,s.makeStoreService)());return(0,a.setObfuscatingKey)(e),e.getInstance().decrypt(t).then((e=>(0,i.deflatedUtf8ToUtf16)(e)))}))}function f(e){if(!S)throw new Error("ApplicationSettings not initialized");o.default.log(`ApplicationSettings loaded for deviceId: ${e.commonApplicationSettings.deviceId}`),S.dispatch((0,c.storeApplicationSettings)(e))}t.loadAppSettings=h,t.decipherApplicationSettings=v,t.setDataDEBUGONLY=function(e){if(!S)throw new Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))},t.getSyncAppSetting=function(e){const t=function(){if(!S)throw new Error("ApplicationSettings not initialized");return S.getState().device.application.settings.sync}();return t.hasOwnProperty(e)?t[e]:null}},30096:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdInitialized=t.APP_SESSION_ID_INITIALIZED=void 0,t.APP_SESSION_ID_INITIALIZED="APP_SESSION_ID_INITIALIZED";t.appSessionIdInitialized=e=>({type:t.APP_SESSION_ID_INITIALIZED,appSessionId:e})},10319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applicationReducer=t.getEmptyApplicationSessionState=void 0;const o=r(82422),a=r(59600),i=r(30096);t.getEmptyApplicationSessionState=()=>({appSessionId:void 0});t.applicationReducer=(0,o.combineReducers)({appSession:(e=(0,t.getEmptyApplicationSessionState)(),r)=>r.type===i.APP_SESSION_ID_INITIALIZED?{...e,appSessionId:r.appSessionId}:e,settings:a.default})},28486:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdSelector=void 0;t.appSessionIdSelector=e=>e.device.application.appSession.appSessionId},2356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUserPublicSettings=t.storeUserPublicSetting=t.storeApplicationSettings=t.DELETE_USER_PUBLIC_SETTINGS=t.STORE_USER_PUBLIC_SETTING=t.STORE_APPLICATION_SETTINGS=void 0,t.STORE_APPLICATION_SETTINGS="STORE_APPLICATION_SETTINGS",t.STORE_USER_PUBLIC_SETTING="STORE_USER_PUBLIC_SETTING",t.DELETE_USER_PUBLIC_SETTINGS="DELETE_USER_PUBLIC_SETTINGS";t.storeApplicationSettings=e=>({type:t.STORE_APPLICATION_SETTINGS,settings:e});t.storeUserPublicSetting=(e,r)=>({type:t.STORE_USER_PUBLIC_SETTING,login:e,userSettings:r});t.deleteUserPublicSettings=e=>({type:t.DELETE_USER_PUBLIC_SETTINGS,logins:e})},59600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyApplicationSettings=t.ApplicationBuildType=void 0;const o=r(2356);!function(e){e.DEV="DEV",e.QA="QA",e.NIGHTLY="NIGHTLY",e.BETA="BETA",e.PRODUCTION="PRODUCTION"}(t.ApplicationBuildType||(t.ApplicationBuildType={}));t.getEmptyApplicationSettings=()=>({sync:{syncWithLocalClients:!1},userABTestNames:[],migratedToSAEX:void 0,desktopLogin:void 0,buildType:void 0,publicUsersSettings:void 0,commonApplicationSettings:void 0}),t.default=(e=(0,t.getEmptyApplicationSettings)(),r)=>{switch(r.type){case o.STORE_APPLICATION_SETTINGS:return{...e,...r.settings||{}};case o.STORE_USER_PUBLIC_SETTING:{const t=r.login,o=e.publicUsersSettings??{},a={...o,[t]:{...o[t]??{},...r.userSettings}};return{...e,publicUsersSettings:a}}case o.DELETE_USER_PUBLIC_SETTINGS:{const t=r.logins,o=Object.keys(e.publicUsersSettings??{}),a=t.filter((e=>o.includes(e.trim())));return 0===a.length||a.forEach((t=>{const r=t.trim();delete e.publicUsersSettings[r]})),{...e}}default:return e}}},30913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commonApplicationSettingsSelector=t.publicUsersSettingsSelector=t.userPublicSettingsSelector=t.applicationBuildTypeSelector=t.migratedToSAEXSelector=t.abTestsNamesSelector=void 0;const r={};t.abTestsNamesSelector=e=>e.device.application.settings.userABTestNames;t.migratedToSAEXSelector=e=>e.device.application.settings.migratedToSAEX;t.applicationBuildTypeSelector=e=>e.device.application.settings.buildType;t.userPublicSettingsSelector=(e,t)=>e.device.application.settings.publicUsersSettings?.[t];t.publicUsersSettingsSelector=e=>e.device.application.settings.publicUsersSettings??r;t.commonApplicationSettingsSelector=e=>e.device.application.settings.commonApplicationSettings},87855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureDeviceId=t.initAuthenticatedCarbonApplication=void 0;const o=r(28354),a=r(2246),i=r(95623),n=r(17338),s=r(33007),c=r(70252),l=r(57366),d=r(86056),u=r(75125),p=r(69530),S=r(16038),g=r(78671),m=r(17644),y=r(18216);async function h(e,t,r,{platformInfo:n,settings:s}){i.default.log("initCarbonApplication"),(0,u.initializeAppSessionId)(e),(0,d.setPlatformInfo)(n),await(0,a.initApplicationSettings)(t,e,r,{settings:s}),await function(){if(!(0,a.getCommonAppSetting)("anonymousComputerId"))return(0,a.storeCommonAppSetting)("anonymousComputerId",(0,o.v4)())}(),await function(){if(!(0,a.getCommonAppSetting)("installationId"))return(0,a.storeCommonAppSetting)("installationId",(0,o.v4)());return Promise.resolve()}(),await async function(){if(!(0,a.getCommonAppSetting)("eventLoggerQueueKey")){const e=await(0,p.generate64BytesKey)(),t=(0,S.base64BufferToText)(e);return(0,a.storeCommonAppSetting)("eventLoggerQueueKey",t)}}()}t.default=h;t.initAuthenticatedCarbonApplication=async(e,t,r)=>{r===y.InitMode.FirstInit&&await v(e,t);const{storageService:o,storeService:a}=(0,n.getCoreServices)(t);return await h(a,o,r,e),await f(a,o),t},t.ensureDeviceId=async function(){let e=(0,a.getCommonAppSetting)("deviceId");return e||(await(0,a.storeCommonAppSetting)("deviceId",(0,o.v4)().replace(/-/g,"")),e=(0,a.getCommonAppSetting)("deviceId")),e};const v=async(e,t)=>{try{const r=(0,n.getCoreServices)(t),{storeService:o}=r;e.anonymousPartnerId&&o.dispatch((0,s.loadAnonymousPartnerId)(e.anonymousPartnerId)),await(0,l.initAuthentication)(r,e.keys)}catch(e){const t=new Error(`[Application] - setSdkAuthentication: ${e}`);(0,c.sendExceptionLog)({error:t})}},f=async(e,t)=>{const r=await(0,g.getGlobalExtensionSettings)({storeService:e,storageService:t});e.dispatch((0,m.setGlobalExtensionSettingsState)(r))}},86056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setPlatformInfo=t.getPlatformInfo=void 0;const o=r(9149);let a=Object.assign({},o.defaultPlatformInfo);t.getPlatformInfo=function(){return a},t.setPlatformInfo=function(e){a=Object.assign({},o.defaultPlatformInfo,e)}},75125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationSessionId=t.initializeAppSessionId=void 0;const o=r(96997),a=r(28486),i=r(30096);function n(e){return(0,a.appSessionIdSelector)(e.getState())}t.initializeAppSessionId=function(e){n(e)||function(e,t){e.dispatch((0,i.appSessionIdInitialized)(t))}(e,(0,o.default)())},t.getApplicationSessionId=n},2646:(e,t)=>{let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getPublicPath=t.setPublicPath=void 0;t.setPublicPath=e=>{if("string"!=typeof e)throw new Error("[Assets] - setPublicPath: provided public path is not a string.");r=e};t.getPublicPath=()=>{if(!r)throw new Error("[Assets] - getPublicPath: trying to access public path before it was set.");return r}},3158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(91178),a=r(53325),i=r(81404),n=r(36592),s=r(54622),c=r(21107),l=r(56915),d=r(3914);t.config={commands:{requestExtraDeviceToken:{handler:c.requestExtraDeviceToken},requestEmailToken:{handler:c.requestEmailToken},requestPaymentUpdateAuthenticationToken:{handler:c.requestPaymentUpdateAuthenticationToken},setReactivationStatus:{handler:d.setReactivationStatusHandler},...o.config.commands,...a.config.commands,...i.config.commands,...n.config.commands},queries:{getHasOtp2Type:{selector:l.hasOtp2TypeSelector},getUserOtpType:{selector:l.otpTypeSelector},getLocalAccounts:{selector:l.localAccountsListSelector},getReactivationStatus:{selector:l.reactivationStatusSelector},getAvailableUserVerificationMethods:{selector:l.availableUserVerificationMethodsSelector},...o.config.queries,...a.config.queries,...i.config.queries,...n.config.queries},liveQueries:{liveReactivationStatus:{operator:s.reactivationStatus$},...o.config.liveQueries,...a.config.liveQueries,...i.config.liveQueries,...n.config.liveQueries}}},90678:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactivationStatus=t.UserVerificationMethod=void 0;var i=r(57839);Object.defineProperty(t,"UserVerificationMethod",{enumerable:!0,get:function(){return i.UserVerificationMethod}});var n=r(52968);Object.defineProperty(t,"ReactivationStatus",{enumerable:!0,get:function(){return n.ReactivationStatus}}),a(r(25997),t),a(r(93928),t),a(r(24929),t),a(r(27686),t),a(r(61217),t)},93553:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExtraDeviceToken=t.requestExtraDeviceToken=void 0;const o=r(46298);t.requestExtraDeviceToken=async(e,t)=>{if(!e())return{type:"userNotAuthenticated",message:"No authenticated user"};const r=await t();if((0,o.isApiError)(r))return r;const i=r.token;return a(i)};const a=e=>"string"!=typeof e||0===e.length?{type:"invalidExtraDeviceTokenSentByServer",message:"Invalid extra device token sent by server"}:{type:"extraDeviceToken",extraDeviceToken:e};t.isExtraDeviceToken=e=>"extraDeviceToken"===e.type},75226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalAccounts=void 0;const o=r(2246),a=r(56915),i=r(63739),n=r(61740);t.getLocalAccounts=async function(e,t){const r=(0,o.getUsersWithPublicSettings)(),s={},c=["localSettings","personalData","personalSettings"];return Promise.all(r.map((async r=>{const o=(0,a.getUserDeviceWasRegisteredWithDeviceKeysSelector)(e.getState(),r),n=[...c,...o?["authentication"]:[]],l=(await Promise.all(n.map((e=>(0,i.isDataStored)(t,r,e))))).every((e=>e));s[r]=l}))).then((()=>r.filter((e=>s[e])))).then((e=>{const t=e.map((e=>({login:e,lastLoginTime:(0,o.getUserPublicSetting)(e,"lastSuccessfulLoginTime")||0}))).sort(((e,t)=>{const r=e.lastLoginTime,o=t.lastLoginTime;return r>o?-1:r<o?1:0}))[0];return e.map((e=>({login:e,hasLoginOtp:(0,o.getUserPublicSetting)(e,"otp2")||!1,isLastSuccessfulLogin:t&&t.login===e,rememberMeType:(0,n.getLocalAccountRememberMeType)(e)??void 0,shouldAskMasterPassword:(0,n.shouldAskMasterPassword)(e)}))).sort(((e,t)=>{const r=e.login.toLowerCase(),o=t.login.toLowerCase();return r.localeCompare(o)}))}))}},37864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenForKwUser=void 0;const o=r(46298);t.getTokenForKwUser=async(e,t)=>{const{storeService:r}=e,a=await(0,o.getTokens)(r);if((0,o.isApiError)(a))throw new Error(`Error: ${a.code}`);const{tokens:i}=a,n=i.find((e=>e.login===t));if(!n)throw new Error("Email token not found for "+t);return n.token}},21107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=t.requestEmailToken=t.requestExtraDeviceToken=void 0;var o=r(61336);Object.defineProperty(t,"requestExtraDeviceToken",{enumerable:!0,get:function(){return o.requestExtraDeviceToken}});var a=r(95626);Object.defineProperty(t,"requestEmailToken",{enumerable:!0,get:function(){return a.requestEmailToken}});var i=r(17717);Object.defineProperty(t,"requestPaymentUpdateAuthenticationToken",{enumerable:!0,get:function(){return i.requestPaymentUpdateAuthenticationToken}})},57366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAuthentication=void 0;const o=r(95623),a=r(33007),i=r(69763),n=r(46298),s=r(56915),c=r(28445);t.initAuthentication=async(e,t)=>{l(e,t),d(e,t),await(0,i.loadLocalUsersAuthenticationDataFromStorage)(e),await u(e,(0,c.checkOrigin)(self))};const l=(e,t)=>{const{storeService:r}=e;r.dispatch((0,a.saveAppKeys)({accessKey:t.appAccess,secretKey:t.appSecret}))},d=(e,t)=>{const{storeService:r}=e;r.dispatch((0,a.saveStyxKeys)({accessKey:t.styxAccess,secretKey:t.styxSecret}))},u=async(e,t)=>{const{storeService:r}=e;try{const e=(0,s.platformInfoSelector)(r.getState()),o=await(0,n.getRemoteTime)(r,"server_tac"!==e.platformName&&"server_leeloo"!==e.platformName||!t?void 0:{tz:(new Date).getTimezoneOffset().toString()});if((0,n.isApiError)(o))throw o;r.dispatch((0,a.saveDashlaneServerDeltaTimestamp)(o.timestamp))}catch(e){(0,o.logDebug)({tag:["Auth"],message:"Error while calling getRemoteTime",details:{error:e}})}}},14498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadRememberMeTypeToStore=void 0;const o=r(98226),a=r(61740),i=r(16593);t.loadRememberMeTypeToStore=function(e){const{storeService:t}=e,r=(0,i.userLoginSelector)(t.getState()),n=(0,a.getLocalAccountRememberMeType)(r);n&&t.dispatch((0,o.setRememberMeTypeAction)(n))}},61336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestExtraDeviceToken=void 0;const o=r(46298),a=r(93553),i=r(16593);t.requestExtraDeviceToken=async e=>{const{storeService:t}=e,r=t.isAuthenticated,n=(0,i.userLoginSelector)(t.getState());if(!n||!r)throw new Error("[Authentication] - requestExtraDeviceToken: User is not authenticated");const s=await(0,a.requestExtraDeviceToken)(r,(()=>(0,o.requestExtraDeviceRegistration)(t,n)));if((0,a.isExtraDeviceToken)(s))return s.extraDeviceToken;throw new Error(s.message)}},17717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=void 0;const o=r(90622),a=r(46298),i=r(16593),n=r(27885),s=r(32924),c=r(1577);t.requestPaymentUpdateAuthenticationToken=async function(e){try{const{storeService:t}=e,r=t.getState(),l=(0,i.userLoginSelector)(r);if(!(0,i.isAuthenticatedSelector)(r))return{success:!1};const d=await(0,s.getAuthenticationTokenForCardUpdate)(t,l,{});if((0,a.isApiError)(d))return{success:!1};const u=(0,n.getCurrentTeamId)(r.userSession.spaceData),p=(0,n.isTeamAdminInCurrentSpace)(r.userSession.spaceData),S=(0,n.isBillingAdminInCurrentSpace)(r.userSession.spaceData),g={login:l,uki:(0,o.ukiSelector)(r),teamId:u};let m,y={};if(u&&(p||S)){const e={name:"teamPlans",version:1};if(m=await(0,c.NewCardToken)(g,e),200!==m.code)return{success:!1};y={customerId:m.content.customerId,tokenId:m.content.tokenId}}let h={};const v={name:"premium",version:3},f=await(0,c.NewCardToken)(g,v);return 200!==f.code?{success:!1}:(h={customerId:f.content.customerId,tokenId:f.content.tokenId},{success:!0,accessKey:d.accessKey,creationDateUnix:d.creationDateUnix,expirationDateUnix:d.expirationDateUnix,secretKey:d.secretKey,livemode:d.livemode,b2bPaymentTokens:y,b2cPaymentTokens:h})}catch(e){return{success:!1}}}},95626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestEmailToken=void 0;const o=r(57839),a=r(16593);t.requestEmailToken=async function(e){try{const{storeService:t,wsService:r}=e,o=t.getState(),i=(0,a.userLoginSelector)(o);if(!i)throw new Error("[emailToken] - askServerToSendToken: no current authenticated user");await r.authentication.askServerToSendToken({login:i})}catch(e){return{success:!1,error:{code:o.EmailTokenApiError,message:e.message}}}return{success:!0}}},3914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setReactivationStatusHandler=void 0;const o=r(48990);t.setReactivationStatusHandler=function({storeService:e},{reactivationStatus:t}){return e.dispatch((0,o.reactivationStatusUpdated)(t)),Promise.resolve()}},57839:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserVerificationMethod=t.EmailTokenApiError=void 0,t.EmailTokenApiError="SEND_TOKEN_FAILED",function(e){e.MasterPassword="masterPassword",e.Webauthn="webauthn"}(t.UserVerificationMethod||(t.UserVerificationMethod={}))},6231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserAuthenticationData=t.loadUserAuthenticationData=void 0;const o=r(56915),a=r(98226),i=r(39408);t.loadUserAuthenticationData=async(e,t)=>{let r;try{const t=e.getInstance();if(!await t.hasAuthenticationData())return Promise.resolve({type:"success"});r=await t.getAuthenticationData()}catch(e){return Promise.resolve({type:"failed",message:i.FailedToReadParseOrValidateAuthenticationData,error:e})}try{t.dispatch((0,a.rehydrateUserAuthenticationData)(r))}catch(e){return Promise.resolve({type:"failed",message:i.FailedToRehydrateAuthenticationData,error:e})}return Promise.resolve({type:"success"})};t.persistUserAuthenticationData=async(e,t)=>{const r=(0,o.userAuthenticationDataSelector)(t.getState()),a=e.getInstance();await a.storeAuthenticationData(r)}},69763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadLocalUsersAuthenticationDataFromStorage=t.persistLocalUsersAuthenticationData=void 0;const o=r(72365),a=r(50058),i=r(70252),n=r(95623),s=r(92263),c=r(56915),l=r(16038),d=r(1860),u=r(56668),p=r(93513),S="authentication.localusers";t.persistLocalUsersAuthenticationData=async(e,t)=>{try{const r=e.getLocalStorage(),a=(0,d.makeKeyDataEncryptorService)();(0,o.setObfuscatingKey)(a);const i=(0,c.localUsersAuthenticationDataSelector)(t.getState()),n=JSON.stringify(i),s=(0,l.utf8ChunkEncode)(n),g=p.encode(s),m=(0,u.utf16ToDeflatedUtf8)(g,{skipUtf8Encoding:!0}),y=await a.getInstance().encrypt(m);await r.writeItem(S,y)}catch(e){const t="Auth",r=s.CarbonError.fromAnyError(e).addContextInfo(t,"persistLocalUsersAuthenticationData");(0,n.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,i.sendExceptionLog)({error:r})}};t.loadLocalUsersAuthenticationDataFromStorage=async e=>{try{const{storageService:t,storeService:r}=e,i=t.getLocalStorage(),n=(0,o.makeDataEncryptorService)(r);(0,o.setObfuscatingKey)(n);const s=await i.readItem(S);if(!s)return;if("string"!=typeof s)throw new Error("value of authentication.localusers is expected to be a string");const c=await n.getInstance().decrypt(s),d=(0,u.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0}),g=p.decode(d);let m=g;try{m=(0,l.utf8ChunkDecode)(g)}catch(e){}const y=JSON.parse(m);r.dispatch((0,a.loadLocalUsersAuthenticationData)(y))}catch(e){const t="Auth",r=s.CarbonError.fromAnyError(e).addContextInfo(t,"loadLocalUsersAuthenticationDataFromStorage");(0,n.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,i.sendExceptionLog)({error:r})}}},39408:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLoadAuthenticationSuccess=t.FailedToRehydrateAuthenticationData=t.FailedToReadParseOrValidateAuthenticationData=void 0,t.FailedToReadParseOrValidateAuthenticationData="Failed to read, parse or validate persisted data",t.FailedToRehydrateAuthenticationData="Failed to rehydrate";t.isLoadAuthenticationSuccess=e=>"object"==typeof e&&"success"===e.type},43739:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deviceRegistered=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.DEVICE_REGISTERED=void 0,t.DEVICE_REGISTERED="DEVICE_REGISTERED";t.makeLegacyDeviceRegistrationKey=e=>({type:"uki",uki:e});t.makeDeviceRegistrationKeys=(e,t)=>({type:"deviceKeys",deviceAccessKey:e,deviceSecretKey:t});t.deviceRegistered=(e,r,o)=>({type:t.DEVICE_REGISTERED,registrationType:e,persistData:r,login:o})},98226:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRememberMeTypeAction=t.rehydrateUserAuthenticationData=t.SET_REMEMBER_ME_TYPE=t.REHYDRATE_USER_AUTHENTICATION_DATA=void 0,t.REHYDRATE_USER_AUTHENTICATION_DATA="REHYDRATE_USER_AUTHENTICATION_DATA",t.SET_REMEMBER_ME_TYPE="SET_REMEMBER_ME_TYPE";t.rehydrateUserAuthenticationData=e=>({type:t.REHYDRATE_USER_AUTHENTICATION_DATA,data:e});t.setRememberMeTypeAction=e=>({type:t.SET_REMEMBER_ME_TYPE,rememberMeType:e})},99932:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyCurrentUserAuthentication=t.currentUserAuthenticationReducer=void 0;const o=r(48313),a=r(98226),i=r(43739);t.currentUserAuthenticationReducer=(e=(0,t.getEmptyCurrentUserAuthentication)(),r)=>{switch(r.type){case o.CLOSE_SESSION:return(0,t.getEmptyCurrentUserAuthentication)();case i.DEVICE_REGISTERED:if("deviceKeys"===r.registrationType.type){const{deviceAccessKey:t,deviceSecretKey:o}=r.registrationType;return{...e,deviceKeys:{accessKey:t,secretKey:o}}}return e;case a.REHYDRATE_USER_AUTHENTICATION_DATA:return{...e,...r.data};case a.SET_REMEMBER_ME_TYPE:return{...e,rememberMeType:r.rememberMeType};default:return e}};t.getEmptyCurrentUserAuthentication=()=>({deviceKeys:null,rememberMeType:null})},52653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.updateLocalUserInfo=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.deviceRegistered=void 0;var o=r(43739);Object.defineProperty(t,"deviceRegistered",{enumerable:!0,get:function(){return o.deviceRegistered}}),Object.defineProperty(t,"makeLegacyDeviceRegistrationKey",{enumerable:!0,get:function(){return o.makeLegacyDeviceRegistrationKey}}),Object.defineProperty(t,"makeDeviceRegistrationKeys",{enumerable:!0,get:function(){return o.makeDeviceRegistrationKeys}});var a=r(50058);Object.defineProperty(t,"updateLocalUserInfo",{enumerable:!0,get:function(){return a.updateLocalUserInfo}});var i=r(57334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return i.authenticationReducer}})},48990:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusUpdated=t.localAccountsListUpdated=void 0;const o=r(52968);t.localAccountsListUpdated=e=>({type:o.LOCAL_ACCOUNTS_LIST_UPDATED,localAccounts:e});t.reactivationStatusUpdated=e=>({type:o.REACTIVATION_STATUS_UPDATED,reactivationStatus:e})},83803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.localAccountsAuthenticationReducer=t.getEmptyLocalAccountsAuthenticationState=void 0;const o=r(52968);t.getEmptyLocalAccountsAuthenticationState=()=>({accountsList:[],accountsListInitialized:!1,reactivationStatus:o.ReactivationStatus.CLASSIC});t.localAccountsAuthenticationReducer=(e=(0,t.getEmptyLocalAccountsAuthenticationState)(),r)=>{switch(r.type){case o.LOCAL_ACCOUNTS_LIST_UPDATED:return{...e,accountsList:r.localAccounts,accountsListInitialized:!0};case o.REACTIVATION_STATUS_UPDATED:return{...e,reactivationStatus:r.reactivationStatus};default:return e}}},52968:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REACTIVATION_STATUS_UPDATED=t.LOCAL_ACCOUNTS_LIST_UPDATED=t.ReactivationStatus=void 0,function(e){e.DISABLED="DISABLED",e.CLASSIC="CLASSIC",e.WEBAUTHN="WEBAUTHN"}(t.ReactivationStatus||(t.ReactivationStatus={})),t.LOCAL_ACCOUNTS_LIST_UPDATED="LOCAL_ACCOUNTS_LIST_UPDATED",t.REACTIVATION_STATUS_UPDATED="REACTIVATION_STATUS_UPDATED"},50058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalUserAuthenticationAction=t.updateLocalUserInfo=t.loadLocalUsersAuthenticationData=t.UPDATE_LOCAL_USER_INFO=t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE=void 0;const o=r(43739);t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE="LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE",t.UPDATE_LOCAL_USER_INFO="UPDATE_LOCAL_USER_INFO";t.loadLocalUsersAuthenticationData=e=>({type:t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE,data:e});t.updateLocalUserInfo=(e,r)=>({type:t.UPDATE_LOCAL_USER_INFO,login:e,data:r});t.isLocalUserAuthenticationAction=e=>e.type===o.DEVICE_REGISTERED},76156:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalUsersAuthentication=t.localUsersAuthenticationReducer=void 0;const o=r(16516),a=r(50058),i=r(43739),n=r(17825);t.localUsersAuthenticationReducer=(e=(0,t.getEmptyLocalUsersAuthentication)(),r)=>{if((0,a.isLocalUserAuthenticationAction)(r)){const t=s(e[r.login],r);return t?{...e,[r.login]:t}:(0,o.omit)([r.login],e)}switch(r.type){case a.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE:return{...e,...r.data};case a.UPDATE_LOCAL_USER_INFO:const t=c();return{...e,[r.login]:{...t,...e[r.login],...r.data}};default:return e}};t.getEmptyLocalUsersAuthentication=()=>({});const s=(e,t)=>{const r=e||c();if(t.type!==i.DEVICE_REGISTERED)return e;{const{registrationType:e}=t;switch(e.type){case"deviceKeys":{const{deviceAccessKey:t}=e;return{...r,deviceAccessKey:t,deviceRegisteredWithLegacyKey:!1}}case"uki":return{...r,deviceRegisteredWithLegacyKey:!0};default:(0,n.assertUnreachable)(e)}}},c=()=>({deviceAccessKey:null,deviceRegisteredWithLegacyKey:!1,ssoActivatedUser:!1})},57334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.getEmptyAuthenticationState=void 0;const o=r(82422),a=r(99932),i=r(83803),n=r(76156),s=r(82677),c=r(96171),l=r(88272);t.getEmptyAuthenticationState=()=>({currentUser:(0,a.getEmptyCurrentUserAuthentication)(),localAccounts:(0,i.getEmptyLocalAccountsAuthenticationState)(),localUsers:(0,n.getEmptyLocalUsersAuthentication)(),u2f:(0,s.getEmptyU2FAuthenticationState)(),webAuthnAuthentication:(0,l.getEmptyWebAuthnAuthentication)(),twoFactorAuthentication:(0,c.getEmptyTwoFactorAuthenticationState)()}),t.authenticationReducer=(0,o.combineReducers)({currentUser:a.currentUserAuthenticationReducer,localAccounts:i.localAccountsAuthenticationReducer,localUsers:n.localUsersAuthenticationReducer,u2f:s.u2fAuthenticationReducer,webAuthnAuthentication:l.webAuthnAuthenticationReducer,twoFactorAuthentication:c.TwoFactorAuthenticationReducer})},72355:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fDevicesUpdated=t.U2F_DEVICES_UPDATED=void 0,t.U2F_DEVICES_UPDATED="U2F_DEVICES_UPDATED";t.u2fDevicesUpdated=e=>({type:t.U2F_DEVICES_UPDATED,devices:e})},82677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fAuthenticationReducer=t.getEmptyU2FAuthenticationState=void 0;const o=r(72355);t.getEmptyU2FAuthenticationState=()=>({u2fDevices:[]});t.u2fAuthenticationReducer=(e=(0,t.getEmptyU2FAuthenticationState)(),r)=>r.type===o.U2F_DEVICES_UPDATED?{...e,u2fDevices:r.devices}:e},8246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAvailableAuthenticatorsListUpdated=t.webAuthnAuthenticatorsListUpdated=t.webAuthnAuthenticatorRemoved=t.webAuthnAuthenticatorAdded=t.webAuthnUserIdUpdated=t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATOR_REMOVED=t.WEBAUTHN_AUTHENTICATOR_ADDED=t.WEBAUTHN_USERID_UPDATED=void 0,t.WEBAUTHN_USERID_UPDATED="WEBAUTHN_USERID_UPDATED",t.WEBAUTHN_AUTHENTICATOR_ADDED="WEBAUTHN_AUTHENTICATOR_ADDED",t.WEBAUTHN_AUTHENTICATOR_REMOVED="WEBAUTHN_AUTHENTICATOR_REMOVED",t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AUTHENTICATORS_LIST_UPDATED",t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED";t.webAuthnUserIdUpdated=e=>({type:t.WEBAUTHN_USERID_UPDATED,webAuthnUserId:e});t.webAuthnAuthenticatorAdded=e=>({type:t.WEBAUTHN_AUTHENTICATOR_ADDED,authenticator:e});t.webAuthnAuthenticatorRemoved=e=>({type:t.WEBAUTHN_AUTHENTICATOR_REMOVED,credentialId:e});t.webAuthnAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED,authenticatorsList:e});t.webAuthnAvailableAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED,availableAuthenticatorsList:e})},88272:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationReducer=t.getEmptyWebAuthnAuthentication=void 0;const o=r(8246);t.getEmptyWebAuthnAuthentication=()=>({webAuthnUserId:null,authenticators:[]});t.webAuthnAuthenticationReducer=(e=(0,t.getEmptyWebAuthnAuthentication)(),r)=>{switch(r.type){case o.WEBAUTHN_USERID_UPDATED:return{...e,webAuthnUserId:r.webAuthnUserId};case o.WEBAUTHN_AUTHENTICATOR_ADDED:return{...e,authenticators:[...e.authenticators,r.authenticator]};case o.WEBAUTHN_AUTHENTICATOR_REMOVED:{const t=e.authenticators.filter((e=>e.credentialId!==r.credentialId));return{...e,authenticators:t}}case o.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED:return{...e,authenticators:r.authenticatorsList};case o.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED:{const t=r.availableAuthenticatorsList.map((e=>e.credentialId)),o=e.authenticators.map((e=>t.includes(e.credentialId)?{...e,canOpenSession:!0}:{...e,canOpenSession:!1}));return{...e,authenticators:o}}default:return e}}},36592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(43037),a=r(5689),i=r(24797),n=r(87463);t.config={commands:{refreshTwoFactorAuthenticationInfo:{handler:i.refreshTwoFactorAuthenticationInfoHandler},...n.config.commands},queries:{getTwoFactorAuthenticationInfo:{selector:a.twoFactorAuthenticationInfoSelector},...n.config.queries},liveQueries:{liveTwoFactorAuthenticationInfo:{operator:o.twoFactorAuthenticationInfo$},...n.config.liveQueries}}},27686:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},81404:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(54120),a=r(18099),i=r(95475);t.config={commands:{startTwoFactorAuthenticationDisableFlow:{handler:o.startTwoFactorAuthenticationDisableFlow},continueTwoFactorAuthenticationDisableFlow:{handler:o.continueTwoFactorAuthenticationDisableFlow},backTwoFactorAuthenticationDisableFlow:{handler:o.backTwoFactorAuthenticationDisableFlow},stopTwoFactorAuthenticationDisableFlow:{handler:o.stopTwoFactorAuthenticationDisableFlow}},queries:{getTwoFactorAuthenticationDisableStage:{selector:a.getTwoFactorAuthenticationDisableStageData}},liveQueries:{liveTwoFactorAuthenticationDisableStage:{operator:i.twoFactorAuthenticationDisableFlow$}}}},24929:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableStages=void 0;var o=r(87632);Object.defineProperty(t,"TwoFactorAuthenticationDisableStages",{enumerable:!0,get:function(){return o.TwoFactorAuthenticationDisableStages}})},44787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;const o=r(4478);t.updateTwoFactorAuthenticationStage=e=>({type:o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:e});t.stopTwoFactorAuthenticationStage=()=>({type:o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:{stage:void 0}})},4478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW=t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE",t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW="STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW"},51554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var o=r(44787);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.stopTwoFactorAuthenticationStage}});var a=r(98259);Object.defineProperty(t,"twoFactorAuthenticationDisableFlow",{enumerable:!0,get:function(){return a.twoFactorAuthenticationDisableFlow}})},98259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.getEmptyTwoFactorAuthenticationDisable=void 0;const o=r(4478);t.getEmptyTwoFactorAuthenticationDisable=()=>({stage:void 0});t.twoFactorAuthenticationDisableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationDisable)(),r)=>r.type===o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE?{...e,...r.data}:e},18099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationDisableFlowData=t.getTwoFactorAuthenticationDisableStageData=void 0;const o=r(46474);t.getTwoFactorAuthenticationDisableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationDisableFlow,r=o.TwoFactorAuthenticationDisableFlowConfig?.[t]?.viewMapper;return{stage:t,viewData:r?r(e):void 0}};t.getTwoFactorAuthenticationDisableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationDisableFlow;return t}},46474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableFlowStages=t.TwoFactorAuthenticationDisableFlowConfig=void 0;const o=r(87632),a=r(73714),i=r(24216),n=r(18747),s=r(46796);t.TwoFactorAuthenticationDisableFlowConfig={start:{storeMapper:a.startTwoFactorAuthenticationDisableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:a.endTwoFactorAuthenticationDisableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:a.endTwoFactorAuthenticationDisableStoreMapper},[o.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE]:{currentHandler:i.disableTwoFactorAuthenticationCodeHandler,viewMapper:n.disableTwoFactorAuthenticationCodeViewMapper},[o.TwoFactorAuthenticationDisableStages.BACKUP_CODE]:{currentHandler:i.disableTwoFactorAuthenticationCodeHandler,viewMapper:n.disableTwoFactorAuthenticationBackupCodeViewMapper},[o.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED]:{currentHandler:i.disableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationDisableFlowStages=[{stage:o.TwoFactorAuthenticationDisableStages.CONFIRMATION},{stage:o.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE},{stage:o.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES},{stage:o.TwoFactorAuthenticationDisableStages.SUCCESS}]},54120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationDisableFlow=t.continueTwoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationDisableFlow=t.startTwoFactorAuthenticationDisableFlow=void 0;const o=r(46474),a=r(51554),i=e=>{const{stage:t}=e.getState().userSession.twoFactorAuthenticationDisableFlow;return{currentIndex:o.TwoFactorAuthenticationDisableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationDisableFlow=({storeService:e})=>{const{storeMapper:t}=o.TwoFactorAuthenticationDisableFlowConfig.start,r=t?t(e):void 0,i=(0,a.updateTwoFactorAuthenticationStage)({...r,stage:o.TwoFactorAuthenticationDisableFlowStages[0].stage});return e.dispatch(i),Promise.resolve({success:!0})};t.stopTwoFactorAuthenticationDisableFlow=e=>{const{storeService:t}=e;t.dispatch((0,a.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:i}=o.TwoFactorAuthenticationDisableFlowConfig.stop,n=i?i(t):void 0;return r?r(e,n):Promise.resolve({success:!0})};const n=(e,t,r,o)=>{const{storeService:a}=e;return t(e,r?r(a):void 0,o)},s=({storeService:e},t)=>{const{currentIndex:r}=i(e);if(r!==o.TwoFactorAuthenticationDisableFlowStages.length-1){const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationDisableFlowStages[r+1].stage});e.dispatch(i)}return Promise.resolve({success:!0})},c=({storeService:e},t)=>{const{currentIndex:r}=i(e);if(0!==r){const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationDisableFlowStages[r-1].stage});e.dispatch(i)}return Promise.resolve({success:!0})},l=e=>{const{currentStage:t}=i(e);let r,a=s,n=c;if(o.TwoFactorAuthenticationDisableFlowConfig[t]){const e=o.TwoFactorAuthenticationDisableFlowConfig[t];n=e.backHandler||n,a=e.currentHandler||a,r=e.storeMapper}return{currentHandler:a,backHandler:n,storeMapper:r}};t.continueTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:o,storeMapper:a}=l(r);return n(e,o,a,t)};t.backTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:o,storeMapper:a}=l(r);return n(e,o,a,t)}},95475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow$=void 0;const o=r(18948),a=r(3343),i=r(18099);t.twoFactorAuthenticationDisableFlow$=()=>(0,o.pipe)((0,a.map)(i.getTwoFactorAuthenticationDisableStageData),(0,a.distinctUntilChanged)())},24216:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationLogoutRequiredHandler=t.disableTwoFactorAuthenticationCodeHandler=void 0;const o=r(51554),a=r(25576),i=r(87632),n=r(46796),s=r(5689),c=r(71291),l=r(18099),d=r(16593),u=r(1965),p=r(53576),S={[p.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:n.disableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[p.TwoFactorAuthenticationType.LOGIN]:{handler:n.disableTwoFactorAuthenticationTOTP2Handler,showLoading:!0}};t.disableTwoFactorAuthenticationCodeHandler=async(e,t,r)=>{const d=r.target;if(d){const{storeService:r}=e,a=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:d,stageData:void 0});return r.dispatch(a),{success:!0}}return await(async(e,t,r)=>{const{storeService:d}=e,u=e=>{const t=(0,o.updateTwoFactorAuthenticationStage)({...e});d.dispatch(t)};try{const g=(0,l.getTwoFactorAuthenticationDisableFlowData)(d.getState()),m=(0,s.twoFactorAuthenticationInfoSelector)(d.getState());if(m.status===p.TwoFactorAuthenticationInfoRequestStatus.READY){const{type:s}=m,{authenticationCode:l}=r,p=await(0,c.performTotpVerificationService)(e,l);if(p.success){const{authTicket:r}=p;if(S[s]){const{handler:a,showLoading:c}=S[s];c&&u({...t,stage:i.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES});const l=await a(e,r);if(l.success)if(l.logoutRequired){const e={...g,logoutRequired:l.logoutRequired};u({...t,stage:i.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED,flowData:e})}else await(0,n.refreshTwoFactorAuthenticationInfoHandler)(e),u({...t,stage:i.TwoFactorAuthenticationDisableStages.SUCCESS}),d.dispatch((0,o.stopTwoFactorAuthenticationStage)());else u({...t,stage:i.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{...l}})}else u({...t,stage:i.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNEXPECTED_OTP_TYPE}}})}else u({...t,stageData:p})}else u({...t,stage:i.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}catch(e){u({...t,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}return{success:!0}})(e,t,r)};t.disableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:a,applicationModulesAccess:i}=e,n=(0,d.userLoginSelector)(t.getState());return t.dispatch((0,o.stopTwoFactorAuthenticationStage)()),n&&await(0,u.wipeOutLocalAccounts)(r,i,[n]),await a.close(),{success:!0}}},73714:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationDisableStoreMapper=t.startTwoFactorAuthenticationDisableStoreMapper=void 0;const o=r(56915);t.startTwoFactorAuthenticationDisableStoreMapper=e=>{const t=e.getState();return{stage:void 0,stageData:void 0,flowData:{otpType:(0,o.otpTypeSelector)(t)}}};t.endTwoFactorAuthenticationDisableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},87632:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableStages=void 0,function(e){e.CONFIRMATION="CONFIRMATION",e.AUTHENTICATION_CODE="AUTHENTICATION_CODE",e.BACKUP_CODE="BACKUP_CODE",e.FINALIZING_CHANGES="FINALIZING_CHANGES",e.SUCCESS="SUCCESS",e.LOGOUT_REQUIRED="LOGOUT_REQUIRED",e.GENERIC_ERROR="GENERIC_ERROR"}(t.TwoFactorAuthenticationDisableStages||(t.TwoFactorAuthenticationDisableStages={}))},18747:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationBackupCodeViewMapper=t.disableTwoFactorAuthenticationCodeViewMapper=void 0;const o=r(25576);t.disableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return{success:!1,error:e}}};t.disableTwoFactorAuthenticationBackupCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return e.code===o.AuthenticationCode.OTP_NOT_VALID?{success:!1,error:{code:o.AuthenticationCode.BACKUP_CODE_NOT_VALID}}:{success:!1,error:e}}}},53325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(17303),a=r(69631),i=r(66574);t.config={commands:{startTwoFactorAuthenticationEnableFlow:{handler:o.startTwoFactorAuthenticationEnableFlow},continueTwoFactorAuthenticationEnableFlow:{handler:o.continueTwoFactorAuthenticationEnableFlow},backTwoFactorAuthenticationEnableFlow:{handler:o.backTwoFactorAuthenticationEnableFlow},stopTwoFactorAuthenticationEnableFlow:{handler:o.stopTwoFactorAuthenticationEnableFlow}},queries:{getTwoFactorAuthenticationEnableStage:{selector:a.getTwoFactorAuthenticationEnableStageData}},liveQueries:{liveTwoFactorAuthenticationEnableStage:{operator:i.twoFactorAuthenticationEnableFlow$}}}},93928:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableStages=void 0;var o=r(15179);Object.defineProperty(t,"TwoFactorAuthenticationEnableStages",{enumerable:!0,get:function(){return o.TwoFactorAuthenticationEnableStages}})},44527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesHandler=void 0;const o=r(15441),a=r(69631),i=r(15179);t.enableTwoFactorAuthenticationBackupCodesHandler=async(e,t)=>{const{storeService:r}=e,n=(0,a.getTwoFactorAuthenticationEnableFlowData)(r.getState());return(0,o.updateStore)(e,{...t,stage:n.logoutRequired?i.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED:i.TwoFactorAuthenticationEnableStages.SUCCESS}),{success:!0}}},72387:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupPhoneHandler=void 0;const o=r(46298),a=r(15441),i=r(69631),n=r(15179),s=r(71291),c=r(53576);t.enableTwoFactorAuthenticationBackupPhoneHandler=async(e,t,r)=>{const{storeService:l}=e;let d=(0,i.getTwoFactorAuthenticationEnableFlowData)(l.getState());const u=await(0,s.requestTOTPActivationService)(e,{...r,country:(0,o.makeSafeCountry)(r.countryCode)});if(u.success){const{seed:o,uri:i,recoveryKeys:s,serverKey:l}=u,{authenticationType:p}=d;p===c.TwoFactorAuthenticationType.LOGIN&&(d[c.TwoFactorAuthenticationType.LOGIN].serverKey=l),d={...d,seed:o,uri:i,recoveryKeys:s},(0,a.updateStore)(e,{...t,stageData:{...u},flowData:{...d,savedValues:{...d?.savedValues,savedCountryCode:r.countryCode,savedPhoneNumber:r.phoneNumber}},stage:n.TwoFactorAuthenticationEnableStages.QR_CODE})}else(0,a.updateStore)(e,{...t,stageData:{...u}});return Promise.resolve({success:!0})}},14732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationCodeHandler=void 0;const o=r(25576),a=r(15441),i=r(15179),n=r(69631),s=r(86370),c=r(52284),l=r(46796),d=r(71291),u=r(53576),p={[u.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:s.enableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[u.TwoFactorAuthenticationType.LOGIN]:{handler:c.enableTwoFactorAuthenticationTOTP2Handler,showLoading:!0,errorStage:i.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}};t.enableTwoFactorAuthenticationCodeHandler=async(e,t,{authenticationCode:r})=>{const{storeService:s}=e;try{const o=(0,n.getTwoFactorAuthenticationEnableFlowData)(s.getState()),{authenticationType:c}=o,u=await(0,d.performTotpVerificationService)(e,r,!0);if(!u.success)return(0,a.updateStore)(e,{...t,stageData:u}),{success:!1};if(p[c]){const{authTicket:r}=u,n=o[c],{handler:s,showLoading:d,errorStage:S}=p[c];d&&(0,a.updateStore)(e,{...t,stage:i.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES});const g=await s(e,r,n);if(g.success){g.logoutRequired||await(0,l.refreshTwoFactorAuthenticationInfoHandler)(e);const r={...o,logoutRequired:g.logoutRequired};(0,a.updateStore)(e,{...t,stage:i.TwoFactorAuthenticationEnableStages.BACKUP_CODES,flowData:r})}else(0,a.updateStore)(e,{...t,stage:S?i.TwoFactorAuthenticationEnableStages.GENERIC_ERROR:i.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE,stageData:{...g}})}else(0,a.updateStore)(e,{...t,stage:i.TwoFactorAuthenticationEnableStages.GENERIC_ERROR,stageData:{success:!1}});return{success:!0}}catch(r){return(0,a.updateStore)(e,{...t,stageData:{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}}),{success:!1}}}},68513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationLogoutRequiredHandler=void 0;const o=r(16593),a=r(1965),i=r(19546);t.enableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:n,applicationModulesAccess:s}=e,c=(0,o.userLoginSelector)(t.getState());return t.dispatch((0,i.stopTwoFactorAuthenticationStage)()),c&&await(0,a.wipeOutLocalAccounts)(r,s,[c]),await n.close(),{success:!0}}},33778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTypeHandler=void 0;const o=r(57903),a=r(19546),i=r(69631),n=r(15179),s=r(15441),c=r(16194),l=r(16593),d=r(46298),u=r(61984),p=r(92233),S=r(53576);t.enableTwoFactorAuthenticationTypeHandler=async(e,t,{authenticationType:r})=>{const{storeService:g}=e,m=(0,i.getTwoFactorAuthenticationEnableFlowData)(g.getState());if(r===S.TwoFactorAuthenticationType.LOGIN)try{const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:n.TwoFactorAuthenticationEnableStages.LOADING});g.dispatch(i);const{eventLoggerService:y}=e,h=g.getState(),v=(0,l.userLoginSelector)(h);if(!v)return(0,s.updateStore)(e,{...t,stage:n.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});if(!await(0,o.waitUntilSyncComplete)(g))return(0,s.updateStore)(e,{...t,stage:n.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});g.dispatch((0,c.changeMPStart)());const f=await(0,d.getDataForMasterPasswordChange)(g,v,{});if((0,d.isApiError)(f))(0,u.logChangeMasterPasswordError)(y,p.ChangeMasterPasswordError.DownloadError),g.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:n.TwoFactorAuthenticationEnableStages.GENERIC_ERROR});else{const{data:{transactions:e,sharingKeys:o},timestamp:i}=f,s=(0,a.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,[S.TwoFactorAuthenticationType.LOGIN]:{transactions:e,sharingKeys:o,timestamp:i,serverKey:""},savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:n.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(s)}}catch(r){g.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:n.TwoFactorAuthenticationEnableStages.GENERIC_ERROR})}else{const e=(0,a.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:n.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(e)}return Promise.resolve({success:!0})}},46667:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(14732),t),a(r(72387),t),a(r(33778),t),a(r(44527),t),a(r(68513),t)},48277:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE";t.updateTwoFactorAuthenticationStage=e=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:e});t.stopTwoFactorAuthenticationStage=()=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:{stage:void 0}})},19546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var o=r(48277);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.stopTwoFactorAuthenticationStage}});var a=r(15896);Object.defineProperty(t,"twoFactorAuthenticationEnableFlow",{enumerable:!0,get:function(){return a.twoFactorAuthenticationEnableFlow}})},15896:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.getEmptyTwoFactorAuthenticationEnable=void 0;const o=r(48277);t.getEmptyTwoFactorAuthenticationEnable=()=>({stage:void 0});t.twoFactorAuthenticationEnableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationEnable)(),r)=>r.type===o.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE?{...e,...r.data}:e},69631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationEnableFlowData=t.getTwoFactorAuthenticationEnableStageData=void 0;const o=r(13610);t.getTwoFactorAuthenticationEnableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationEnableFlow,r=o.TwoFactorAuthenticationEnableFlowConfig?.[t]?.viewMapper,a=e.userSession.twoFactorAuthenticationEnableFlow?.flowData?.savedValues;return{stage:t,viewData:r?r(e):void 0,savedValues:a}};t.getTwoFactorAuthenticationEnableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationEnableFlow;return t}},13610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableFlowStages=t.TwoFactorAuthenticationEnableFlowConfig=void 0;const o=r(15179),a=r(62669),i=r(58206),n=r(46667),s=r(46796);t.TwoFactorAuthenticationEnableFlowConfig={start:{storeMapper:a.startTwoFactorAuthenticationEnableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:a.endTwoFactorAuthenticationEnableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:a.endTwoFactorAuthenticationEnableStoreMapper},[o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE]:{currentHandler:n.enableTwoFactorAuthenticationTypeHandler,viewMapper:i.enableTwoFactorAuthenticationTypeViewMapper},[o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE]:{currentHandler:n.enableTwoFactorAuthenticationBackupPhoneHandler,viewMapper:i.enableTwoFactorAuthenticationBackupPhoneViewMapper},[o.TwoFactorAuthenticationEnableStages.QR_CODE]:{viewMapper:i.enableTwoFactorAuthenticationQRCodeViewMapper},[o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE]:{currentHandler:n.enableTwoFactorAuthenticationCodeHandler,viewMapper:i.enableTwoFactorAuthenticationCodeViewMapper},[o.TwoFactorAuthenticationEnableStages.BACKUP_CODES]:{currentHandler:n.enableTwoFactorAuthenticationBackupCodesHandler,viewMapper:i.enableTwoFactorAuthenticationBackupCodesViewMapper},[o.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED]:{currentHandler:n.enableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationEnableFlowStages=[{stage:o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE},{stage:o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE},{stage:o.TwoFactorAuthenticationEnableStages.QR_CODE},{stage:o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE},{stage:o.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES},{stage:o.TwoFactorAuthenticationEnableStages.BACKUP_CODES},{stage:o.TwoFactorAuthenticationEnableStages.SUCCESS}]},17303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationEnableFlow=t.continueTwoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationEnableFlow=t.startTwoFactorAuthenticationEnableFlow=void 0;const o=r(13610),a=r(19546),i=e=>e.userSession.twoFactorAuthenticationEnableFlow,n=e=>{const{stage:t}=i(e.getState());return{currentIndex:o.TwoFactorAuthenticationEnableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationEnableFlow=({storeService:e})=>{const{storeMapper:t}=o.TwoFactorAuthenticationEnableFlowConfig.start,r=t?t(e):void 0,i=(0,a.updateTwoFactorAuthenticationStage)({...r,stage:o.TwoFactorAuthenticationEnableFlowStages[0].stage});return e.dispatch(i),Promise.resolve({success:!0})};t.stopTwoFactorAuthenticationEnableFlow=e=>{const{storeService:t}=e;t.dispatch((0,a.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:i}=o.TwoFactorAuthenticationEnableFlowConfig.stop,n=i?i(t):void 0;return r?r(e,n):Promise.resolve({success:!0})};const s=(e,t,r,o)=>{const{storeService:a}=e;return t(e,r?r(a):void 0,o)},c=({storeService:e},t)=>{const{currentIndex:r}=n(e);if(r!==o.TwoFactorAuthenticationEnableFlowStages.length-1){const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationEnableFlowStages[r+1].stage});e.dispatch(i)}return Promise.resolve({success:!0})},l=({storeService:e},t)=>{const{currentIndex:r}=n(e);if(0!==r){const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationEnableFlowStages[r-1].stage});e.dispatch(i)}return Promise.resolve({success:!0})},d=e=>{const{currentStage:t}=n(e);let r,a=c,i=l;if(o.TwoFactorAuthenticationEnableFlowConfig[t]){const e=o.TwoFactorAuthenticationEnableFlowConfig[t];i=e.backHandler||i,a=e.currentHandler||a,r=e.storeMapper}return{currentHandler:a,backHandler:i,storeMapper:r}};t.continueTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:o,storeMapper:a}=d(r);return s(e,o,a,t)};t.backTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:o,storeMapper:n}=d(r);return(e=>{const t=i(e.getState()),r=(0,a.updateTwoFactorAuthenticationStage)({...t,stageData:void 0});e.dispatch(r)})(r),s(e,o,n,t)}},15441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateStore=void 0;const o=r(19546);t.updateStore=({storeService:e},t)=>{const r=(0,o.updateTwoFactorAuthenticationStage)({...t});e.dispatch(r)}},66574:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow$=void 0;const o=r(18948),a=r(3343),i=r(69631);t.twoFactorAuthenticationEnableFlow$=()=>(0,o.pipe)((0,a.map)(i.getTwoFactorAuthenticationEnableStageData),(0,a.distinctUntilChanged)())},62669:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationEnableStoreMapper=t.startTwoFactorAuthenticationEnableStoreMapper=void 0;t.startTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0});t.endTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},15179:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableStages=t.TwoFactorAuthenticationBackupPhoneErrorCode=void 0,function(e){e[e.INVALID_FORMAT=0]="INVALID_FORMAT",e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR"}(t.TwoFactorAuthenticationBackupPhoneErrorCode||(t.TwoFactorAuthenticationBackupPhoneErrorCode={})),function(e){e.AUTHENTICATION_TYPE="AUTHENTICATION_TYPE",e.BACKUP_PHONE="BACKUP_PHONE",e.QR_CODE="QR_CODE",e.AUTHENTICATION_CODE="AUTHENTICATION_CODE",e.LOADING="LOADING",e.FINALIZING_CHANGES="FINALIZING_CHANGES",e.BACKUP_CODES="BACKUP_CODES",e.GENERIC_ERROR="GENERIC_ERROR",e.LOGOUT_REQUIRED="LOGOUT_REQUIRED",e.SUCCESS="SUCCESS"}(t.TwoFactorAuthenticationEnableStages||(t.TwoFactorAuthenticationEnableStages={}))},58206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesViewMapper=t.enableTwoFactorAuthenticationCodeViewMapper=t.enableTwoFactorAuthenticationQRCodeViewMapper=t.enableTwoFactorAuthenticationBackupPhoneViewMapper=t.enableTwoFactorAuthenticationTypeViewMapper=void 0;const o=r(46298);t.enableTwoFactorAuthenticationTypeViewMapper=()=>({currentStep:1,totalSteps:5});t.enableTwoFactorAuthenticationBackupPhoneViewMapper=e=>{const t=(0,o.makeSafeCountry)(e.device.platform.location.country),{stageData:r}=e.userSession.twoFactorAuthenticationEnableFlow;return{currentStep:2,totalSteps:5,countryCode:t,...r}};t.enableTwoFactorAuthenticationQRCodeViewMapper=e=>{const{uri:t,seed:r}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:3,totalSteps:5,uri:t,seed:r}};t.enableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationEnableFlow;if(t){const{error:t}=e.userSession.twoFactorAuthenticationEnableFlow.stageData;return{currentStep:4,totalSteps:5,error:t}}return{currentStep:4,totalSteps:5}};t.enableTwoFactorAuthenticationBackupCodesViewMapper=e=>{const{recoveryKeys:t}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:5,totalSteps:5,recoveryKeys:t}}},6836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthStatusError=t.TwoFactorAuthStatusRequested=t.TwoFactorAuthStatusUpdated=t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR=t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED=t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED=void 0,t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED="TWO_FACTOR_AUTHENTICATION_INFO_UPDATED",t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED="TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED",t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR="TWO_FACTOR_AUTHENTICATION_INFO_ERROR";t.TwoFactorAuthStatusUpdated=e=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED,info:e});t.TwoFactorAuthStatusRequested=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED});t.TwoFactorAuthStatusError=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR})},96171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationReducer=t.getEmptyTwoFactorAuthenticationState=void 0;const o=r(53576),a=r(6836),i=r(16478);t.getEmptyTwoFactorAuthenticationState=()=>({status:o.TwoFactorAuthenticationInfoRequestStatus.UNKNOWN});t.TwoFactorAuthenticationReducer=(e=(0,t.getEmptyTwoFactorAuthenticationState)(),r)=>{const n=r?.info?.type;switch(r.type){case a.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED:return{status:o.TwoFactorAuthenticationInfoRequestStatus.PENDING};case a.TWO_FACTOR_AUTHENTICATION_INFO_ERROR:return{status:o.TwoFactorAuthenticationInfoRequestStatus.ERROR};case a.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED:return{...r.info,isTwoFactorAuthenticationEnabled:i.TwoFactorAuthenticationEnabled.includes(n),status:o.TwoFactorAuthenticationInfoRequestStatus.READY};default:return e}}},87463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(40970),a=r(70245),i=r(60262),n=r(24217);t.config={commands:{removeU2FAuthenticator:{handler:o.removeU2FAuthenticatorHandler},refreshU2FDevicesList:{handler:a.refreshU2FDevicesListHandler}},queries:{getU2FDevicesList:{selector:n.listU2FDevicesSelector}},liveQueries:{liveU2FDevicesList:{operator:i.listU2FDevices$}}}},61217:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RefreshU2FErrorCode=t.RemoveU2FAuthenticatorError=void 0,function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NO_KEYHANDLE_FOUND="NO_KEYHANDLE_FOUND",e.WRONG_AUTHENTICATION_CODE="WRONG_AUTHENTICATION_CODE"}(t.RemoveU2FAuthenticatorError||(t.RemoveU2FAuthenticatorError={})),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR"}(t.RefreshU2FErrorCode||(t.RefreshU2FErrorCode={}))},70245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshU2FDevicesListHandler=void 0;const o=r(46298),a=r(16593),i=r(61217),n=r(72355);t.refreshU2FDevicesListHandler=async e=>{try{const{storeService:t}=e,r=t.isAuthenticated,s=(0,a.userLoginSelector)(t.getState());if(!s||!r)return{success:!1,error:{code:i.RefreshU2FErrorCode.UNKNOWN_ERROR}};const c=await(0,o.getU2FDevices)(t,s);return(0,o.isApiError)(c)?{success:!1,error:{code:i.RefreshU2FErrorCode.UNKNOWN_ERROR}}:(t.dispatch((0,n.u2fDevicesUpdated)(c.u2fDevices)),{success:!0})}catch(e){return{success:!1,error:{code:i.RefreshU2FErrorCode.UNKNOWN_ERROR}}}}},40970:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticatorHandler=void 0;const o=r(14656),a=r(92263),i=r(46298),n=r(70252),s=r(16593),c=r(28287),l=r(61217),d=r(70245),u=r(17387);t.removeU2FAuthenticatorHandler=async(e,t)=>{try{const{storeService:r}=e,o=r.getState(),a=r.isAuthenticated,n=(0,s.userLoginSelector)(o);if(!n||!a)return{success:!1,error:{code:l.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}};const{authenticationCode:u,keyHandle:p}=t,S=await(0,i.performTotpVerification)(r,{login:n,otp:u});if((0,i.isApiError)(S))return(0,c.handlePerformValidationError)(S,!0);const{authTicket:g}=S,m=await(0,i.removeU2FAuthenticator)(r,n,{authTicket:g,keyHandle:p});return(0,i.isApiError)(m)?{success:!1,error:{code:l.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}:(await(0,d.refreshU2FDevicesListHandler)(e),{success:!0})}catch(e){const t=a.CarbonError.fromAnyError(e).addContextInfo("U2F","removeU2FAuthenticatorHandler");return(0,n.sendExceptionLog)({error:t}),{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===o.HttpErrorCode.NETWORK_ERROR?u.AuthenticationCode.NETWORK_ERROR:l.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}}}},60262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevices$=void 0;const o=r(18948),a=r(3343),i=r(24217);t.listU2FDevices$=()=>(0,o.pipe)((0,a.map)(i.listU2FDevicesSelector),(0,a.distinctUntilChanged)())},24217:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevicesSelector=void 0;t.listU2FDevicesSelector=e=>e.authentication.u2f.u2fDevices},16478:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=t.TwoFactorAuthenticationEnabled=void 0;const o=r(53576);t.TwoFactorAuthenticationEnabled=[o.TwoFactorAuthenticationType.DEVICE_REGISTRATION,o.TwoFactorAuthenticationType.LOGIN,o.TwoFactorAuthenticationType.SSO],t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=9e5},9819:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP1Handler=void 0;const o=r(46298),a=r(25576);t.disableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>{const{storeService:r}=e,{login:i}=r.getAccountInfo(),n=await(0,o.deactivateTotpVerification)(r,i,{authTicket:t});return(0,o.isApiError)(n)?{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}:{success:!0}}},99445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP2Handler=void 0;const o=r(61740),a=r(46298),i=r(33740),n=r(57903),s=r(16194),c=r(16593),l=r(25576),d=r(16356),u=r(47820);t.disableTwoFactorAuthenticationTOTP2Handler=async(e,t)=>{const{applicationModulesAccess:r,storeService:p,masterPasswordEncryptorService:S,sessionService:g,storageService:m}=e,y=p.getState(),h=(0,c.userLoginSelector)(y);try{if(!h)throw new Error("2FA Disable Flow - Login not available");if((0,c.isRemoteKeyActivatedSelector)(y))throw console.error("Disable 2FA unavailable: RK account"),new Error("2FA Disable Flow - Unavailable due to RemoteKey Account");if(!await(0,n.waitUntilSyncComplete)(p))return{success:!1,error:{code:l.AuthenticationCode.UNKNOWN_SYNC_ERROR}};p.dispatch((0,s.changeMPStart)());const v=r.createClients();await v.session.commands.prepareLocalDataFlush();const f=await(0,a.getDataForMasterPasswordChange)(p,h,{});if((0,a.isApiError)(f))throw new Error("2FA Disable Flow - Unable to getDataForMasterPasswordChange");const A=(0,c.serverKeySelector)(y);if(!(0,i.isOtpStatusValid)(f.otpStatus,A))throw new Error("2FA Disable Flow - OTP status is invalid");const{timestamp:P}=f,{transactions:b,sharingKeys:w}=f.data,T=await(0,i.deCipherAllTransactions)(g,S,b,!1),_=p.getUserSession().masterPassword,I=e.localStorageService.getInstance(),E=await I.doesLocalKeyExist();let C=null;E&&(C=await I.getLocalKey());const{publicKey:D}=w,O=await(0,i.decipherPrivateKey)(p,S,w);await(0,o.cleanRememberMeStorageData)(p,m);const M="",N=(0,i.returnProperCryptoConfig)(p);S.setInstance({raw:_},M,N),p.dispatch((0,d.updateServerKey)(M));const F={type:"email_token"};p.dispatch((0,d.updateRemoteKey)(null));const U=await(0,i.cipherTransactionWithNewMP)(p,g,S,T,null,!1),L=await(0,i.cipherPrivateKey)(S,O),R={timestamp:P,transactions:(0,i.formatTransaction)(U),updateVerification:F,sharingKeys:{publicKey:D,privateKey:L},authTicket:t},k=await(0,a.uploadDataForMasterPasswordChange)(p,h,R);if((0,a.isApiError)(k))throw(0,i.revertOnError)(e,S,{currentPassword:_,serverKey:A}),new Error("2FA Disable Flow - Unable to uploadDataForMasterPasswordChange");C&&await g.getInstance().user.persistLocalKey(C),await v.session.commands.flushLocalData(),await(0,u.storeSessionCredentialForRecovery)(p,e.localStorageService)}catch(e){return p.dispatch((0,s.changeMPDone)()),{success:!1,error:{code:l.AuthenticationCode.UNKNOWN_ERROR}}}let v=!0;try{const e=await(0,a.confirmMasterPasswordChangeDone)(p,h,{});if((0,a.isApiError)(e))throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone");v=!1}catch(e){throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone")}return p.dispatch((0,s.changeMPDone)()),{success:!0,logoutRequired:v}}},86370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP1Handler=void 0;const o=r(35823);t.enableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>await(0,o.completeTotpActivationHandler)(e,t)},52284:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP2Handler=void 0;const o=r(61740),a=r(46298),i=r(33740),n=r(16593),s=r(25576),c=r(47820),l=r(16194),d=r(16356);t.enableTwoFactorAuthenticationTOTP2Handler=async(e,t,r)=>{const{timestamp:u,transactions:p,sharingKeys:S,serverKey:g}=r;if(!g)throw new Error("[2FA - Enable] - Empty server key");const{applicationModulesAccess:m,storeService:y,masterPasswordEncryptorService:h,sessionService:v,storageService:f}=e,A=y.getState();if((0,n.isRemoteKeyActivatedSelector)(A))return console.error("Enable 2FA unavailable: RK account"),{success:!1,error:{code:s.AuthenticationCode.UNKNOWN_ERROR}};const P=m.createClients();await P.session.commands.prepareLocalDataFlush();const b=(0,n.userLoginSelector)(A);if(!b)return{success:!1,error:{code:s.AuthenticationCode.UNKNOWN_ERROR}};const w=e.localStorageService.getInstance();let T=null;await w.doesLocalKeyExist()&&(T=await w.getLocalKey());try{const r=await(0,i.deCipherAllTransactions)(v,h,p,!1),{publicKey:n}=S,s=await(0,i.decipherPrivateKey)(y,h,S);await(0,o.cleanRememberMeStorageData)(y,f);const l={type:"totp_login",serverKey:g},m=(0,i.returnProperCryptoConfig)(y),A=y.getUserSession().masterPassword;h.setInstance({raw:A},g,m);const w=await(0,i.cipherTransactionWithNewMP)(y,v,h,r,null,!1),_=await(0,i.cipherPrivateKey)(h,s),I={timestamp:u,transactions:(0,i.formatTransaction)(w),updateVerification:l,sharingKeys:{publicKey:n,privateKey:_},authTicket:t},E=await(0,a.uploadDataForMasterPasswordChange)(y,b,I);if((0,a.isApiError)(E))throw new Error("2FA Enable Flow - Unable to uploadDataForMasterPasswordChange");y.dispatch((0,d.updateServerKey)(g)),T&&await v.getInstance().user.persistLocalKey(T),await P.session.commands.flushLocalData(),await(0,c.storeSessionCredentialForRecovery)(y,e.localStorageService)}catch(t){return(e=>{const{storeService:t,masterPasswordEncryptorService:r,remoteDataEncryptorService:o}=e,a=t.getState(),s=(0,n.isRemoteKeyActivatedSelector)(a)?o:r,c=t.getUserSession().masterPassword;(0,i.revertOnError)(e,s,{currentPassword:c,serverKey:""})})(e),y.dispatch((0,l.changeMPDone)()),{success:!1,error:{code:s.AuthenticationCode.UNKNOWN_ERROR}}}let _=!0;try{const e=await(0,a.confirmMasterPasswordChangeDone)(y,b,{});if((0,a.isApiError)(e))throw new Error("2FA Enable Flow - Failed to confirmMasterPasswordChangeDone");_=!1}catch(e){}return y.dispatch((0,l.changeMPDone)()),{success:!0,logoutRequired:_}}},35823:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivationHandler=void 0;const o=r(46298),a=r(25576),i=r(16593),n=r(34569);t.completeTotpActivationHandler=async(e,t)=>{const{storeService:r}=e,s=r.getState(),c=(0,i.userLoginSelector)(s);if(!c)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};const l=await(0,n.completeTotpActivation)(r,c,{authTicket:t});return(0,o.isApiError)(l)?{success:!1,error:{code:l.code}}:{success:!0}}},49109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=void 0;const o=r(92233),a=r(16194);t.endTwoFactorAuthenticationHandler=async({sessionService:e,storeService:t})=>(t.dispatch((0,a.changeMPDone)()),await e.getInstance().user.attemptSync(o.Trigger.SettingsChange),{success:!0})},46796:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=t.disableTwoFactorAuthenticationTOTP1Handler=t.disableTwoFactorAuthenticationTOTP2Handler=t.refreshTwoFactorAuthenticationInfoHandler=void 0;var o=r(24797);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoHandler",{enumerable:!0,get:function(){return o.refreshTwoFactorAuthenticationInfoHandler}});var a=r(99445);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP2Handler",{enumerable:!0,get:function(){return a.disableTwoFactorAuthenticationTOTP2Handler}});var i=r(9819);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP1Handler",{enumerable:!0,get:function(){return i.disableTwoFactorAuthenticationTOTP1Handler}});var n=r(49109);Object.defineProperty(t,"endTwoFactorAuthenticationHandler",{enumerable:!0,get:function(){return n.endTwoFactorAuthenticationHandler}})},24797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoHandler=void 0;const o=r(16593),a=r(6836),i=r(71291);t.refreshTwoFactorAuthenticationInfoHandler=async e=>{const{storeService:t,wsService:r}=e;try{const e=t.isAuthenticated,n=(0,o.userLoginSelector)(t.getState());if(t.dispatch((0,a.TwoFactorAuthStatusRequested)()),!n||!e)return t.dispatch((0,a.TwoFactorAuthStatusError)()),{success:!1};return!1===(await(0,i.refreshTwoFactorAuthenticationInfoService)(t,r)).success?(t.dispatch((0,a.TwoFactorAuthStatusError)()),{success:!1}):{success:!0}}catch(e){return t.dispatch((0,a.TwoFactorAuthStatusError)()),{success:!1}}}},43037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfo$=void 0;const o=r(18948),a=r(3343),i=r(5689);t.twoFactorAuthenticationInfo$=()=>(0,o.pipe)((0,a.map)(i.twoFactorAuthenticationInfoSelector),(0,a.distinctUntilChanged)())},5689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfoSelector=void 0;t.twoFactorAuthenticationInfoSelector=e=>e.authentication.twoFactorAuthentication},71291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=t.refreshTwoFactorAuthenticationInfoService=t.performTotpVerificationService=void 0;var o=r(14762);Object.defineProperty(t,"performTotpVerificationService",{enumerable:!0,get:function(){return o.performTotpVerificationService}});var a=r(71938);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoService",{enumerable:!0,get:function(){return a.refreshTwoFactorAuthenticationInfoService}});var i=r(56733);Object.defineProperty(t,"requestTOTPActivationService",{enumerable:!0,get:function(){return i.requestTOTPActivationService}})},14762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerificationService=void 0;const o=r(46298),a=r(92263),i=r(14656),n=r(25576),s=r(28287),c=r(16593);t.performTotpVerificationService=async(e,t,r=!1)=>{const{storeService:l}=e,d=l.getState(),u=(0,c.userLoginSelector)(d);if(!u)return{success:!1,error:{code:n.AuthenticationCode.UNKNOWN_ERROR}};try{const e=await(0,o.performTotpVerification)(l,{login:u,otp:t,activationFlow:r});if((0,o.isApiError)(e))return(0,s.handlePerformValidationError)(e,!0);const{authTicket:a}=e;return{success:!0,authTicket:a}}catch(e){return{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?n.AuthenticationCode.NETWORK_ERROR:n.AuthenticationCode.UNKNOWN_ERROR}}}}},71938:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoService=void 0;const o=r(46298),a=r(16593),i=r(16478),n=r(56915),s=r(6836),c=r(53576),l={email_token:c.TwoFactorAuthenticationType.EMAIL_TOKEN,totp_login:c.TwoFactorAuthenticationType.LOGIN,totp_device_registration:c.TwoFactorAuthenticationType.DEVICE_REGISTRATION,sso:c.TwoFactorAuthenticationType.SSO};t.refreshTwoFactorAuthenticationInfoService=async(e,t)=>{try{const r=(0,a.userLoginSelector)(e.getState()),d=await(0,o.getTwoFactorAuthenticationStatus)(e,r);if((0,o.isApiError)(d))return{success:!1};const u=l[d.type],p=i.TwoFactorAuthenticationEnabled.includes(u);let S=!1;const g=await t.premium.status({login:(0,a.userLoginSelector)(e.getState()),uki:(0,n.ukiSelector)(e.getState()),spaces:!0}),{spaces:m}=g;m&&(S=m.some((e=>{const{info:{twoFAEnforced:t}}=e;return c.ENFORCE_TWO_FACTOR_AUTHENTICATION_ENABLED_VALUES.includes(t)})));const y=!p&&S,h={...d,isTwoFactorAuthenticationEnabled:p,isTwoFactorAuthenticationEnforced:S,shouldEnforceTwoFactorAuthentication:y,type:u};return e.dispatch((0,s.TwoFactorAuthStatusUpdated)(h)),{success:!0,info:h}}catch(e){return{success:!1}}}},56733:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=void 0;const o=r(46298),a=r(92263),i=r(14656),n=r(25576),s=r(16593);t.requestTOTPActivationService=async(e,{phoneNumber:t,country:r})=>{try{const{storeService:a}=e,i=a.getState(),c=(0,s.userLoginSelector)(i);if(!c)return{success:!1,error:{code:n.AuthenticationCode.UNKNOWN_ERROR}};const l=await(0,o.requestTOTPActivation)(a,c,{phoneNumber:t,country:r});return(0,o.isApiError)(l)?{success:!1,error:{code:l.code}}:{success:!0,...l}}catch(e){return{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?n.AuthenticationCode.NETWORK_ERROR:n.AuthenticationCode.UNKNOWN_ERROR}}}}},91178:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(41762),a=r(52198),i=r(29010),n=r(3433),s=r(22770),c=r(49904),l=r(56915),d=r(52056),u=r(89805),p=r(92694),S=r(33088),g=r(82862);t.config={commands:{enableWebAuthnAuthentication:{handler:p.enableWebAuthnAuthentication},initEnableWebAuthnAuthentication:{handler:u.initEnableWebAuthnAuthentication},initRegisterWebAuthnAuthenticator:{handler:o.initRegisterWebAuthnAuthenticator},registerWebAuthnAuthenticator:{handler:a.registerWebAuthnAuthenticator},refreshWebAuthnAuthenticators:{handler:n.refreshWebAuthnAuthenticators},refreshAvailableWebAuthnAuthenticators:{handler:i.refreshAvailableWebAuthnAuthenticators},initOpenSessionWithWebAuthnAuthenticator:{handler:s.initOpenSessionWithWebAuthnAuthenticator},openSessionWithWebAuthnAuthenticator:{handler:c.openSessionWithWebAuthnAuthenticator},disableWebAuthnAuthentication:{handler:S.disableWebAuthnAuthentication},removeWebAuthnAuthenticator:{handler:g.removeWebAuthnAuthenticator}},queries:{getWebAuthnAuthenticators:{selector:l.authenticatorsSelector},getWebAuthnAuthenticationOptedIn:{selector:l.webAuthnAuthenticationOptedInSelector}},liveQueries:{liveWebAuthnAuthenticators:{operator:d.webAuthnAuthenticators$},liveWebAuthnAuthenticationOptedIn:{operator:d.webAuthnAuthenticationOptedIn$}}}},25997:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnCallTypes=t.RegisterWebAuthnAuthenticatorError=t.OpenSessionWithWebAuthnAuthenticatorError=t.InitRegisterWebAuthnAuthenticatorError=t.InitEnableWebAuthnAuthenticationError=t.EnableWebAuthnAuthenticationError=t.DisableWebAuthnAuthenticationError=void 0;var o=r(38945);Object.defineProperty(t,"DisableWebAuthnAuthenticationError",{enumerable:!0,get:function(){return o.DisableWebAuthnAuthenticationError}}),Object.defineProperty(t,"EnableWebAuthnAuthenticationError",{enumerable:!0,get:function(){return o.EnableWebAuthnAuthenticationError}}),Object.defineProperty(t,"InitEnableWebAuthnAuthenticationError",{enumerable:!0,get:function(){return o.InitEnableWebAuthnAuthenticationError}}),Object.defineProperty(t,"InitRegisterWebAuthnAuthenticatorError",{enumerable:!0,get:function(){return o.InitRegisterWebAuthnAuthenticatorError}}),Object.defineProperty(t,"OpenSessionWithWebAuthnAuthenticatorError",{enumerable:!0,get:function(){return o.OpenSessionWithWebAuthnAuthenticatorError}}),Object.defineProperty(t,"RegisterWebAuthnAuthenticatorError",{enumerable:!0,get:function(){return o.RegisterWebAuthnAuthenticatorError}}),Object.defineProperty(t,"WebAuthnCallTypes",{enumerable:!0,get:function(){return o.WebAuthnCallTypes}})},79842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PUBKEY_ALGORITHM_RSA_PKCS1256=t.PUBKEY_ALGORITHM_ECDSA256=void 0,t.PUBKEY_ALGORITHM_ECDSA256=-7,t.PUBKEY_ALGORITHM_RSA_PKCS1256=-257},26942:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildAssertionPublicKeyOptions=t.buildAttestationPublicKeyOptions=void 0;const o=r(79842);t.buildAttestationPublicKeyOptions=function(e,t,r,a,i,n){return{rp:{id:e,name:"Dashlane"},user:{id:t,name:r,displayName:r},challenge:a,timeout:i,pubKeyCredParams:[{alg:o.PUBKEY_ALGORITHM_ECDSA256,type:"public-key"},{alg:o.PUBKEY_ALGORITHM_RSA_PKCS1256,type:"public-key"}],excludeCredentials:n,authenticatorSelection:{userVerification:"discouraged"}}},t.buildAssertionPublicKeyOptions=function(e,t,r,o){return{rpId:e,challenge:t,timeout:r,allowCredentials:o,userVerification:"discouraged"}}},52056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationOptedIn$=t.webAuthnAuthenticators$=void 0;const o=r(18948),a=r(3343),i=r(56915);t.webAuthnAuthenticators$=()=>(0,o.pipe)((0,a.map)(i.authenticatorsSelector),(0,a.distinctUntilChanged)());t.webAuthnAuthenticationOptedIn$=()=>(0,o.pipe)((0,a.map)(i.webAuthnAuthenticationOptedInSelector),(0,a.distinctUntilChanged)())},33088:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableWebAuthnAuthentication=void 0;const o=r(16593),a=r(38945),i=r(86903);t.disableWebAuthnAuthentication=async function(e){const{webAuthnAuthenticationService:t,storeService:r}=e,n=(0,o.userLoginSelector)(r.getState());if(!n)return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.MISSING_LOGIN}};try{return await t.deactivate(n)?((0,i.sendUserSettingsLog)(e),{success:!0}):{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}catch(e){return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}}},92694:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableWebAuthnAuthentication=void 0;const o=r(38945),a=r(56915),i=r(16593),n=r(86903),s={UNKNOWN_ERROR:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.UNKNOWN_ERROR}},WEBAUTHN_SERVICE_INIT_FAILED:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_INIT_FAILED}},USER_HAS_OTP:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.USER_HAS_OTP}}};t.enableWebAuthnAuthentication=async function(e,t){const{webAuthnAuthenticationService:r,storeService:c}=e,{authenticationType:l,credential:d,isRoaming:u}=t,p=(0,i.userLoginSelector)(c.getState());if((0,a.hasOtp2TypeSelector)(c.getState()))return s.USER_HAS_OTP;try{switch(l){case o.WebAuthnCallTypes.CREATE:{const t=await async function(e,t,r,o){const a=t.response,i={authenticationType:"webauthn.create",name:e,isRoaming:r,credential:{id:t.id,type:t.type,rawId:t.rawId,response:a}};return await o.initialize(i)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}(p,d,u,r);return t.success&&(0,n.sendUserSettingsLog)(e),t}case o.WebAuthnCallTypes.GET:{const t=await async function(e,t){const r=e.response,o={authenticationType:"webauthn.get",credential:{id:e.id,type:e.type,rawId:e.rawId,response:r}};return await t.initialize(o)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}(d,r);return t.success&&(0,n.sendUserSettingsLog)(e),t}default:return s.UNKNOWN_ERROR}}catch(e){return s.UNKNOWN_ERROR}}},89805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initEnableWebAuthnAuthentication=void 0;const o=r(28354),a=r(46298),i=r(38945),n=r(16593),s=r(56915),c=r(8246),l=r(3433),d=r(26942);t.initEnableWebAuthnAuthentication=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=r.getState(),S=(0,n.userLoginSelector)(r.getState());let g=(0,s.webAuthnUserIdSelector)(p);g||(g=(0,o.v4)(),r.dispatch((0,c.webAuthnUserIdUpdated)(g)));let m=(0,s.authenticatorsAsCredentialSelector)(p);m&&0!==m.length||(await(0,l.refreshWebAuthnAuthenticators)(e),m=(0,s.authenticatorsAsCredentialSelector)(r.getState()));const y=m?.length>0?i.WebAuthnCallTypes.GET:i.WebAuthnCallTypes.CREATE;try{const e=await(0,a.requestWebauthnRegistration)(r,S);if((0,a.isApiError)(e))return{success:!1,error:{code:i.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:o}=e;let n;return n=y===i.WebAuthnCallTypes.CREATE?(0,d.buildAttestationPublicKeyOptions)(u,g,S,t,o,m):(0,d.buildAssertionPublicKeyOptions)(u,t,o,m),{success:!0,response:{publicKeyOptions:n,webAuthnType:y}}}catch(e){return{success:!1,error:{code:i.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}}}}},22770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initOpenSessionWithWebAuthnAuthenticator=void 0;const o=r(92233),a=r(68299),i=r(38945),n=r(658);t.initOpenSessionWithWebAuthnAuthenticator=async function(e,t){const{relyingPartyId:r,login:s}=t,{webAuthnAuthenticationService:c}=e;try{if(!await c.shouldTrigger(s))return{success:!1,error:{code:i.InitOpenSessionWithWebAuthnAuthenticatorError.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION}};(0,n.sendAskBiometricAuthenticationEventLog)(e,o.VerificationMode.None);const t=await(0,a.startWebAuthnAuthentication)(e,s,r);if(!1===t.success){let e=i.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR;if(t.error.code===i.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS)e=i.InitOpenSessionWithWebAuthnAuthenticatorError.UNAVAILABLE_AUTHENTICATORS;return{success:!1,error:{code:e}}}return{success:!0,response:{publicKeyOptions:t.response.publicKeyOptions,authenticatorsInfo:t.response.authenticatorsInfo.map((({credentialId:e,isRoaming:t})=>({credentialId:e,isRoaming:t})))}}}catch(e){return{success:!1,error:{code:i.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},41762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initRegisterWebAuthnAuthenticator=void 0;const o=r(28354),a=r(38945),i=r(46298),n=r(8246),s=r(16593),c=r(56915),l=r(26942),d=r(3433);t.initRegisterWebAuthnAuthenticator=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=(0,s.userLoginSelector)(r.getState());let S=(0,c.webAuthnUserIdSelector)(r.getState());S||(S=(0,o.v4)(),r.dispatch((0,n.webAuthnUserIdUpdated)(S)));let g=(0,c.authenticatorsAsCredentialSelector)(r.getState());g&&0!==g.length||(await(0,d.refreshWebAuthnAuthenticators)(e),g=(0,c.authenticatorsAsCredentialSelector)(r.getState()));try{const e=await(0,i.requestWebauthnRegistration)(r,p);if((0,i.isApiError)(e))return{success:!1,error:{code:a.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:o}=e;return{success:!0,response:{publicKeyOptions:(0,l.buildAttestationPublicKeyOptions)(u,S,p,t,o,g)}}}catch(e){return{success:!1,error:{code:a.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},49904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithWebAuthnAuthenticator=void 0;const o=r(38945),a=r(88610),i=r(658);t.openSessionWithWebAuthnAuthenticator=async function(e,t){const{credential:r,login:n,isRoamingAuthenticator:s}=t,{storeService:c,webAuthnAuthenticationService:l}=e;try{const t={authenticationType:"webauthn.get",credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};await l.process(n,t);const d=c.getUserSession().masterPassword;if(!d)return(0,i.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:o.OpenSessionWithWebAuthnAuthenticatorError.MP_MISSING_IN_SESSION_ERROR}};const u=(0,a.makeLoginController)(e);return await u.openSessionWithMasterPassword(n,d,{triggeredByRememberMeType:"webauthn",isWebAuthnAuthenticatorRoaming:s}),{success:!0}}catch(t){return(0,i.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:o.OpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},29010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshAvailableWebAuthnAuthenticators=void 0;const o=r(38945),a=r(56915),i=r(46298),n=r(8246);t.refreshAvailableWebAuthnAuthenticators=async function(e,t){const{storeService:r}=e,{login:s}=t;if(!(0,a.sessionKeysSelector)(r.getState()))return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.MISSING_SESSION_KEYS_IN_STORE}};try{const e=await(0,i.getAvailableWebAuthnAuthenticators)(r,s);if((0,i.isApiError)(e))return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const t=e.authenticators.map((e=>({...e,canOpenSession:!0})));return r.dispatch((0,n.webAuthnAvailableAuthenticatorsListUpdated)(t)),{success:!0,response:{authenticators:t}}}catch(e){return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},3433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshWebAuthnAuthenticators=void 0;const o=r(38945),a=r(46298),i=r(16593),n=r(8246);t.refreshWebAuthnAuthenticators=async function(e){const{storeService:t}=e,r=(0,i.userLoginSelector)(t.getState());try{const e=await(0,a.getWebAuthnAuthenticators)(t,r);if((0,a.isApiError)(e))return{success:!1,error:{code:o.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const i=e.authenticators.map((e=>({...e,canOpenSession:!1})));return t.dispatch((0,n.webAuthnAuthenticatorsListUpdated)(i)),{success:!0,response:{authenticators:i}}}catch(e){return{success:!1,error:{code:o.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},52198:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerWebAuthnAuthenticator=void 0;const o=r(38945),a=r(16593),i=r(46298),n=r(56915),s=r(8246);t.registerWebAuthnAuthenticator=async function(e,t){const{credential:r,isRoaming:c}=t,{storeService:l,webAuthnAuthenticationService:d}=e,u=l.getState(),p=(0,a.userLoginSelector)(u);if((0,n.hasOtp2TypeSelector)(u))return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.USER_HAS_OTP}};try{const e={authenticationType:"webauthn.create",name:p,isRoaming:c,credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};if((0,n.authenticatorsSelector)(u).length){const t=await(0,i.completeWebAuthnAuthenticatorRegistration)(l,p,{authenticator:e});if((0,i.isApiError)(t))return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}else await d.initialize(e);return l.dispatch((0,s.webAuthnAuthenticatorAdded)({name:e.name,isRoaming:e.isRoaming,credentialId:e.credential.id,canOpenSession:!0})),{success:!0}}catch(e){return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},82862:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeWebAuthnAuthenticator=void 0;const o=r(16593),a=r(46298),i=r(38945),n=r(56915),s=r(33088),c=r(8246);async function l(e,t,r){const o=await(0,a.deactivateWebAuthnAuthenticator)(e,t,{credentialId:r});return(0,a.isApiError)(o)?{success:!1,error:{code:i.RemoveWebAuthnAuthenticatorError.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR}}:{success:!0}}t.removeWebAuthnAuthenticator=async function(e,t){const{credentialId:r}=t,{storeService:a}=e,d=a.getState(),u=(0,o.userLoginSelector)(d),p=(0,n.webAuthnAuthenticationOptedInSelector)(d),S=(0,n.authenticatorsSelector)(d);try{let t=null;return p&&1===S.length?(await(0,s.disableWebAuthnAuthentication)(e),t=await l(a,u,r)):t=await l(a,u,r),t.success&&a.dispatch((0,c.webAuthnAuthenticatorRemoved)(r)),t}catch(e){return{success:!1,error:{code:i.RemoveWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},68299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startWebAuthnAuthentication=void 0;const o=r(26942),a=r(29010),i=r(38945),n=r(46298);t.startWebAuthnAuthentication=async function(e,t,r){const{storeService:s}=e,c=await(0,a.refreshAvailableWebAuthnAuthenticators)(e,{login:t});if(!c.success)return{success:!1,error:{code:i.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS}};const l=[];c.response.authenticators.forEach((e=>{l.push({id:e.credentialId,type:"public-key"})}));const d=await(0,n.requestWebauthnOpenSession)(s,t);if((0,n.isApiError)(d))return{success:!1,error:{code:i.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE}};const{challenge:u,expirationDateUnix:p}=d;return{success:!0,response:{publicKeyOptions:(0,o.buildAssertionPublicKeyOptions)(r,u,p,l),authenticatorsInfo:c.response.authenticators}}}},38945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StartWebAuthnAuthenticationError=t.RemoveWebAuthnAuthenticatorError=t.DisableWebAuthnAuthenticationError=t.OpenSessionWithWebAuthnAuthenticatorError=t.InitOpenSessionWithWebAuthnAuthenticatorError=t.RefreshAvailableWebAuthnAuthenticatorsError=t.RefreshWebAuthnAuthenticatorsError=t.RegisterWebAuthnAuthenticatorError=t.InitRegisterWebAuthnAuthenticatorError=t.EnableWebAuthnAuthenticationError=t.InitEnableWebAuthnAuthenticationError=t.WebAuthnCallTypes=void 0,function(e){e.CREATE="webauthn.create",e.GET="webauthn.get"}(t.WebAuthnCallTypes||(t.WebAuthnCallTypes={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR"}(t.InitEnableWebAuthnAuthenticationError||(t.InitEnableWebAuthnAuthenticationError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.USER_HAS_OTP="USER_HAS_OTP",e.WEBAUTHN_SERVICE_INIT_FAILED="WEBAUTHN_SERVICE_INIT_FAILED"}(t.EnableWebAuthnAuthenticationError||(t.EnableWebAuthnAuthenticationError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR"}(t.InitRegisterWebAuthnAuthenticatorError||(t.InitRegisterWebAuthnAuthenticatorError={})),function(e){e.USER_HAS_OTP="USER_HAS_OTP",e.UNKNOWN_ERROR="UNKNOWN_ERROR"}(t.RegisterWebAuthnAuthenticatorError||(t.RegisterWebAuthnAuthenticatorError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR"}(t.RefreshWebAuthnAuthenticatorsError||(t.RefreshWebAuthnAuthenticatorsError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.MISSING_SESSION_KEYS_IN_STORE="MISSING_SESSION_KEYS_IN_STORE"}(t.RefreshAvailableWebAuthnAuthenticatorsError||(t.RefreshAvailableWebAuthnAuthenticatorsError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.UNAVAILABLE_AUTHENTICATORS="UNAVAILABLE_AUTHENTICATORS",e.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION="CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION"}(t.InitOpenSessionWithWebAuthnAuthenticatorError||(t.InitOpenSessionWithWebAuthnAuthenticatorError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.MP_MISSING_IN_SESSION_ERROR="MP_MISSING_IN_SESSION_ERROR"}(t.OpenSessionWithWebAuthnAuthenticatorError||(t.OpenSessionWithWebAuthnAuthenticatorError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.WEBAUTHN_SERVICE_DEACTIVATE_FAILED="WEBAUTHN_SERVICE_DEACTIVATE_FAILED",e.MISSING_LOGIN="MISSING_LOGIN"}(t.DisableWebAuthnAuthenticationError||(t.DisableWebAuthnAuthenticationError={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR="CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR"}(t.RemoveWebAuthnAuthenticatorError||(t.RemoveWebAuthnAuthenticatorError={})),function(e){e.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS="CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS",e.CANNOT_FETCH_WEBAUTHN_CHALLENGE="CANNOT_FETCH_WEBAUTHN_CHALLENGE"}(t.StartWebAuthnAuthenticationError||(t.StartWebAuthnAuthenticationError={}))},44740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(3158);t.bootstrap=e=>{e.register(o.config)}},90622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.getLocalAccounts=t.appKeysSelector=t.sessionKeysSelector=t.ukiSelector=t.deviceKeysSelector=t.authenticationReducer=void 0;var o=r(57334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return o.authenticationReducer}});var a=r(56915);Object.defineProperty(t,"deviceKeysSelector",{enumerable:!0,get:function(){return a.deviceKeysSelector}}),Object.defineProperty(t,"ukiSelector",{enumerable:!0,get:function(){return a.ukiSelector}}),Object.defineProperty(t,"sessionKeysSelector",{enumerable:!0,get:function(){return a.sessionKeysSelector}}),Object.defineProperty(t,"appKeysSelector",{enumerable:!0,get:function(){return a.appKeysSelector}});var i=r(75226);Object.defineProperty(t,"getLocalAccounts",{enumerable:!0,get:function(){return i.getLocalAccounts}});var n=r(44740);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return n.bootstrap}})},54622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatus$=void 0;const o=r(18948),a=r(3343),i=r(56915);t.reactivationStatus$=()=>(0,o.pipe)((0,a.map)(i.reactivationStatusSelector),(0,a.distinctUntilChanged)())},56915:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableUserVerificationMethodsSelector=t.reactivationStatusSelector=t.rememberMeFor14DaysOptedInSelector=t.webAuthnAuthenticationOptedInSelector=t.rememberMeTypeSelector=t.authenticatorsAsCredentialSelector=t.availableAuthenticatorsSelector=t.authenticatorsSelector=t.webAuthnUserIdSelector=t.webAuthnAuthenticationSelector=t.platformInfoSelector=t.hasOtp2TypeSelector=t.otpTypeSelector=t.userAuthenticationDataSelector=t.localUsersAuthenticationDataSelector=t.localAccountsListSelector=t.getUserDeviceWasRegisteredWithDeviceKeysSelector=t.sessionKeysSelector=t.getDeviceAccessKeySelector=t.getDeviceIdSelector=t.deviceKeysSelector=t.ukiSelector=t.dashlaneServerDeltaTimestampSelector=t.appKeysSelector=void 0;const o=r(92215),a=r(2246),i=r(86797),n=r(57839),s=r(38981);t.appKeysSelector=e=>e.userSession.sdkAuthentication.appKeys;t.dashlaneServerDeltaTimestampSelector=e=>e.userSession.sdkAuthentication.dashlaneServerDeltaTimestamp;t.ukiSelector=e=>{const t=e.userSession.localSettings.uki;return t||(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys&&(0,o.convertDeviceKeysToUki)(e.authentication.currentUser.deviceKeys)||null)};t.deviceKeysSelector=e=>{if(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys)return e.authentication.currentUser.deviceKeys;const t=e.userSession.localSettings.uki;return(0,o.convertUkiToDeviceKeys)(t)};t.getDeviceIdSelector=(e,t)=>{const r=e.authentication.localUsers[t];return r&&r.deviceAccessKey?r.deviceAccessKey:(0,a.getCommonAppSetting)("deviceId")||null};t.getDeviceAccessKeySelector=(e,r)=>(0,t.getDeviceIdSelector)(e,r);t.sessionKeysSelector=({userSession:{session:e}})=>Boolean(e.sessionKeys&&e.sessionKeys.accessKey&&e.sessionKeys.secretKey)?{...e.sessionKeys}:null;t.getUserDeviceWasRegisteredWithDeviceKeysSelector=(e,t)=>{const r=e.authentication.localUsers[t];return!!r&&!r.deviceRegisteredWithLegacyKey};t.localAccountsListSelector=e=>e.authentication.localAccounts.accountsList;t.localUsersAuthenticationDataSelector=e=>e.authentication.localUsers;t.userAuthenticationDataSelector=e=>e.authentication.currentUser;t.otpTypeSelector=e=>e.userSession?.account?e.userSession.account.otpType:null;t.hasOtp2TypeSelector=e=>(0,t.otpTypeSelector)(e)===i.OtpType.OTP_LOGIN;t.platformInfoSelector=e=>e.device.platform.info;t.webAuthnAuthenticationSelector=e=>e.authentication.webAuthnAuthentication;t.webAuthnUserIdSelector=e=>e.authentication.webAuthnAuthentication.webAuthnUserId;t.authenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators;t.availableAuthenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators.filter((e=>e.canOpenSession));t.authenticatorsAsCredentialSelector=e=>(0,t.authenticatorsSelector)(e).map((e=>({id:e.credentialId,type:"public-key"})));t.rememberMeTypeSelector=e=>e.authentication.currentUser.rememberMeType;t.webAuthnAuthenticationOptedInSelector=e=>"webauthn"===(0,t.rememberMeTypeSelector)(e);t.rememberMeFor14DaysOptedInSelector=e=>"autologin"===(0,t.rememberMeTypeSelector)(e);t.reactivationStatusSelector=e=>e.authentication.localAccounts.reactivationStatus;t.availableUserVerificationMethodsSelector=e=>{const r=[];return(0,t.webAuthnAuthenticationOptedInSelector)(e)&&r.push(n.UserVerificationMethod.Webauthn),(0,s.isSSOUserSelector)(e)||r.push(n.UserVerificationMethod.MasterPassword),Promise.resolve(r)}},33045:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(14498);t.setupSubscriptions=async function(e,t){e.sessionOpened.on((()=>{(0,o.loadRememberMeTypeToStore)(t)}))}},76839:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(90351);t.config={commands:{},queries:{getSingleAddressForAutofill:{selector:o.autofillViewedAddressSelector},getMultipleAddressesForAutofill:{selector:o.autofillViewedQueriedAddressesSelector},getSingleBankAccountForAutofill:{selector:o.autofillViewedBankAccountSelector},getMultipleBankAccountsForAutofill:{selector:o.autofillViewedQueriedBankAccountsSelector},getSingleCompanyForAutofill:{selector:o.autofillViewedCompanySelector},getMultipleCompaniesForAutofill:{selector:o.autofillViewedQueriedCompaniesSelector},getSingleCredentialForAutofill:{selector:o.autofillViewedCredentialSelector},getMultipleCredentialsForAutofill:{selector:o.autofillViewedQueriedCredentialsByDomainSelector},getSingleDriverLicenseForAutofill:{selector:o.autofillViewedDriverLicenseSelector},getMultipleDriverLicensesForAutofill:{selector:o.autofillViewedQueriedDriverLicensesSelector},getSingleEmailForAutofill:{selector:o.autofillViewedEmailSelector},getMultipleEmailsForAutofill:{selector:o.autofillViewedQueriedEmailsSelector},getSingleFiscalIdForAutofill:{selector:o.autofillViewedFiscalIdSelector},getMultipleFiscalIdsForAutofill:{selector:o.autofillViewedQueriedFiscalIdsSelector},getSingleGeneratedPasswordForAutofill:{selector:o.autofillViewedGeneratedPasswordSelector},getMultipleGeneratedPasswordsForAutofill:{selector:o.autofillViewedQueriedGeneratedPasswordsSelector},getSingleIdCardForAutofill:{selector:o.autofillViewedIdCardSelector},getMultipleIdCardsForAutofill:{selector:o.autofillViewedQueriedIdCardsSelector},getSingleIdentityForAutofill:{selector:o.autofillViewedIdentitySelector},getMultipleIdentitiesForAutofill:{selector:o.autofillViewedQueriedIdentitiesSelector},getSingleNoteForAutofill:{selector:o.autofillViewedNoteSelector},getMultipleNotesForAutofill:{selector:o.autofillViewedQueriedNotesSelector},getSinglePasskeyForAutofill:{selector:o.autofillViewedPasskeySelector},getSinglePassportForAutofill:{selector:o.autofillViewedPassportSelector},getMultiplePassportsForAutofill:{selector:o.autofillViewedQueriedPassportsSelector},getSinglePaymentCardForAutofill:{selector:o.autofillViewedPaymentCardSelector},getMultiplePaymentCardsForAutofill:{selector:o.autofillViewedQueriedPaymentCardsSelector},getSinglePersonalWebsiteForAutofill:{selector:o.autofillViewedPersonalWebsiteSelector},getMultiplePersonalWebsitesForAutofill:{selector:o.autofillViewedQueriedPersonalWebsitesSelector},getSinglePhoneForAutofill:{selector:o.autofillViewedPhoneSelector},getMultiplePhonesForAutofill:{selector:o.autofillViewedQueriedPhonesSelector},getSingleSocialSecurityIdForAutofill:{selector:o.autofillViewedSocialSecurityIdSelector},getMultipleSocialSecurityIdsForAutofill:{selector:o.autofillViewedQueriedSocialSecurityIdsSelector},getAutofillSettingOnUrlForAutofill:{selector:o.getAutofillSettingOnUrlForAutofillSelector}},liveQueries:{}}},72227:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(76839);t.bootstrap=e=>{e.register(o.config)}},27923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainMatchTypeForHermes=t.getAgeFromIdentity=t.defaultToZero=t.defaultToUS=t.defaultToEmptyString=void 0;const o=r(16516),a=r(53576),i=r(92233),n=r(72099),s=r(88083);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToUS=(0,o.defaultTo)(a.Country.US),t.defaultToZero=(0,o.defaultTo)(0);t.getAgeFromIdentity=e=>{const t=new Date(0).getUTCFullYear(),r=(0,n.epochToDate)((0,n.vaultDateToViewDate)(e.BirthDate)),o=new Date(Date.now()-r.getTime());return Math.abs(o.getUTCFullYear()-t)};t.getDomainMatchTypeForHermes=(e,t)=>{switch((0,s.getCredentialByDomainMatchType)(e,t)){case s.DomainMatchType.DashlaneDefinedLinkedWebsite:return i.MatchType.AssociatedWebsite;case s.DomainMatchType.UserDefinedLinkedWebsite:return i.MatchType.UserAssociatedWebsite;case s.DomainMatchType.None:case s.DomainMatchType.MainWebsite:default:return i.MatchType.Regular}}},74219:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(72227);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},90351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAutofillSettingOnUrlForAutofillSelector=t.autofillViewedQueriedSocialSecurityIdsSelector=t.autofillViewedSocialSecurityIdSelector=t.autofillViewedQueriedPersonalWebsitesSelector=t.autofillViewedPersonalWebsiteSelector=t.autofillViewedQueriedPhonesSelector=t.autofillViewedPhoneSelector=t.autofillViewedQueriedPaymentCardsSelector=t.autofillViewedPaymentCardSelector=t.autofillViewedQueriedPassportsSelector=t.autofillViewedPassportSelector=t.autofillViewedPasskeySelector=t.autofillViewedQueriedNotesSelector=t.autofillViewedNoteSelector=t.autofillViewedQueriedIdentitiesSelector=t.autofillViewedIdentitySelector=t.autofillViewedQueriedIdCardsSelector=t.autofillViewedIdCardSelector=t.autofillViewedQueriedGeneratedPasswordsSelector=t.autofillViewedGeneratedPasswordSelector=t.autofillViewedQueriedFiscalIdsSelector=t.autofillViewedFiscalIdSelector=t.autofillViewedQueriedEmailsSelector=t.autofillViewedEmailSelector=t.autofillViewedQueriedDriverLicensesSelector=t.autofillViewedDriverLicenseSelector=t.autofillViewedQueriedCredentialsByDomainSelector=t.autofillViewedCredentialSelector=t.autofillViewedQueriedCompaniesSelector=t.autofillViewedCompanySelector=t.autofillViewedQueriedBankAccountsSelector=t.autofillViewedBankAccountSelector=t.autofillViewedQueriedAddressesSelector=t.autofillViewedAddressSelector=void 0;const o=r(16516),a=r(21178),i=r(99281),n=r(16018),s=r(80624),c=r(19736),l=r(19325),d=r(41841),u=r(9774),p=r(26147),S=r(41092),g=r(92598),m=r(23437),y=r(81438),h=r(28074),v=r(65401),f=r(58235),A=r(81473),P=r(82439),b=r(27147),w=r(16593),T=r(63566),_=r(91210),I=r(52102),E=r(83687),C=r(55346),D=r(38250),O=r(18665);t.autofillViewedAddressSelector=(e,t)=>{const r=(0,i.addressSelector)(e,t);return(0,C.addressAutofillView)(r)},t.autofillViewedQueriedAddressesSelector=(0,o.compose)((0,T.viewListResults)(C.addressListView),i.queryAddressesSelector);t.autofillViewedBankAccountSelector=(e,t)=>{const r=(0,n.bankAccountSelector)(e,t);return(0,C.bankAccountAutofillView)(r)},t.autofillViewedQueriedBankAccountsSelector=(0,o.compose)((0,T.viewListResults)(C.bankAccountListView),n.queryBankAccountsSelector);t.autofillViewedCompanySelector=(e,t)=>{const r=(0,s.companySelector)(e,t);return(0,C.companyAutofillView)(r)},t.autofillViewedQueriedCompaniesSelector=(0,o.compose)((0,T.viewListResults)(C.companyListView),s.queryCompaniesSelector);t.autofillViewedCredentialSelector=(e,{credentialId:t,rootDomain:r})=>{const o=(0,c.credentialSelector)(e,t),a=(0,_.limitedSharingItemsSelector)(e),i=(0,I.sharingDataSelector)(e),n=(0,w.userIdSelector)(e),s=(0,E.getSharingStatusDetail)(a,i,n)(t);return(0,C.credentialAutofillView)(r,o,s)};t.autofillViewedQueriedCredentialsByDomainSelector=(e,t)=>{const r=(0,_.limitedSharingItemsSelector)(e),o=(0,I.sharingDataSelector)(e),a=(0,w.userIdSelector)(e),i=(0,E.getSharingStatusDetail)(r,o,a),{domain:n,...s}=t,c=(n?(0,l.getQueryByDomainSelector)(n):d.querySelector)(e,s),u={...c,items:c.items.map((e=>({credential:e,domain:n,sharingStatus:i(e.Id)})))};return(0,T.viewListResults)(C.credentialListView)(u)};t.autofillViewedDriverLicenseSelector=(e,t)=>{const r=(0,u.driverLicenseWithIdentitySelector)(e,t);return(0,C.driverLicenseAutofillView)(r)},t.autofillViewedQueriedDriverLicensesSelector=(0,o.compose)((0,T.viewListResults)(C.driverLicenseListView),u.queryDriverLicensesSelector);t.autofillViewedEmailSelector=(e,t)=>{const r=(0,p.emailSelector)(e,t);return(0,C.emailAutofillView)(r)},t.autofillViewedQueriedEmailsSelector=(0,o.compose)((0,T.viewListResults)(C.emailListView),p.queryEmailsSelector);t.autofillViewedFiscalIdSelector=(e,t)=>{const r=(0,S.fiscalIdSelector)(e,t);return(0,C.fiscalIdAutofillView)(r)},t.autofillViewedQueriedFiscalIdsSelector=(0,o.compose)((0,T.viewListResults)(C.fiscalIdListView),S.queryFiscalIdsSelector);t.autofillViewedGeneratedPasswordSelector=(e,t)=>{const r=(0,g.generatedPasswordSelector)(e,t);return(0,C.generatedPasswordAutofillView)(r)},t.autofillViewedQueriedGeneratedPasswordsSelector=(0,o.compose)((0,T.viewListResults)(C.generatedPasswordListView),g.queryGeneratedPasswordsSelector);t.autofillViewedIdCardSelector=(e,t)=>{const r=(0,m.idCardWithIdentitySelector)(e,t);return(0,C.idCardAutofillView)(r)},t.autofillViewedQueriedIdCardsSelector=(0,o.compose)((0,T.viewListResults)(C.idCardListView),m.queryIdCardsSelector);t.autofillViewedIdentitySelector=(e,t)=>{const r=(0,h.identitySelector)(e,t);return(0,C.identityAutofillView)(r)},t.autofillViewedQueriedIdentitiesSelector=(0,o.compose)((0,T.viewListResults)(C.identityListView),h.queryIdentitiesSelector);t.autofillViewedNoteSelector=(e,t)=>{const r=(0,y.noteSelector)(e,t);return(0,C.noteAutofillView)(r)},t.autofillViewedQueriedNotesSelector=(0,o.compose)((0,T.viewListResults)(C.noteListView),y.queryNotesSelector);t.autofillViewedPasskeySelector=(e,t)=>{const r=(0,O.passkeySelector)(e,t);return(0,C.passkeyAutofillView)(r)};t.autofillViewedPassportSelector=(e,t)=>{const r=(0,v.passportWithIdentitySelector)(e,t);return(0,C.passportAutofillView)(r)},t.autofillViewedQueriedPassportsSelector=(0,o.compose)((0,T.viewListResults)(C.passportListView),v.queryPassportsWithIdentitySelector);t.autofillViewedPaymentCardSelector=(e,t)=>{const r=(0,f.paymentCardSelector)(e,t);return(0,C.paymentCardAutofillView)(r)},t.autofillViewedQueriedPaymentCardsSelector=(0,o.compose)((0,T.viewListResults)(C.paymentCardListView),f.queryPaymentCardsSelector);t.autofillViewedPhoneSelector=(e,t)=>{const r=(0,P.phoneSelector)(e,t);return(0,C.phoneAutofillView)(r)},t.autofillViewedQueriedPhonesSelector=(0,o.compose)((0,T.viewListResults)(C.phoneListView),P.queryPhonesSelector);t.autofillViewedPersonalWebsiteSelector=(e,t)=>{const r=(0,A.personalWebsiteSelector)(e,t);return(0,C.personalWebsiteAutofillView)(r)},t.autofillViewedQueriedPersonalWebsitesSelector=(0,o.compose)((0,T.viewListResults)(C.personalWebsiteListView),A.queryPersonalWebsitesSelector);t.autofillViewedSocialSecurityIdSelector=(e,t)=>{const r=(0,b.socialSecurityIdWithIdentitySelector)(e,t);return(0,C.socialSecurityIdAutofillView)(r)},t.autofillViewedQueriedSocialSecurityIdsSelector=(0,o.compose)((0,T.viewListResults)(C.socialSecurityIdListView),b.querySocialSecurityIdsSelector);t.getAutofillSettingOnUrlForAutofillSelector=(e,t)=>{const r=new a.ParsedURL(t).getRootDomain(),o=(0,w.personalSettingsSelector)(e),i=o.DisabledUrlsList.includes(t);return o.DisabledDomainsList.includes(r)||i?D.AutofillOptions.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS:D.AutofillOptions.ANALYSIS_ENABLED_ON_ALL_FORMS}},55346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyAutofillView=t.socialSecurityIdListView=t.socialSecurityIdAutofillView=t.phoneListView=t.phoneAutofillView=t.personalWebsiteListView=t.personalWebsiteAutofillView=t.paymentCardListView=t.paymentCardAutofillView=t.passportListView=t.passportAutofillView=t.noteListView=t.noteAutofillView=t.idCardListView=t.idCardAutofillView=t.identityListView=t.identityAutofillView=t.generatedPasswordListView=t.generatedPasswordAutofillView=t.fiscalIdListView=t.fiscalIdAutofillView=t.emailListView=t.emailAutofillView=t.driverLicenseListView=t.driverLicenseAutofillView=t.credentialListView=t.credentialAutofillView=t.companyListView=t.companyAutofillView=t.bankAccountListView=t.bankAccountAutofillView=t.addressListView=t.addressAutofillView=void 0;const o=r(74127),a=r(16516),i=r(92882),n=r(42316),s=r(90073),c=r(72099),l=r(6205),d=r(38495),u=r(27923),p=e=>({id:e.Id,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.addressAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Address,addressFull:(0,u.defaultToEmptyString)(e.AddressFull),addressName:(0,u.defaultToEmptyString)(e.AddressName),building:(0,u.defaultToEmptyString)(e.Building),city:(0,u.defaultToEmptyString)(e.City),country:(0,u.defaultToEmptyString)(e.Country),digitCode:(0,u.defaultToEmptyString)(e.DigitCode),door:(0,u.defaultToEmptyString)(e.Door),floor:(0,u.defaultToEmptyString)(e.Floor),stairs:(0,u.defaultToEmptyString)(e.Stairs),state:(0,d.findStateName)((0,u.defaultToEmptyString)(e.State)),stateCode:(0,d.findStateCode)((0,u.defaultToEmptyString)(e.LocaleFormat),(0,u.defaultToEmptyString)(e.State)),stateLevel2:(0,d.findStateLevel2Name)((0,u.defaultToEmptyString)(e.StateLevel2)),streetName:(0,u.defaultToEmptyString)(e.StreetName),streetNumber:(0,u.defaultToEmptyString)(e.StreetNumber),streetTitle:(0,u.defaultToEmptyString)(e.StreetTitle),zipCode:(0,u.defaultToEmptyString)(e.ZipCode)});t.addressListView=e=>e.map(t.addressAutofillView);t.bankAccountAutofillView=e=>{const t=(0,i.getBankInfoFromBankAccountData)(e);return{...p(e),vaultType:o.VaultSourceType.BankAccount,name:(0,u.defaultToEmptyString)(e.BankAccountName),owner:(0,u.defaultToEmptyString)(e.BankAccountOwner),IBAN:(0,u.defaultToEmptyString)(e.BankAccountIBAN),BIC:(0,u.defaultToEmptyString)(e.BankAccountBIC),bank:t.bank,country:(0,u.defaultToUS)(e.LocaleFormat),bankCode:t.bankCode}};t.bankAccountListView=e=>e.map(t.bankAccountAutofillView);t.companyAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Company,name:(0,u.defaultToEmptyString)(e.Name),jobTitle:(0,u.defaultToEmptyString)(e.JobTitle)});t.companyListView=e=>e.map(t.companyAutofillView);t.credentialAutofillView=(e,t,r)=>({...p(t),vaultType:o.VaultSourceType.Credential,autoProtected:(0,a.defaultTo)(!1,t.AutoProtected),autoLogin:(0,a.defaultTo)(!1,t.AutoLogin),categoryName:t.CategoryName,email:(0,u.defaultToEmptyString)(t.Email),hasOtp:Boolean(t.OtpSecret)||Boolean(t.OtpUrl),matchType:(0,u.getDomainMatchTypeForHermes)(e,t),login:(0,u.defaultToEmptyString)(t.Login),otpSecret:(0,u.defaultToEmptyString)(t.OtpSecret),otpUrl:(0,u.defaultToEmptyString)(t.OtpUrl),password:(0,u.defaultToEmptyString)(t.Password),subdomainOnly:t.SubdomainOnly||!1,sharingStatus:r,title:(0,u.defaultToEmptyString)(t.Title||(0,s.getDomainForCredential)(t)),secondaryLogin:t.SecondaryLogin,url:(0,u.defaultToEmptyString)(t.Url),userAddedLinkedWebsites:(0,l.getUserAddedLinkedWebsiteDomains)(t)});t.credentialListView=e=>e.map((({domain:e,credential:r,sharingStatus:o})=>(0,t.credentialAutofillView)(e,r,o)));t.driverLicenseAutofillView=e=>{const t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:o.VaultSourceType.DriverLicense,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,u.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId,state:e.State}};t.driverLicenseListView=e=>e.map(t.driverLicenseAutofillView);t.emailAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Email,email:(0,u.defaultToEmptyString)(e.Email),name:(0,u.defaultToEmptyString)(e.EmailName),type:e.Type||"NO_TYPE"});t.emailListView=e=>e.map(t.emailAutofillView);t.fiscalIdAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.FiscalId,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),idNumber:(0,u.defaultToEmptyString)(e.FiscalNumber),teledeclarantNumber:(0,u.defaultToEmptyString)(e.TeledeclarantNumber),creationDate:(0,u.defaultToZero)(e.CreationDatetime)});t.fiscalIdListView=e=>e.map(t.fiscalIdAutofillView);t.generatedPasswordAutofillView=e=>({vaultType:o.VaultSourceType.GeneratedPassword,domain:(0,u.defaultToEmptyString)(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id});t.generatedPasswordListView=e=>e.map(t.generatedPasswordAutofillView);t.identityAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Identity,age:(0,u.getAgeFromIdentity)(e),birthDate:(0,u.defaultToEmptyString)(e.BirthDate),birthPlace:(0,u.defaultToEmptyString)(e.BirthPlace),firstName:(0,u.defaultToEmptyString)(e.FirstName),lastName2:(0,u.defaultToEmptyString)(e.LastName2),lastName:(0,u.defaultToEmptyString)(e.LastName),middleName:(0,u.defaultToEmptyString)(e.MiddleName),middleNameInitial:(0,u.defaultToEmptyString)(e.MiddleName),pseudo:(0,u.defaultToEmptyString)(e.Pseudo),title:e.Title});t.identityListView=e=>e.map(t.identityAutofillView);t.idCardAutofillView=e=>{const t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:o.VaultSourceType.IdCard,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,u.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId}};t.idCardListView=e=>e.map(t.idCardAutofillView);t.noteAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Note});t.noteListView=e=>e.map(t.noteAutofillView);t.passportAutofillView=e=>{const t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:o.VaultSourceType.Passport,idNumber:(0,u.defaultToEmptyString)(e.Number),country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",deliveryPlace:(0,u.defaultToEmptyString)(e.DeliveryPlace),creationDate:(0,u.defaultToZero)(e.CreationDatetime)}};t.passportListView=e=>e.map(t.passportAutofillView);t.paymentCardAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.PaymentCard,bank:(0,u.defaultToEmptyString)(e.Bank),cardNumber:(0,u.defaultToEmptyString)(e.CardNumber),cardNumberLastDigits:(0,n.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||n.defaultColor,expireMonth:(0,u.defaultToEmptyString)(e.ExpireMonth),expireYear:(0,u.defaultToEmptyString)(e.ExpireYear),name:(0,u.defaultToEmptyString)(e.Name),ownerName:(0,u.defaultToEmptyString)(e.OwnerName),securityCode:(0,u.defaultToEmptyString)(e.SecurityCode),type:e.Type});t.paymentCardListView=e=>e.map(t.paymentCardAutofillView);t.personalWebsiteAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.PersonalWebsite,name:(0,u.defaultToEmptyString)(e.Name),website:(0,u.defaultToEmptyString)(e.Website)});t.personalWebsiteListView=e=>e.map(t.personalWebsiteAutofillView);t.phoneAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.Phone,name:(0,u.defaultToEmptyString)(e.PhoneName),numberInternational:(0,u.defaultToEmptyString)(e.NumberNational),number:(0,u.defaultToEmptyString)(e.Number),type:e.Type});t.phoneListView=e=>e.map(t.phoneAutofillView);t.socialSecurityIdAutofillView=e=>({...p(e),vaultType:o.VaultSourceType.SocialSecurityId,name:(0,c.identityToName)(e.identity)||e.SocialSecurityFullname||"",idNumber:(0,u.defaultToEmptyString)(e.SocialSecurityNumber),country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime)});t.socialSecurityIdListView=e=>e.map(t.socialSecurityIdAutofillView);t.passkeyAutofillView=e=>({...p(e),credentialId:e.CredentialId,privateKey:e.PrivateKey,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle,vaultType:o.VaultSourceType.Passkey,counter:e.Counter,keyAlgorithm:e.KeyAlgorithm})},62922:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(42517),t),a(r(21871),t)},42517:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isOtherDataSource=t.isVaultDataSource=void 0;const o=r(74127);t.isVaultDataSource=e=>(0,o.isVaultSourceType)(e.type);t.isOtherDataSource=e=>(0,o.isOtherSourceType)(e.type)},21871:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultSourceTypeToDataModelTypeMap=void 0;const o=r(74127),a=r(53576);t.vaultSourceTypeToDataModelTypeMap={[o.VaultSourceType.Address]:a.DataModelType.KWAddress,[o.VaultSourceType.BankAccount]:a.DataModelType.KWBankStatement,[o.VaultSourceType.Company]:a.DataModelType.KWCompany,[o.VaultSourceType.Credential]:a.DataModelType.KWAuthentifiant,[o.VaultSourceType.CredentialCategory]:a.DataModelType.KWAuthCategory,[o.VaultSourceType.DriverLicense]:a.DataModelType.KWDriverLicence,[o.VaultSourceType.Email]:a.DataModelType.KWEmail,[o.VaultSourceType.FiscalId]:a.DataModelType.KWFiscalStatement,[o.VaultSourceType.GeneratedPassword]:a.DataModelType.KWGeneratedPassword,[o.VaultSourceType.IdCard]:a.DataModelType.KWIDCard,[o.VaultSourceType.Identity]:a.DataModelType.KWIdentity,[o.VaultSourceType.NoteCategory]:a.DataModelType.KWSecureNoteCategory,[o.VaultSourceType.Note]:a.DataModelType.KWSecureNote,[o.VaultSourceType.Passkey]:a.DataModelType.KWPasskey,[o.VaultSourceType.Passport]:a.DataModelType.KWPassport,[o.VaultSourceType.PaymentCard]:a.DataModelType.KWPaymentMean_creditCard,[o.VaultSourceType.PersonalWebsite]:a.DataModelType.KWPersonalWebsite,[o.VaultSourceType.Phone]:a.DataModelType.KWPhone,[o.VaultSourceType.SocialSecurityId]:a.DataModelType.KWSocialSecurityStatement}},7006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(19083),a=r(50059);t.config={commands:{changeMasterPassword:{handler:o.changeMasterPassword}},queries:{},liveQueries:{liveChangeMasterPasswordStatus:{subject:a.getChangeMasterPasswordStatus$}}}},50059:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeMasterPasswordStatus$=t.emitChangeMasterPasswordStatus=void 0;const o=new(r(18948).Subject);t.emitChangeMasterPasswordStatus=e=>o.next(e);t.getChangeMasterPasswordStatus$=()=>o},33441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeMasterPasswordStepNeeded=t.ChangeMasterPasswordCode=t.ChangeMPFlowPath=void 0;var o=r(61380);Object.defineProperty(t,"ChangeMPFlowPath",{enumerable:!0,get:function(){return o.ChangeMPFlowPath}}),Object.defineProperty(t,"ChangeMasterPasswordCode",{enumerable:!0,get:function(){return o.ChangeMasterPasswordCode}}),Object.defineProperty(t,"ChangeMasterPasswordStepNeeded",{enumerable:!0,get:function(){return o.ChangeMasterPasswordStepNeeded}})},35186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(7006);t.bootstrap=e=>{e.register(o.config)}},19083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMasterPassword=void 0;const o=r(50059),a=r(61380),i=r(33740),n=r(13141),s=r(37515),c=r(78238),l=r(41383),d=r(46298),u=r(88610),p=r(47820),S=r(16593),g=r(16194),m=r(61740),y=r(92233),h=r(61984),v=r(18948),f=r(61475),A=r(88205),P=r(92263),b=r(70252),w=r(61394),T=r(27517);t.changeMasterPassword=async(e,t)=>{const{applicationModulesAccess:r,storeService:_,masterPasswordEncryptorService:I,remoteDataEncryptorService:E,sessionService:C,localStorageService:D,storageService:O,eventLoggerService:M}=e,{queries:{isMasterPasswordLeaked:N,isMasterPasswordWeak:F},commands:{temporaryResetMasterPasswordLeaked:U}}=r.createClients().masterPasswordSecurity,{flow:L}=t,R=await(0,i.preValidationForChangeMP)(e,t);if(!1===R.success)return R;const k=_.getState(),B=await(0,A.makeFeatureFlipsSelectors)(r).featureFlipsSelector(),j=(0,S.isRemoteKeyActivatedSelector)(k)?E:I;(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DOWNLOAD,value:10});const V=(0,S.userLoginSelector)(k);if(!V)return(0,i.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,L);let W;try{W=r.createClients(),await W.session.commands.prepareLocalDataFlush(),_.dispatch((0,g.changeMPStart)())}catch(e){const t=P.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","prepareLocalDataFlushError").addAdditionalInfo({comment:"Failed to prepare local data on graphene"});throw(0,b.sendExceptionLog)({error:t}),e}const K=await(0,d.getDataForMasterPasswordChange)(_,V,{});if((0,d.isApiError)(K))return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.DownloadError),_.dispatch((0,g.changeMPDone)()),(0,i.makeUnexpectedErrorObject)(K.message,L);const{serverKey:H}=_.getUserSession();if(!(0,i.isOtpStatusValid)(K.otpStatus,H))return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.LoginError),_.dispatch((0,g.changeMPDone)()),(0,i.makeReturnErrorObject)(a.ChangeMasterPasswordCode.OTP_PROBLEM,L);const{timestamp:G}=K,{transactions:x,sharingKeys:Q}=K.data;try{const d=await(0,i.deCipherAllTransactions)(C,j,x),S=D.getInstance(),A=await S.doesLocalKeyExist();let I=null;A&&(I=await S.getLocalKey());const{publicKey:E}=Q,R=await(0,i.decipherPrivateKey)(_,j,Q);let k;switch(await(0,m.cleanRememberMeStorageData)(_,O),t.flow){case a.ChangeMPFlowPath.MP_TO_SSO:k=await(0,s.handleMigrationMPtoSso)(e,t,d,R,E,G);break;case a.ChangeMPFlowPath.SSO_TO_MP:k=await(0,c.handleMigrationSSOtoMP)(e,t,d,R,E,G);break;case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:k=await(0,n.handleMigrationToEmailToken)(e,t,d,R,E,G);break;case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case a.ChangeMPFlowPath.USER_CHANGING_MP:default:k=await(0,l.handleUserChangingMP)(e,t,d,R,E,G)}if(!k.success)return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.UnknownError),_.dispatch((0,g.changeMPDone)()),k;await W.session.commands.flushLocalData();const K=Boolean(_.getPersonalSettings().AccountRecoveryKey);try{K&&(await(0,w.deactivateAccountRecoveryKey)(_,V,{reason:"VAULT_KEY_CHANGE"}),(0,h.logUserDeleteAccountRecoveryKey)(M),e.storeService.dispatch((0,T.editPersonalSettings)({AccountRecoveryKey:void 0,AccountRecoveryKeyId:void 0})))}catch(e){const t=P.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","deactivateRecoveryKey").addAdditionalInfo({comment:"Failed to deactivate recovery key after successful mp change"});await(0,b.sendExceptionLog)({error:t})}let H,$;I&&await C.getInstance().user.persistLocalKey(I),await(0,p.storeSessionCredentialForRecovery)(_,D),(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DONE,value:100}),await(0,i.resetMigrationState)(e,L),L===a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY||L===a.ChangeMPFlowPath.MP_TO_SSO||L===a.ChangeMPFlowPath.SSO_TO_MP?await(0,u.sessionDidOpen)(e):K&&await e.sessionService.getInstance().user.attemptSync(y.Trigger.ChangeMasterPassword);try{H=await(0,v.firstValueFrom)(N())}catch(e){const t=P.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordLeakedError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordLeaked"});throw(0,b.sendExceptionLog)({error:t}),e}try{$=B.ims_web_weak_mp_prod?await(0,v.firstValueFrom)(F()):null}catch(e){const t=P.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordWeakError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordWeak"});throw(0,b.sendExceptionLog)({error:t}),e}const q=!!(0,f.isSuccess)(H)&&H.data,Y=null===$?void 0:!!(0,f.isSuccess)($)&&$.data;if((0,h.logChangeMasterPasswordComplete)(M,q,Y),_.dispatch((0,g.changeMPDone)()),U(void 0),B.ims_web_weak_mp_prod){const{commands:{temporarySendMasterPasswordChangedEvent:e}}=r.createClients().changeMasterPassword;e(void 0)}return{success:!0,response:{reason:a.ChangeMasterPasswordCode.SUCCESS}}}catch(r){if((0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.UnknownError),t.flow!==a.ChangeMPFlowPath.MP_TO_SSO&&t.flow!==a.ChangeMPFlowPath.SSO_TO_MP){const r=(0,i.extractCurrentPassword)(k,t);(0,i.revertOnError)(e,j,{currentPassword:r,serverKey:H})}else(0,i.logoutUserOnError)(e);return(0,i.makeUnexpectedErrorObject)(r.message,L)}}},13141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationToEmailToken=void 0;const o=r(92233),a=r(16593),i=r(50059),n=r(61380),s=r(33740),c=r(46298),l=r(16356),d=r(61984);t.handleMigrationToEmailToken=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:h}=e,{newPassword:v,flow:f,currentPassword:A}=t,{serverKey:P}=g.getUserSession(),b=g.getState(),w=(0,a.userLoginSelector)(b);if(!w)return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,f);const T=(0,s.returnProperCryptoConfig)(g);y.setInstance({raw:v},"",T),g.dispatch((0,l.updateMasterPassword)(v)),g.dispatch((0,l.updateServerKey)(""));g.dispatch((0,l.updateRemoteKey)(null));const{authTicket:_}=(0,a.authTicketInfoSelector)(b),I=await(0,s.cipherTransactionWithNewMP)(g,m,y,r,f),E=await(0,s.cipherPrivateKey)(y,u),C={timestamp:S,transactions:(0,s.formatTransaction)(I),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:E},authTicket:_};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const D=await(0,c.uploadDataForMasterPasswordChange)(g,w,C);if((0,c.isApiError)(D))return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,y,{currentPassword:A,serverKey:P}),(0,s.makeUnexpectedErrorObject)(D.message,f);const O=await(0,c.confirmMasterPasswordChangeDone)(g,w,{});return(0,c.isApiError)(O)?((0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,y,{currentPassword:A,serverKey:P}),(0,s.makeUnexpectedErrorObject)(O.message,f)):{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}}}},37515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationMPtoSso=void 0;const o=r(92233),a=r(751),i=r(16593),n=r(50059),s=r(61380),c=r(33740),l=r(46298),d=r(61984);t.handleMigrationMPtoSso=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,remoteDataEncryptorService:y,eventLoggerService:h}=e,{newPassword:v,flow:f}=t,A=g.getState(),P=(0,i.userLoginSelector)(A);if(!P)return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.LoginError),(0,c.makeReturnErrorObject)(s.ChangeMasterPasswordCode.UNEXPECTED_STATE,f);const{remoteKey:b,serverKeyBase64:w}=await(0,a.prepareRemoteDataEncryptionServices)(e,v),T=[b],_={type:"sso",ssoServerKey:w},{authTicket:I}=(0,i.authTicketInfoSelector)(A),E=await(0,c.cipherTransactionWithNewMP)(g,m,y,r,f),C=await(0,c.cipherPrivateKey)(y,u),D={timestamp:S,transactions:(0,c.formatTransaction)(E),remoteKeys:T,updateVerification:_,sharingKeys:{publicKey:p,privateKey:C},authTicket:I};(0,n.emitChangeMasterPasswordStatus)({type:s.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const O=await(0,l.uploadDataForMasterPasswordChange)(g,P,D);if((0,l.isApiError)(O))return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.UploadError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(O.message,f);const M=await(0,l.confirmMasterPasswordChangeDone)(g,P,{});return(0,l.isApiError)(M)?((0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.ConfirmationError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(M.message,f)):{success:!0,response:{reason:s.ChangeMasterPasswordCode.SUCCESS}}}},78238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationSSOtoMP=void 0;const o=r(92233),a=r(16593),i=r(50059),n=r(61380),s=r(33740),c=r(46298),l=r(16356),d=r(61984);t.handleMigrationSSOtoMP=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:h}=e,{newPassword:v,flow:f}=t,A=g.getState(),P=(0,a.userLoginSelector)(A);if(!P)return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,f);const b=(0,s.returnProperCryptoConfig)(g);y.setInstance({raw:v},"",b),g.dispatch((0,l.updateMasterPassword)(v)),g.dispatch((0,l.updateServerKey)(""));g.dispatch((0,l.updateRemoteKey)(null));const{authTicket:w}=(0,a.authTicketInfoSelector)(A),T=await(0,s.cipherTransactionWithNewMP)(g,m,y,r,f),_=await(0,s.cipherPrivateKey)(y,u),I={timestamp:S,transactions:(0,s.formatTransaction)(T),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:_},authTicket:w};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const E=await(0,c.uploadDataForMasterPasswordChange)(g,P,I);if((0,c.isApiError)(E))return(0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.UploadError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(E.message,f);const C=await(0,c.confirmMasterPasswordChangeDone)(g,P,{});return(0,c.isApiError)(C)?((0,d.logChangeMasterPasswordError)(h,o.ChangeMasterPasswordError.ConfirmationError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(C.message,f)):{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}}}},41383:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleUserChangingMP=void 0;const o=r(92233),a=r(16593),i=r(50059),n=r(61380),s=r(33740),c=r(46298),l=r(16356),d=r(61984),u=r(33441);t.handleUserChangingMP=async(e,t,r,p,S,g)=>{const{storeService:m,sessionService:y,masterPasswordEncryptorService:h,eventLoggerService:v}=e,f=m.getState(),{newPassword:A,flow:P}=t,b=(0,s.extractCurrentPassword)(f,t),{serverKey:w}=m.getUserSession(),T=(0,a.userLoginSelector)(f);if(!T)return(0,d.logChangeMasterPasswordError)(v,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,P);h.setInstance({raw:A},w),m.dispatch((0,l.updateMasterPassword)(A));const _=await(0,s.cipherTransactionWithNewMP)(m,y,h,r),I=await(0,s.cipherPrivateKey)(h,p),E={timestamp:g,transactions:(0,s.formatTransaction)(_),sharingKeys:{publicKey:S,privateKey:I},uploadReason:P===u.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?"complete_account_recovery":void 0};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const C=await(0,c.uploadDataForMasterPasswordChange)(m,T,E);if((0,c.isApiError)(C))return(0,d.logChangeMasterPasswordError)(v,o.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,h,{currentPassword:b,serverKey:w}),(0,s.makeUnexpectedErrorObject)(C.message,P);const D=await(0,c.confirmMasterPasswordChangeDone)(m,T,{});return(0,c.isApiError)(D)?((0,d.logChangeMasterPasswordError)(v,o.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,h,{currentPassword:b,serverKey:w}),(0,s.makeUnexpectedErrorObject)(D.message,P)):{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}}}},15209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(35186);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},61984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logUserDeleteAccountRecoveryKey=t.logChangeMasterPasswordError=t.logChangeMasterPasswordComplete=t.logChangeMasterPasswordCancel=t.logChangeMasterPasswordStart=void 0;const o=r(92233),a=(e,t,r,a,i)=>{e.logEvent(new o.UserChangeMasterPasswordEvent({flowStep:t,errorName:r||void 0,isLeaked:a,isWeak:i}))};t.logChangeMasterPasswordStart=e=>a(e,o.FlowStep.Start);t.logChangeMasterPasswordCancel=e=>a(e,o.FlowStep.Cancel);t.logChangeMasterPasswordComplete=(e,t,r)=>a(e,o.FlowStep.Complete,void 0,t,r);t.logChangeMasterPasswordError=(e,t)=>a(e,o.FlowStep.Error,t);t.logUserDeleteAccountRecoveryKey=e=>{e.logEvent(new o.UserDeleteAccountRecoveryKeyEvent({deleteKeyReason:o.DeleteKeyReason.VaultKeyChanged}))}},62844:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPinProgressSelector=void 0;t.changeMPinProgressSelector=e=>e.userSession.changeMPData.changeMPinProgress},23486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherPrivateKey=void 0;const o=r(56668);t.cipherPrivateKey=async(e,t)=>{const r=(0,o.utf16ToDeflatedUtf8)(t,{skipDeflate:!0});return await e.getInstance().encrypt(r)}},17696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherTransactionWithNewMP=void 0;const o=r(61380),a=r(33740),i=r(27627),n=r(16859),s=r(75270),c=r(91301),l=r(55623),d=r(27517);t.cipherTransactionWithNewMP=async(e,t,r,u,p,S=!0)=>{const{announce:g}=t.getInstance().user.getSyncArgs(),m=await Promise.all(u.map((async t=>{if(p&&"SETTINGS"===t.type&&t.content){const r={...t,content:await(0,a.getBaseModelFromXml)(g,t.content)};switch(p){case o.ChangeMPFlowPath.MP_TO_SSO:const i={...r.content,CryptoUserPayload:c.CRYPTO_NODERIVATION_HMAC64};return{...r,content:(0,s.getTransactionXml)(i)};case o.ChangeMPFlowPath.SSO_TO_MP:const n={forceSalt:(0,l.getRandomValues)(16),cryptoConfig:(0,a.returnProperCryptoConfig)(e)},u=(0,a.returnProperSettingContent)(e,r,n);return e.dispatch((0,d.editPersonalSettings)(u)),{...t,content:(0,s.getTransactionXml)(u)};case o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case o.ChangeMPFlowPath.USER_CHANGING_MP:case o.ChangeMPFlowPath.TO_EMAIL_TOKEN:}}return t}))),y=m.length,h=S?(0,a.initializeProgress)(o.ChangeMasterPasswordStepNeeded.ENCRYPTING,100,y):null,v=async(e,t)=>{h&&h(),t(await(0,n.encryptSingleTransaction)(r,e))};return await new Promise((e=>{(0,i.asyncMapLimit)(m,v,e,100)}))}},68328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deCipherAllTransactions=void 0;const o=r(83638),a=r(61380),i=r(33740),n=r(27627),s=r(16859),c=r(82761),l=r(70252),d=r(92263);t.deCipherAllTransactions=async(e,t,r,u=!0)=>{const{announce:p}=e.getInstance().user.getSyncArgs(),S=t.getInstance(),g=r.length,m=u?(0,i.initializeProgress)(a.ChangeMasterPasswordStepNeeded.DECRYPTING,100,g):null,y=async(e,t)=>{if(m&&m(),e.content)try{const r=await(0,s.decryptTransactionContent)(S,p,e);t({...e,content:r})}catch(r){if(e.type===o.TransactionType.SETTINGS){const t=d.CarbonError.fromAnyError(r).addContextInfo("CHANGE_MP","decipherAllTransactions").addAdditionalInfo({comment:r.message??`Transaction of type ${e.type} couldn't be decrypted`});throw(0,l.sendExceptionLog)({error:t}),r}t(null)}else t(e)},h=await new Promise((e=>{(0,n.asyncMapLimit)(r,y,e,100)}));return(0,c.sanitizeTransactions)(h)}},74931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherPrivateKey=void 0;const o=r(56668),a=r(16356);t.decipherPrivateKey=async(e,t,r)=>{const i=await t.getInstance().decrypt(r.privateKey),n=(0,o.deflatedUtf8ToUtf16)(i,{skipInflate:!0}),s={privateKey:n,publicKey:r.publicKey};return e.dispatch((0,a.updateKeyPair)(s)),n}},60950:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatTransaction=void 0;t.formatTransaction=e=>e.map((({action:e,content:t,identifier:r,time:o,type:a})=>({action:e,content:t,identifier:r,time:o,type:a})))},10078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseModelFromXml=void 0;const o=r(80469),a=r(16859),i=r(51104);t.getBaseModelFromXml=async(e,t)=>{const r=await(0,a.parseTransactionContentXml)(e,t);return i.fixPersonalSettingTypes.fromTransaction((0,o.fixKwType)(r))}},33740:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(23486),t),a(r(17696),t),a(r(74931),t),a(r(68328),t),a(r(60950),t),a(r(10078),t),a(r(39463),t),a(r(90673),t),a(r(17433),t),a(r(99849),t),a(r(14224),t),a(r(61484),t),a(r(16494),t),a(r(55612),t),a(r(78028),t),a(r(55429),t)},39463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initializeProgress=void 0;const o=r(50059),a=r(61380);t.initializeProgress=(e,t,r)=>{const i=e===a.ChangeMasterPasswordStepNeeded.DECRYPTING?10:50;let n=0;return()=>{n++,n%t!=0&&n!==r||(0,o.emitChangeMasterPasswordStatus)({type:e,value:i+Math.round(40*n/r)})}}},90673:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isOtpStatusValid=void 0;t.isOtpStatusValid=(e,t)=>{switch(e){case"login":return t&&t.length>0;case"disabled":case"newDevice":case"sso":return!t||0===t.length;default:return!1}}},17433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logoutUserOnError=void 0;const o=r(16194),a=r(1965),i=r(16593);t.logoutUserOnError=async e=>{const{storeService:t,storageService:r,sessionService:n,applicationModulesAccess:s}=e,c=(0,i.userLoginSelector)(t.getState());t.dispatch((0,o.changeMPDone)()),c&&(0,a.wipeOutLocalAccounts)(r,s,[c]),n.close()}},99849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeReturnErrorObject=void 0;const o=r(50059),a=r(61380),i=r(70252);t.makeReturnErrorObject=(e,t)=>{(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.ERROR,value:100});const r=new Error(`[ChangeMP] ${t}: ${e}`);return(0,i.sendExceptionLog)({error:r}),{success:!1,error:{code:e}}}},14224:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUnexpectedErrorObject=void 0;const o=r(61380),a=r(70252);t.makeUnexpectedErrorObject=(e,t)=>{const r=new Error(`[ChangeMP] - Unexpected - ${t}: ${e}`);return(0,a.sendExceptionLog)({error:r}),{success:!1,error:{code:o.ChangeMasterPasswordCode.UNKNOWN_ERROR,message:e}}}},61484:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.preValidationForChangeMP=t.extractCurrentPassword=void 0;const o=r(61380),a=r(57903),i=r(64948),n=r(16593),s=r(29303),c=r(88205),l=r(33740),d=r(28287),u=r(71012);t.extractCurrentPassword=(e,t)=>t.flow===o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?(0,s.recoveryDataSelector)(e).currentPassword:t.currentPassword;t.preValidationForChangeMP=async(e,t)=>{const{applicationModulesAccess:r,masterPasswordEncryptorService:s,storeService:p}=e,{newPassword:S,flow:g}=t;if(!await(0,a.waitUntilSyncComplete)(p))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.SYNC_PROGRESS,g);const m=p.getState(),y=await(0,c.makeFeatureFlipsSelectors)(r).featureFlipsSelector();if(!p.getAccountInfo().isAuthenticated)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INNACTIVE_SESSION,g);if(y[o.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP])return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.FEATURE_BLOCKED,g);const h=await(0,i.evaluatePasswordStrengthOutOfFive)(S);if(!S||!h||h<u.minAcceptablePasswordStrength)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.MP_STRENGTH_ERROR,g);const v=(0,n.isRemoteKeyActivatedSelector)(m),f=9e5,{authTicket:A,date:P}=(0,n.authTicketInfoSelector)(m);if(!(0,n.userLoginSelector)(m))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);switch(t.flow){case o.ChangeMPFlowPath.MP_TO_SSO:if(!A||!P||Date.now()-P>f)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INVALID_TOKEN,g);if(v)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);break;case o.ChangeMPFlowPath.SSO_TO_MP:if(!A||!P||Date.now()-P>f)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INVALID_TOKEN,g);if(!v)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);break;case o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:break;case o.ChangeMPFlowPath.TO_EMAIL_TOKEN:case o.ChangeMPFlowPath.USER_CHANGING_MP:case o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:{const{currentPassword:e}=t;if(g!==o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY&&e===S)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.MP_ERROR,g);if(!await(0,d.validateMasterPassword)(p,s,e))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.WRONG_PASSWORD,g)}break;default:return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g)}return{success:!0}}},16494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMigrationState=void 0;const o=r(61380),a=r(95363),i=r(7624);t.resetMigrationState=async(e,t)=>{if(t===o.ChangeMPFlowPath.USER_CHANGING_MP||t===o.ChangeMPFlowPath.TO_EMAIL_TOKEN||t===o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY)return;const{storeService:r}=e;r.dispatch((0,a.resetRecoverySessionData)()),r.dispatch((0,i.resetSSOSettings)()),t===o.ChangeMPFlowPath.MP_TO_SSO&&r.dispatch((0,i.storeSSOSettings)({ssoUser:!0}))}},55612:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperCryptoConfig=void 0;const o=r(56668),a=r(65675),i=r(92310);t.returnProperCryptoConfig=e=>{let t=o.ARGON2_DEFAULT_PAYLOAD;const r=(0,i.currentSpaceInfoSelector)(e.getState());r?.cryptoForcedPayload&&(t=r.cryptoForcedPayload);try{return(0,a.parsePayload)(t).cryptoConfig}catch(e){return(0,a.makeFlexibleMarkerCryptoConfig)("argon2d")}}},78028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperSettingContent=void 0;const o=r(56668),a=r(16038),i=r(95648),n=r(92310);t.returnProperSettingContent=(e,t,r)=>{let s=o.ARGON2_DEFAULT_PAYLOAD;const c=(0,n.currentSpaceInfoSelector)(e.getState());return c?.cryptoForcedPayload&&(s=c.cryptoForcedPayload),{...(0,i.makeBasePersonalSettings)(),...t.content,CryptoUserPayload:s,CryptoFixedSalt:(0,a.bufferToBase64)(r.forceSalt)}}},55429:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.revertOnError=void 0;const o=r(16194),a=r(16356);t.revertOnError=async(e,t,r)=>{const{currentPassword:i,serverKey:n}=r,{storeService:s}=e;t.setInstance({raw:i},n),s.dispatch((0,a.updateMasterPassword)(i)),s.dispatch((0,a.updateServerKey)(n)),s.dispatch((0,o.changeMPDone)())}},61380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeMasterPasswordStepNeeded=t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP=t.ChangeMasterPasswordCode=t.ChangeMPFlowPath=void 0,function(e){e.USER_CHANGING_MP="USER_CHANGING_MP",e.MP_TO_SSO="MP_TO_SSO",e.SSO_TO_MP="SSO_TO_MP",e.TO_EMAIL_TOKEN="EMAIL_TOKEN",e.ADMIN_ASSISTED_RECOVERY="ADMIN_ASSISTED_RECOVERY",e.ACCOUNT_RECOVERY_KEY="ACCOUNT_RECOVERY_KEY"}(t.ChangeMPFlowPath||(t.ChangeMPFlowPath={})),function(e){e.FEATURE_BLOCKED="feature_blocked",e.INNACTIVE_SESSION="inactive_session",e.INVALID_TOKEN="invalid_token",e.OTP_PROBLEM="otp_problem",e.MP_ERROR="mp_error",e.MP_STRENGTH_ERROR="mp_strength_error",e.SUCCESS="success",e.SYNC_PROGRESS="sync_in_progress",e.UNKNOWN_ERROR="unknown_error",e.WRONG_PASSWORD="wrong_password",e.UNEXPECTED_STATE="unexpected_state"}(t.ChangeMasterPasswordCode||(t.ChangeMasterPasswordCode={})),t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP="disableChangeMpOnWeb",function(e){e.DOWNLOAD="download",e.DECRYPTING="decrypting",e.ENCRYPTING="encrypting",e.UPLOADING="uploading",e.DONE="done",e.ERROR="error"}(t.ChangeMasterPasswordStepNeeded||(t.ChangeMasterPasswordStepNeeded={}))},58977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.abTestsLiveQueries=t.abTestsQueries=t.abTestsCommands=void 0;const o=r(71796);t.abTestsCommands={participateToUserABTest:(0,o.slot)()},t.abTestsQueries={getUserABTestVariant:(0,o.slot)()},t.abTestsLiveQueries={liveUserABTestVariant:(0,o.slot)()}},20266:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountCreationLiveQueries=void 0;const o=r(15911);t.accountCreationLiveQueries={liveAccountCreated:(0,o.liveSlot)()}},32437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingLiveQueries=void 0;const o=r(15911);t.antiPhishingLiveQueries={livePhishingURLList:(0,o.liveSlot)()}},65770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationLiveQueries=t.authenticationQueries=t.authenticationCommands=void 0;const o=r(71796),a=r(15911);t.authenticationCommands={requestExtraDeviceToken:(0,o.slot)(),requestEmailToken:(0,o.slot)(),requestPaymentUpdateAuthenticationToken:(0,o.slot)(),setReactivationStatus:(0,o.slot)(),refreshU2FDevicesList:(0,o.slot)(),removeU2FAuthenticator:(0,o.slot)(),refreshTwoFactorAuthenticationInfo:(0,o.slot)(),enableWebAuthnAuthentication:(0,o.slot)(),initEnableWebAuthnAuthentication:(0,o.slot)(),refreshAvailableWebAuthnAuthenticators:(0,o.slot)(),refreshWebAuthnAuthenticators:(0,o.slot)(),initRegisterWebAuthnAuthenticator:(0,o.slot)(),registerWebAuthnAuthenticator:(0,o.slot)(),initOpenSessionWithWebAuthnAuthenticator:(0,o.slot)(),openSessionWithWebAuthnAuthenticator:(0,o.slot)(),disableWebAuthnAuthentication:(0,o.slot)(),removeWebAuthnAuthenticator:(0,o.slot)(),startTwoFactorAuthenticationEnableFlow:(0,o.slot)(),stopTwoFactorAuthenticationEnableFlow:(0,o.slot)(),continueTwoFactorAuthenticationEnableFlow:(0,o.slot)(),backTwoFactorAuthenticationEnableFlow:(0,o.slot)(),startTwoFactorAuthenticationDisableFlow:(0,o.slot)(),stopTwoFactorAuthenticationDisableFlow:(0,o.slot)(),continueTwoFactorAuthenticationDisableFlow:(0,o.slot)(),backTwoFactorAuthenticationDisableFlow:(0,o.slot)()},t.authenticationQueries={getHasOtp2Type:(0,o.slot)(),getUserOtpType:(0,o.slot)(),getReactivationStatus:(0,o.slot)(),getAvailableUserVerificationMethods:(0,o.slot)(),getU2FDevicesList:(0,o.slot)(),getWebAuthnAuthenticators:(0,o.slot)(),getWebAuthnAuthenticationOptedIn:(0,o.slot)(),getTwoFactorAuthenticationEnableStage:(0,o.slot)(),getTwoFactorAuthenticationDisableStage:(0,o.slot)()},t.authenticationLiveQueries={liveReactivationStatus:(0,a.liveSlot)(),liveU2FDevicesList:(0,a.liveSlot)(),liveWebAuthnAuthenticators:(0,a.liveSlot)(),liveWebAuthnAuthenticationOptedIn:(0,a.liveSlot)(),liveTwoFactorAuthenticationEnableStage:(0,a.liveSlot)(),liveTwoFactorAuthenticationDisableStage:(0,a.liveSlot)()}},35090:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.autofillDataQueries=t.autofillDataCommands=void 0;const o=r(71796);t.autofillDataCommands={},t.autofillDataQueries={getSingleAddressForAutofill:(0,o.slot)(),getMultipleAddressesForAutofill:(0,o.slot)(),getSingleBankAccountForAutofill:(0,o.slot)(),getMultipleBankAccountsForAutofill:(0,o.slot)(),getSingleCompanyForAutofill:(0,o.slot)(),getMultipleCompaniesForAutofill:(0,o.slot)(),getSingleCredentialForAutofill:(0,o.slot)(),getMultipleCredentialsForAutofill:(0,o.slot)(),getSingleDriverLicenseForAutofill:(0,o.slot)(),getMultipleDriverLicensesForAutofill:(0,o.slot)(),getSingleEmailForAutofill:(0,o.slot)(),getMultipleEmailsForAutofill:(0,o.slot)(),getSingleFiscalIdForAutofill:(0,o.slot)(),getMultipleFiscalIdsForAutofill:(0,o.slot)(),getSingleGeneratedPasswordForAutofill:(0,o.slot)(),getMultipleGeneratedPasswordsForAutofill:(0,o.slot)(),getSingleIdCardForAutofill:(0,o.slot)(),getMultipleIdCardsForAutofill:(0,o.slot)(),getSingleIdentityForAutofill:(0,o.slot)(),getMultipleIdentitiesForAutofill:(0,o.slot)(),getSingleNoteForAutofill:(0,o.slot)(),getMultipleNotesForAutofill:(0,o.slot)(),getSinglePasskeyForAutofill:(0,o.slot)(),getSinglePassportForAutofill:(0,o.slot)(),getMultiplePassportsForAutofill:(0,o.slot)(),getSinglePaymentCardForAutofill:(0,o.slot)(),getMultiplePaymentCardsForAutofill:(0,o.slot)(),getSinglePersonalWebsiteForAutofill:(0,o.slot)(),getMultiplePersonalWebsitesForAutofill:(0,o.slot)(),getSinglePhoneForAutofill:(0,o.slot)(),getMultiplePhonesForAutofill:(0,o.slot)(),getSingleSocialSecurityIdForAutofill:(0,o.slot)(),getMultipleSocialSecurityIdsForAutofill:(0,o.slot)(),getAutofillSettingOnUrlForAutofill:(0,o.slot)()}},10330:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMasterPasswordLiveQueries=t.changeMasterPasswordQueries=t.changeMasterPasswordCommands=void 0;const o=r(71796),a=r(15911);t.changeMasterPasswordCommands={changeMasterPassword:(0,o.slot)()},t.changeMasterPasswordQueries={},t.changeMasterPasswordLiveQueries={liveChangeMasterPasswordStatus:(0,a.liveSlot)()}},63736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfoLiveQueries=t.contactInfoQueries=t.contactInfoCommands=void 0;const o=r(71796),a=r(15911);t.contactInfoCommands={editContactInfo:(0,o.slot)()},t.contactInfoQueries={getContactInfo:(0,o.slot)()},t.contactInfoLiveQueries={liveContactInfo:(0,a.liveSlot)()}},90:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cryptoMigrationLiveQueries=t.cryptoMigrationQueries=t.cryptoMigrationCommands=void 0;const o=r(71796),a=r(15911);t.cryptoMigrationCommands={changeUserCrypto:(0,o.slot)()},t.cryptoMigrationQueries={getCanUserChangeCrypto:(0,o.slot)(),getUserDerivationMethod:(0,o.slot)()},t.cryptoMigrationLiveQueries={liveUserDerivationMethod:(0,a.liveSlot)()}},36551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.darkWebInsightsCommands=void 0;const o=r(71796);t.darkWebInsightsCommands={getDarkWebInsightsReportResults:(0,o.slot)(),getDarkWebInsightsSummary:(0,o.slot)()}},36060:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dataManagementCommands=t.dataManagementLiveQueries=t.dataManagementQueries=void 0;const o=r(71796),a=r(15911);t.dataManagementQueries={getAddresses:(0,o.slot)(),getAddress:(0,o.slot)(),getAnonymousUserId:(0,o.slot)(),getBankAccount:(0,o.slot)(),getBankAccounts:(0,o.slot)(),getBreach:(0,o.slot)(),getBreaches:(0,o.slot)(),getBreachesPage:(0,o.slot)(),getBreachesPaginationToken:(0,o.slot)(),getCompanies:(0,o.slot)(),getCompany:(0,o.slot)(),canUserAddNewCredential:(0,o.slot)(),getCredential:(0,o.slot)(),getCredentialCategories:(0,o.slot)(),getCredentials:(0,o.slot)(),getCredentialsByDomain:(0,o.slot)(),getCredentialsCount:(0,o.slot)(),getCredentialLimitStatus:(0,o.slot)(),getCredentialsPage:(0,o.slot)(),getCredentialsPaginationToken:(0,o.slot)(),getShouldShowRequireMasterPassword:(0,o.slot)(),getDashlaneDefinedLinkedWebsites:(0,o.slot)(),getDriverLicense:(0,o.slot)(),getDriverLicenses:(0,o.slot)(),getEmail:(0,o.slot)(),getEmails:(0,o.slot)(),getFiscalId:(0,o.slot)(),getFiscalIds:(0,o.slot)(),getGeneratedPassword:(0,o.slot)(),getGeneratedPasswordsCount:(0,o.slot)(),getGeneratedPasswords:(0,o.slot)(),getGeneratedPasswordsPage:(0,o.slot)(),getGeneratedPasswordsPaginationToken:(0,o.slot)(),getIdCard:(0,o.slot)(),getIdCards:(0,o.slot)(),getIdentities:(0,o.slot)(),getIdentitiesCount:(0,o.slot)(),getIdentity:(0,o.slot)(),getImportPersonalDataStatus:(0,o.slot)(),getIsForcedDomainsEnabled:(0,o.slot)(),getNote:(0,o.slot)(),getNoteCategories:(0,o.slot)(),getNotes:(0,o.slot)(),getNotesCount:(0,o.slot)(),getNotesPage:(0,o.slot)(),getNotesPaginationToken:(0,o.slot)(),getPasswordHistory:(0,o.slot)(),getHasPasswordHistory:(0,o.slot)(),getPasswordHistoryPage:(0,o.slot)(),getPasswordHistoryPaginationToken:(0,o.slot)(),getPasskey:(0,o.slot)(),getPasskeys:(0,o.slot)(),getPasskeysForDomain:(0,o.slot)(),getPassport:(0,o.slot)(),getPassports:(0,o.slot)(),getPaymentCard:(0,o.slot)(),getPaymentCards:(0,o.slot)(),getPersonalWebsite:(0,o.slot)(),getPersonalWebsites:(0,o.slot)(),getPhone:(0,o.slot)(),getPhones:(0,o.slot)(),getSocialSecurityId:(0,o.slot)(),getSocialSecurityIds:(0,o.slot)(),getBreachesUpdateStatus:(0,o.slot)(),getSpace:(0,o.slot)(),getSpaces:(0,o.slot)(),getIsUrlBanished:(0,o.slot)(),arePasswordsProtected:(0,o.slot)(),getSecureFilesInfoList:(0,o.slot)(),getFileDownloadProgress:(0,o.slot)(),getFileUploadProgress:(0,o.slot)(),getSecureFilesQuota:(0,o.slot)(),getAutofillProtectionContext:(0,o.slot)()},t.dataManagementLiveQueries={liveAddress:(0,a.liveSlot)(),liveAddresses:(0,a.liveSlot)(),liveBankAccount:(0,a.liveSlot)(),liveBankAccounts:(0,a.liveSlot)(),liveBreach:(0,a.liveSlot)(),liveBreaches:(0,a.liveSlot)(),liveBreachesBatch:(0,a.liveSlot)(),liveCanUserAddNewCredential:(0,a.liveSlot)(),liveCredential:(0,a.liveSlot)(),liveCredentials:(0,a.liveSlot)(),liveCredentialsByDomain:(0,a.liveSlot)(),liveCredentialsBatch:(0,a.liveSlot)(),liveCredentialsCount:(0,a.liveSlot)(),liveDriverLicense:(0,a.liveSlot)(),liveDriverLicenses:(0,a.liveSlot)(),liveCredentialLimitStatus:(0,a.liveSlot)(),liveCompanies:(0,a.liveSlot)(),liveCompany:(0,a.liveSlot)(),liveEmail:(0,a.liveSlot)(),liveEmails:(0,a.liveSlot)(),liveFiscalId:(0,a.liveSlot)(),liveFiscalIds:(0,a.liveSlot)(),liveGeneratedPasswords:(0,a.liveSlot)(),liveGeneratedPasswordsCount:(0,a.liveSlot)(),liveIdentities:(0,a.liveSlot)(),liveIdentitiesCount:(0,a.liveSlot)(),liveIdentity:(0,a.liveSlot)(),liveIdCard:(0,a.liveSlot)(),liveIdCards:(0,a.liveSlot)(),liveImportPersonalDataStatus:(0,a.liveSlot)(),liveNote:(0,a.liveSlot)(),liveNotes:(0,a.liveSlot)(),liveNotesBatch:(0,a.liveSlot)(),liveNotesCount:(0,a.liveSlot)(),livePasskey:(0,a.liveSlot)(),livePasskeys:(0,a.liveSlot)(),livePassport:(0,a.liveSlot)(),livePassports:(0,a.liveSlot)(),livePasswordHistory:(0,a.liveSlot)(),livePasswordHistoryBatch:(0,a.liveSlot)(),livePaymentCard:(0,a.liveSlot)(),livePaymentCards:(0,a.liveSlot)(),livePersonalWebsite:(0,a.liveSlot)(),livePersonalWebsites:(0,a.liveSlot)(),livePhone:(0,a.liveSlot)(),livePhones:(0,a.liveSlot)(),liveSocialSecurityId:(0,a.liveSlot)(),liveSocialSecurityIds:(0,a.liveSlot)(),liveBreachesUpdaterStatus:(0,a.liveSlot)(),liveArePasswordsProtected:(0,a.liveSlot)(),liveFileDownloadProgress:(0,a.liveSlot)(),liveFileUploadProgress:(0,a.liveSlot)(),liveSecureFilesQuota:(0,a.liveSlot)()},t.dataManagementCommands={addBankAccount:(0,o.slot)(),addCredential:(0,o.slot)(),addDriverLicense:(0,o.slot)(),addFiscalId:(0,o.slot)(),addIdCard:(0,o.slot)(),addPasskey:(0,o.slot)(),addPassport:(0,o.slot)(),addPaymentCard:(0,o.slot)(),addSecureNote:(0,o.slot)(),addSocialSecurityId:(0,o.slot)(),deleteSecureNote:(0,o.slot)(),deleteBankAccount:(0,o.slot)(),deleteCredentialsInBulk:(0,o.slot)(),deleteCredential:(0,o.slot)(),deleteDriverLicense:(0,o.slot)(),deleteFiscalId:(0,o.slot)(),deleteIdCard:(0,o.slot)(),deletePasskey:(0,o.slot)(),deletePassport:(0,o.slot)(),deletePaymentCard:(0,o.slot)(),deleteSocialSecurityId:(0,o.slot)(),editDriverLicense:(0,o.slot)(),editFiscalId:(0,o.slot)(),updatePasskey:(0,o.slot)(),updateSecureNote:(0,o.slot)(),editPassport:(0,o.slot)(),getPersonalDataExport:(0,o.slot)(),saveGeneratedPassword:(0,o.slot)(),toggleDashlane:(0,o.slot)(),updateAutofillSettings:(0,o.slot)(),updateBankAccount:(0,o.slot)(),updateBreachStatus:(0,o.slot)(),updateCredential:(0,o.slot)(),editIdCard:(0,o.slot)(),updatePaymentCard:(0,o.slot)(),editSocialSecurityId:(0,o.slot)(),updateProtectPasswordsSetting:(0,o.slot)(),addCollection:(0,o.slot)(),deleteCollection:(0,o.slot)(),removeItemsFromCollections:(0,o.slot)(),updateCollection:(0,o.slot)(),setupDefaultNoteCategories:(0,o.slot)(),importPersonalData:(0,o.slot)(),previewPersonalData:(0,o.slot)(),dismissPersonalDataImportNotifications:(0,o.slot)(),deleteSecureFile:(0,o.slot)(),downloadSecureFile:(0,o.slot)(),chunkTransferDone:(0,o.slot)(),addSecureFile:(0,o.slot)(),validateSecureFile:(0,o.slot)(),commitSecureFile:(0,o.slot)(),initSecureFilesStorageInfo:(0,o.slot)(),clearSecureFilesState:(0,o.slot)(),disableVaultItemProtection:(0,o.slot)(),updateLinkedWebsites:(0,o.slot)()}},77121:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deviceQueries=void 0;const o=r(71796);t.deviceQueries={getAnonymousComputerId:(0,o.slot)()}},49768:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.eventLoggerCommands=void 0;const o=r(71796);t.eventLoggerCommands={logPageView:(0,o.slot)(),logEvent:(0,o.slot)(),flushQueue:(0,o.slot)()}},30808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exceptionCommands=void 0;const o=r(71796);t.exceptionCommands={logException:(0,o.slot)()}},73270:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.familyCommands=void 0;const o=r(71796);t.familyCommands={getFamilyDetails:(0,o.slot)(),joinFamily:(0,o.slot)(),leaveFamily:(0,o.slot)(),removeFamilyMember:(0,o.slot)(),resetFamilyJoinToken:(0,o.slot)()}},78333:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.featureQueries=void 0;const o=r(71796);t.featureQueries={getHasFeature:(0,o.slot)(),getFeatures:(0,o.slot)()}},79870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.remoteFilesLiveQueries=t.remoteFilesQueries=t.remoteFileCommands=void 0;const o=r(15911),a=r(71796);t.remoteFileCommands={decipherRemoteFile:(0,a.slot)()},t.remoteFilesQueries={getFileContent:(0,a.slot)()},t.remoteFilesLiveQueries={liveFileMeta:(0,o.liveSlot)()}},74649:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsCommands=void 0;const o=r(71796);t.globalExtensionSettingsCommands={setGlobalExtensionSettings:(0,o.slot)(),getGlobalExtensionSettings:(0,o.slot)()}},70693:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.healthCommands=void 0;const o=r(71796);t.healthCommands={evaluatePassword:(0,o.slot)()}},3656:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchLiveQueries=t.killswitchQueries=void 0;const o=r(71796),a=r(15911);t.killswitchQueries={getIsBrazeContentDisabled:(0,o.slot)(),getIsLoginFlowMigrationDisabled:(0,o.slot)(),getIsAutoSSOLoginDisabled:(0,o.slot)()},t.killswitchLiveQueries={liveIsBrazeContentDisabled:(0,a.liveSlot)(),liveIsLoginFlowMigrationDisabled:(0,a.liveSlot)(),liveIsAutoSSOLoginDisabled:(0,a.liveSlot)()}},52379:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginCommands=void 0;const o=r(71796);t.loginCommands={abortDeviceLimitFlow:(0,o.slot)(),loginViaSSO:(0,o.slot)(),unlinkPreviousDevice:(0,o.slot)(),unlinkMultipleDevices:(0,o.slot)()}},52410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginStepInfoLiveQueries=t.loginStepInfoQueries=t.loginStepInfoCommands=void 0;const o=r(71796);t.loginStepInfoCommands={updateLoginStepInfo:(0,o.slot)(),resetLoginStepInfo:(0,o.slot)()},t.loginStepInfoQueries={getLoginStepInfo:(0,o.slot)()},t.loginStepInfoLiveQueries={liveLoginStepInfo:(0,o.slot)()}},18460:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsLiveQueries=t.notificationsQueries=t.notificationsCommands=void 0;const o=r(71796),a=r(15911);t.notificationsCommands={markNotificationAsInteracted:(0,o.slot)(),markNotificationAsSeen:(0,o.slot)(),markNotificationAsUnseen:(0,o.slot)()},t.notificationsQueries={getNotificationStatus:(0,o.slot)()},t.notificationsLiveQueries={liveNotificationStatus:(0,a.liveSlot)()}},50290:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordGeneratorQueries=t.passwordGeneratorCommands=void 0;const o=r(71796);t.passwordGeneratorCommands={generatePassword:(0,o.slot)(),generateAndSavePassword:(0,o.slot)(),savePasswordGenerationSettings:(0,o.slot)()},t.passwordGeneratorQueries={getPasswordGenerationSettings:(0,o.slot)()}},64149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paymentsQueries=t.paymentsCommands=void 0;const o=r(71796);t.paymentsCommands={cancelAutoRenew:(0,o.slot)(),downloadCustomerInvoice:(0,o.slot)(),fetchInvoiceList:(0,o.slot)(),requestRefund:(0,o.slot)()},t.paymentsQueries={getInvoicesCount:(0,o.slot)(),getInvoiceList:(0,o.slot)(),getInvoiceListYears:(0,o.slot)()}},65331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectedItemsUnlockerLiveQueries=t.protectedItemsUnlockerQueries=t.protectedItemsUnlockerCommands=void 0;const o=r(71796),a=r(15911);t.protectedItemsUnlockerCommands={disableCredentialProtection:(0,o.slot)(),unlockProtectedItems:(0,o.slot)()},t.protectedItemsUnlockerQueries={areProtectedItemsUnlocked:(0,o.slot)()},t.protectedItemsUnlockerLiveQueries={liveAreProtectedItemsUnlocked:(0,a.liveSlot)()}},94341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountRecoveryRequestLiveQueries=t.recoveryQueries=t.recoveryCommands=void 0;const o=r(71796),a=r(15911);t.recoveryCommands={activateAccountRecovery:(0,o.slot)(),setupMasterPasswordForRecovery:(0,o.slot)(),deactivateAccountRecovery:(0,o.slot)(),registerDeviceForRecovery:(0,o.slot)(),startAccountRecovery:(0,o.slot)(),sendRecoveryRequest:(0,o.slot)(),cancelRecoveryRequest:(0,o.slot)(),checkRecoveryRequestStatus:(0,o.slot)(),recoverUserData:(0,o.slot)(),checkDoesLocalRecoveryKeyExist:(0,o.slot)(),isRecoveryRequestPending:(0,o.slot)()},t.recoveryQueries={getRecoveryOptInSetting:(0,o.slot)(),getShouldShowFeatureActivationModal:(0,o.slot)(),getAccountRecoveryRequestCount:(0,o.slot)()},t.accountRecoveryRequestLiveQueries={liveAccountRecoveryRequestCount:(0,a.liveSlot)()}},4453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.remoteFilesLiveQueries=void 0;const o=r(15911);t.remoteFilesLiveQueries={liveFileMeta:(0,o.liveSlot)()}},39080:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sessionLiveQueries=t.sessionQueries=t.sessionCommands=void 0;const o=r(71796),a=r(15911);t.sessionCommands={validateToken:(0,o.slot)(),validateMasterPassword:(0,o.slot)(),resetProtectedItemAutofillTimer:(0,o.slot)(),forceSync:(0,o.slot)(),updatePremiumChurningDismissDate:(0,o.slot)(),setCredentialSearchOrder:(0,o.slot)(),refreshSubscriptionInformation:(0,o.slot)(),updateAccountRecoveryKeyPersonalSettings:(0,o.slot)()},t.sessionQueries={getActiveSpaces:(0,o.slot)(),getDidOpen:(0,o.slot)(),getSyncInfo:(0,o.slot)(),getIsSyncInProgress:(0,o.slot)(),getPremiumStatus:(0,o.slot)(),getNodePremiumStatus:(0,o.slot)(),getSubscriptionInformation:(0,o.slot)(),getIsAuthenticated:(0,o.slot)(),getSSOProviderInfo:(0,o.slot)(),getUserLogin:(0,o.slot)(),getPublicUserId:(0,o.slot)(),getAnalyticsInstallationId:(0,o.slot)(),getUserLoginStatus:(0,o.slot)(),getWebOnboardingMode:(0,o.slot)(),getPremiumChurningDismissDate:(0,o.slot)(),getIsPaymentFailureChurningDismissed:(0,o.slot)(),getCredentialSearchOrder:(0,o.slot)(),getPlatformName:(0,o.slot)(),getAccountAuthenticationType:(0,o.slot)()},t.sessionLiveQueries={liveSyncInfo:(0,a.liveSlot)(),liveIsSyncInProgress:(0,a.liveSlot)(),livePremiumStatus:(0,a.liveSlot)(),liveServiceProviderUrl:(0,a.liveSlot)(),liveWebOnboardingMode:(0,a.liveSlot)(),liveSubscriptionInformation:(0,a.liveSlot)()}},16622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingLiveQueries=t.sharingQueries=t.sharingCommands=void 0;const o=r(71796),a=r(15911);t.sharingCommands={convertItemToDashlaneXml:(0,o.slot)(),shareItem:(0,o.slot)()},t.sharingQueries={getAllSharedItemIds:(0,o.slot)(),getGroupRecipients:(0,o.slot)(),getHasNotifications:(0,o.slot)(),getIsShared:(0,o.slot)(),getItemItemGroup:(0,o.slot)(),getMyAcceptedItemGroupUserMembers:(0,o.slot)(),getMyAcceptedUserGroups:(0,o.slot)(),getPendingItemGroups:(0,o.slot)(),getPendingUserGroups:(0,o.slot)(),getRecipientsCount:(0,o.slot)(),getSharingCapacity:(0,o.slot)(),getUserRecipients:(0,o.slot)(),isAllowedToShare:(0,o.slot)(),getUserGroups:(0,o.slot)(),getUserGroup:(0,o.slot)(),getSharingUsers:(0,o.slot)(),getUserGroupPermissionLevel:(0,o.slot)(),getSharingUserPermissionLevel:(0,o.slot)(),getUserGroupMembers:(0,o.slot)()},t.sharingLiveQueries={liveAllSharedItemIds:(0,a.liveSlot)(),liveGroupRecipients:(0,a.liveSlot)(),liveHasNotifications:(0,a.liveSlot)(),liveIsShared:(0,a.liveSlot)(),liveMyAcceptedItemGroupUserMembers:(0,a.liveSlot)(),liveMyAcceptedUserGroups:(0,a.liveSlot)(),livePendingItemGroups:(0,a.liveSlot)(),livePendingUserGroups:(0,a.liveSlot)(),liveRecipientsCount:(0,a.liveSlot)(),liveSharingCapacity:(0,a.liveSlot)(),liveUserRecipients:(0,a.liveSlot)(),liveUserGroups:(0,a.liveSlot)(),liveSharingUsers:(0,a.liveSlot)(),liveUserGroupPermissionLevel:(0,a.liveSlot)(),liveSharingUserPermissionLevel:(0,a.liveSlot)()}},87693:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.staticDataQueries=void 0;const o=r(71796);t.staticDataQueries={getAllBanks:(0,o.slot)(),getAllCallingCodes:(0,o.slot)(),getBanks:(0,o.slot)(),getSecureDocumentsExtensionsList:(0,o.slot)()}},36197:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionCodeLiveQueries=t.subscriptionCodeQueries=void 0;const o=r(71796),a=r(15911);t.subscriptionCodeQueries={getSubscriptionCode:(0,o.slot)()},t.subscriptionCodeLiveQueries={liveSubscriptionCode:(0,a.liveSlot)()}},9406:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamAdminLiveQueries=t.teamAdminQueries=t.teamAdminCommands=void 0;const o=r(71796),a=r(15911);t.teamAdminCommands={completeTeamDomainRegistration:(0,o.slot)(),deactivateTeamDomain:(0,o.slot)(),getTeamDomains:(0,o.slot)(),getTeamDevice:(0,o.slot)(),listTeamDevices:(0,o.slot)(),deactivateTeamDevice:(0,o.slot)(),registerTeamDomain:(0,o.slot)(),registerTeamDevice:(0,o.slot)(),registerTeamDeviceAccount:(0,o.slot)(),getEncryptionServiceConfig:(0,o.slot)(),generateAndSaveEncryptionServiceConfig:(0,o.slot)(),clearSelfHostedESSettings:(0,o.slot)(),getTeamDeviceEncryptedConfig:(0,o.slot)(),updateTeamDeviceEncryptedConfig:(0,o.slot)(),updateTeamSettings:(0,o.slot)(),parseMetadataFields:(0,o.slot)(),persistAdminProvisioningKey:(0,o.slot)(),removeAdminProvisioningKey:(0,o.slot)(),createSSOConnectorConfig:(0,o.slot)(),generateSSOConnectorKey:(0,o.slot)(),startAuditLogsQuery:(0,o.slot)(),getAuditLogQueryResults:(0,o.slot)(),getRecoveryCodesAsTeamCaptain:(0,o.slot)(),createInviteLink:(0,o.slot)(),changeInviteLinkTeamKey:(0,o.slot)(),toggleInviteLink:(0,o.slot)(),getInviteLink:(0,o.slot)(),requestInviteLinkToken:(0,o.slot)(),getInviteLinkForAdmin:(0,o.slot)(),getLastADSyncDate:(0,o.slot)(),getSpecialUserGroupInviteValuesForMemberInTeam:(0,o.slot)(),getSpecialUserGroupRevision:(0,o.slot)()},t.teamAdminQueries={getAdministrableUserGroup:(0,o.slot)(),getAdministrableUserGroups:(0,o.slot)(),isGroupNameAvailable:(0,o.slot)(),getAdminProvisioningKey:(0,o.slot)()},t.teamAdminLiveQueries={liveAdministrableUserGroup:(0,a.liveSlot)(),liveAdministrableUserGroups:(0,a.liveSlot)(),liveAdminProvisioningKey:(0,a.liveSlot)()}},62756:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamQueries=t.teamCommands=void 0;const o=r(71796);t.teamCommands={changeTierMidCycle:(0,o.slot)(),getTeamInfo:(0,o.slot)(),getTeamOffers:(0,o.slot)(),getMidCycleTierUpgradePrice:(0,o.slot)(),getExpectedTaxInformation:(0,o.slot)(),computePlanPricing:(0,o.slot)(),addSeats:(0,o.slot)()},t.teamQueries={getIsRecoveryEnabled:(0,o.slot)()}},19302:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userMessagesLiveQueries=t.userMessagesQueries=t.userMessagesCommands=void 0;const o=r(71796),a=r(15911);t.userMessagesCommands={dismissUserMessages:(0,o.slot)(),addUserMessage:(0,o.slot)()},t.userMessagesQueries={getVisibleUserMessages:(0,o.slot)(),getUserMessages:(0,o.slot)()},t.userMessagesLiveQueries={liveVisibleUserMessages:(0,a.liveSlot)(),liveUserMessages:(0,a.liveSlot)()}},17055:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnLives=t.vpnQueries=t.vpnCommands=void 0;const o=r(15911),a=r(71796);t.vpnCommands={activateVpnAccount:(0,a.slot)(),clearVpnAccountErrors:(0,a.slot)(),completeVpnAccountActivation:(0,a.slot)()},t.vpnQueries={getVpnAccount:(0,a.slot)(),getVpnCapabilitySetting:(0,a.slot)()},t.vpnLives={liveVpnAccount:(0,o.liveSlot)()}},66508:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.apiEvents=void 0;const o=r(71796),a=r(49710),i=r(24184),n=r(53397);t.apiEvents=(0,o.combineEvents)(a.commandsEvents,i.queriesEvents,n.liveEvents)},49710:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commandsEvents=void 0;const o=r(71796),a=r(53576),i=r(58977),n=r(65770),s=r(35090),c=r(63736),l=r(10330),d=r(90),u=r(73270),p=r(74649),S=r(70693),g=r(52379),m=r(18460),y=r(65331),h=r(94341),v=r(36551),f=r(39080),A=r(9406),P=r(62756),b=r(36060),w=r(50290),T=r(49768),_=r(30808),I=r(17055),E=r(64149),C=r(19302),D=r(52410),O=r(16622),M=r(79870);t.commandsEvents=(0,o.combineEvents)(a.carbonCommandsSlots,i.abTestsCommands,n.authenticationCommands,s.autofillDataCommands,c.contactInfoCommands,l.changeMasterPasswordCommands,d.cryptoMigrationCommands,b.dataManagementCommands,u.familyCommands,p.globalExtensionSettingsCommands,S.healthCommands,g.loginCommands,D.loginStepInfoCommands,m.notificationsCommands,y.protectedItemsUnlockerCommands,h.recoveryCommands,v.darkWebInsightsCommands,A.teamAdminCommands,P.teamCommands,f.sessionCommands,w.passwordGeneratorCommands,T.eventLoggerCommands,_.exceptionCommands,C.userMessagesCommands,I.vpnCommands,E.paymentsCommands,O.sharingCommands,M.remoteFileCommands)},53397:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.liveEvents=void 0;const o=r(53576),a=r(58977),i=r(20266),n=r(94341),s=r(32437),c=r(65770),l=r(10330),d=r(63736),u=r(90),p=r(36060),S=r(3656),g=r(18460),m=r(65331),y=r(39080),h=r(16622),v=r(36197),f=r(9406),A=r(19302),P=r(52410),b=r(71796),w=r(17055),T=r(4453);t.liveEvents=(0,b.combineEvents)(o.carbonLiveQueriesSlots,a.abTestsLiveQueries,i.accountCreationLiveQueries,n.accountRecoveryRequestLiveQueries,s.antiPhishingLiveQueries,c.authenticationLiveQueries,d.contactInfoLiveQueries,u.cryptoMigrationLiveQueries,l.changeMasterPasswordLiveQueries,p.dataManagementLiveQueries,S.killswitchLiveQueries,P.loginStepInfoLiveQueries,g.notificationsLiveQueries,m.protectedItemsUnlockerLiveQueries,y.sessionLiveQueries,h.sharingLiveQueries,v.subscriptionCodeLiveQueries,f.teamAdminLiveQueries,A.userMessagesLiveQueries,w.vpnLives,T.remoteFilesLiveQueries)},24184:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queriesEvents=void 0;const o=r(71796),a=r(53576),i=r(58977),n=r(65770),s=r(35090),c=r(63736),l=r(36197),d=r(10330),u=r(90),p=r(36060),S=r(77121),g=r(78333),m=r(3656),y=r(52410),h=r(18460),v=r(64149),f=r(65331),A=r(94341),P=r(39080),b=r(16622),w=r(87693),T=r(62756),_=r(9406),I=r(50290),E=r(19302),C=r(17055),D=r(79870);t.queriesEvents=(0,o.combineEvents)(a.carbonQueriesSlots,i.abTestsQueries,n.authenticationQueries,s.autofillDataQueries,c.contactInfoQueries,S.deviceQueries,d.changeMasterPasswordQueries,u.cryptoMigrationQueries,p.dataManagementQueries,g.featureQueries,m.killswitchQueries,y.loginStepInfoQueries,h.notificationsQueries,I.passwordGeneratorQueries,v.paymentsQueries,f.protectedItemsUnlockerQueries,A.recoveryQueries,P.sessionQueries,b.sharingQueries,w.staticDataQueries,l.subscriptionCodeQueries,T.teamQueries,_.teamAdminQueries,E.userMessagesQueries,C.vpnQueries,D.remoteFilesQueries)},20849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDebugEvents=void 0;const o=r(95623),a=e=>(t,r)=>{const{message:o,details:a={}}=r;t[e]({date:(new Date).toJSON(),message:o,optionalParams:Object.keys(a).reduce(((e,t)=>[...e,a[t]]),[])})},i=e=>{switch(e){case o.LogLevel.Error:return a("error");case o.LogLevel.Warn:return a("warning");case o.LogLevel.Info:return a("info");case o.LogLevel.Debug:case o.LogLevel.Verbose:default:return a("log")}};t.subscribeToDebugEvents=function(e){(0,o.redirectConsoleLogs)((t=>{const{level:r=o.LogLevel.Debug}=t;i(r)(e,t)}))}},44273:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDiagnosticEvents=void 0;let r=null;t.subscribeToDiagnosticEvents=function(e){r=e,e.decipheringDiagnosticLogEvent.on((e=>e))},t.default=function(){return r}},39947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonE2EConnector=void 0;const o=r(71796);t.carbonE2EConnector={registerFreeTrial:(0,o.slot)(),getTeamTokens:(0,o.slot)(),confirmFreeTrial:(0,o.slot)(),getPremiumStatus:(0,o.slot)(),proposeMembers:(0,o.slot)(),acceptTeamInvite:(0,o.slot)(),getTokenForTestUser:(0,o.slot)(),getServiceProviderToken:(0,o.slot)(),createOrUpdateDarkWebBreach:(0,o.slot)(),addPrivateBreach:(0,o.slot)(),createPublicBreach:(0,o.slot)(),forceBreachRefresh:(0,o.slot)(),getUserCryptoPayload:(0,o.slot)()}},58427:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=void 0;const o=r(3674),a=r(17338),i=r(37864),n=r(71602),s=r(32006),c=r(79734);t.subscribeToE2EEvents=function(e,t){const r=(0,a.getCoreServices)(t),l=(0,o.makeTeamAdminController)(r.storeService,r.wsService);e.registerFreeTrial.on(l.registerFreeTrial),e.getTeamTokens.on(l.getTeamTokens),e.confirmFreeTrial.on(l.confirmFreeTrial),e.getPremiumStatus.on(l.getPremiumStatus),e.proposeMembers.on(l.proposeMembers),e.acceptTeamInvite.on(l.acceptTeamInvite),e.getTokenForTestUser.on((e=>(0,i.getTokenForKwUser)(r,e))),e.getServiceProviderToken.on((e=>(0,n.getServiceProviderToken)(r,e))),e.createOrUpdateDarkWebBreach.on((e=>(0,c.createOrUpdateDarkWebBreachHelper)(r,e))),e.addPrivateBreach.on((e=>(0,c.addPrivateBreachHelper)(r,e))),e.createPublicBreach.on((e=>(0,c.createPublicBreachHelper)(r,e))),e.forceBreachRefresh.on((()=>{(0,s.forceBreachRefreshHandler)(r)})),e.getUserCryptoPayload.on((()=>r.storeService.getPersonalSettings().CryptoUserPayload))}},30855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=t.carbonE2EConnector=void 0;var o=r(39947);Object.defineProperty(t,"carbonE2EConnector",{enumerable:!0,get:function(){return o.carbonE2EConnector}});var a=r(58427);Object.defineProperty(t,"subscribeToE2EEvents",{enumerable:!0,get:function(){return a.subscribeToE2EEvents}})},19697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},39421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},44242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToMaverickEvents=void 0;const o=r(19065),a=r(17338),i=r(38865),n=r(39421);t.subscribeToMaverickEvents=function(e,t){(0,n.setEventBus)(e);const r=(0,a.getCoreServices)(t),s=(0,o.makeDataManagementController)(r);e.savePersonalDataItem.on((e=>{s.savePersonalDataItem(e)})),e.filledDataItem.on((e=>s.updateMetadataItemFilledOnPage(e.id,e.url,e.dataType))),e.updateWebOnboardingMode.on((e=>(0,i.updateWebOnboardingMode)(r.storeService,r.sessionService,e)))}},21726:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},4798:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToExtensionEvents=void 0;const o=r(2246),a=r(90622),i=r(70252),n=r(38865),s=r(25576),c=r(17338),l=r(5464),d=r(88610),u=r(21726);t.subscribeToExtensionEvents=function(e,t){(0,u.setEventBus)(e);const r=(0,c.getCoreServices)(t),{storeService:p,storageService:S}=r,g=(0,d.makeLoginController)(r),m=(0,l.makeSessionController)(r);e.getAccountInfo.on((()=>m.getAndTriggerRefreshAccountInfo())),e.getDevicesList.on((()=>m.getDevicesList().then((e=>({devicesList:e}))))),e.getLocalAccountsList.on((()=>(0,a.getLocalAccounts)(p,S).then((e=>({localAccounts:e}))))),e.getAnonymousLogsMetadata.on((()=>({anonymouscomputerid:(0,o.getCommonAppSetting)("anonymousComputerId")}))),e.askWebsiteInfo.on((({fullUrl:e})=>m.askWebsiteInfo(e))),e.deactivateDevice.on((e=>{m.deactivateDevice(e.deviceId)})),e.changeDeviceName.on((e=>{m.changeDeviceName(e.deviceId,e.updatedName)})),e.checkIfMasterPasswordIsValid.on((e=>m.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.closeSession.on((()=>m.closeSession())),e.lockSession.on((()=>m.lockSession())),e.openSession.on((({login:e,password:t})=>g.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:o,deviceName:a})=>{g.openSessionWithToken(e,t,r,o?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,a)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:o})=>{g.openSessionWithDashlaneAuthenticator(e,t,r?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,o)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{g.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{g.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{g.openSessionWithOTP(e.login,e.password,e.otp)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:o,deviceName:a})=>{g.openSessionWithOTPForNewDevice(e,t,r,o?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,a)})),e.openSessionWithMasterPassword.on((e=>{g.openSessionWithMasterPassword(e.login,e.password,{rememberMasterPassword:e.rememberPassword,serverKey:e.serverKey})})),e.openExtraDeviceSession.on((e=>{g.openExtraDeviceSession(e.login,{password:e.password,serverKey:e.serverKey})})),e.openSessionWithExtraDeviceToken.on((e=>g.openSessionWithExtraDeviceToken(e.login,e.extraDeviceToken,e.persistData?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,{password:e.password,deviceName:e.deviceName}))),e.sessionForceSync.on((e=>{m.sessionForceSync(e.trigger)})),e.updateWebOnboardingMode.on((e=>{n.updateWebOnboardingMode(r.storeService,r.sessionService,e)})),e.openDevSession.on((()=>{})),e.exceptionLog.on((e=>(0,i.sendTypedExceptionLog)("extensionException",e)))}},75391:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToLeelooEvents=void 0;const o=r(71703),a=r(70252),i=r(25576),n=r(90622),s=r(17338),c=r(5464),l=r(38865),d=r(88610),u=r(15444),p=r(3674),S=r(63623),g=r(58415),m=r(97124),y=r(33332),h=r(58639),v=r(89675),f=r(19065),A=r(19697);t.subscribeToLeelooEvents=function(e,t){(0,A.setEventBus)(e);const r=(0,s.getCoreServices)(t),{applicationModulesAccess:P,storeService:b,localStorageService:w,wsService:T,sessionService:_,storageService:I}=r,E=(0,o.makeAccountCreationController)(r),C=(0,c.makeSessionController)(r),D=(0,d.makeLoginController)(r),O=(0,f.makeDataManagementController)(r),M=(0,u.makeRecoveryController)(b,T),N=(0,v.makeSettingsController)(b,T),F=(0,p.makeTeamAdminController)(b,T),U=(0,m.makeSharingService)(b,T),L=(0,g.makeDirectorySyncController)({storeService:b,localStorageService:w,wsService:T,sessionService:_,sharingService:U}),R=(0,y.makeStaticDataController)();e.getUki.on((()=>C.getUki())),e.savePaymentCard.on((e=>{O.savePaymentCardFromClient(e)})),e.savePersonalDataItem.on((e=>O.savePersonalDataItem(e))),e.removePersonalDataItem.on((e=>O.removePersonalDataItem(e.id))),e.getAccountInfo.on((()=>C.getAndTriggerRefreshAccountInfo())),e.getDevicesList.on((()=>C.getDevicesList().then((e=>({devicesList:e}))))),e.getLocalAccountsList.on((()=>(0,n.getLocalAccounts)(b,I).then((e=>({localAccounts:e}))))),e.getTemporaryToken.on((()=>C.getTemporaryToken().then((e=>({temporaryToken:e}))))),e.deactivateDevice.on((e=>{C.deactivateDevice(e.deviceId)})),e.changeDeviceName.on((e=>{C.changeDeviceName(e.deviceId,e.updatedName)})),e.cancelPremiumSubscription.on((()=>C.cancelPremiumSubscription())),e.getInvoices.on((()=>C.getInvoices().then((e=>({invoices:e}))))),e.closeSession.on((()=>C.closeSession())),e.lockSession.on((()=>C.lockSession())),e.resumeSession.on((()=>C.resumeSession())),e.getPersonalSettings.on((()=>C.getPersonalSettings().then((e=>e)))),e.openSession.on((({login:e,password:t})=>D.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:o,deviceName:a})=>{D.openSessionWithToken(e,t,r,o?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,a)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:o})=>{D.openSessionWithDashlaneAuthenticator(e,t,r?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,o)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{D.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{D.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{D.openSessionWithOTP(e.login,e.password,e.otp,void 0,e.withBackupCode)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:o,deviceName:a,withBackupCode:n})=>{D.openSessionWithOTPForNewDevice(e,t,r,o?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,a,n)})),e.openSessionWithMasterPassword.on((e=>D.openSessionWithMasterPassword(e.login,e.password,{rememberMasterPassword:e.rememberPassword,requiredPermissions:e.requiredPermissions,serverKey:e.serverKey}))),e.openExtraDeviceSession.on((e=>{D.openExtraDeviceSession(e.login,{password:e.password,serverKey:e.serverKey})})),e.openSessionWithExtraDeviceToken.on((e=>D.openSessionWithExtraDeviceToken(e.login,e.extraDeviceToken,e.persistData?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,{password:e.password,deviceName:e.deviceName}))),e.sessionForceSync.on((e=>C.sessionForceSync(e.trigger))),e.exceptionLog.on((e=>(0,a.sendTypedExceptionLog)("leelooException",e))),e.teamUpdated.on((e=>F.teamUpdateHandler(e).then((e=>({errors:e}))))),e.createUserGroup.on((e=>F.createUserGroupAction(_,e))),e.deleteUserGroup.on((e=>F.deleteUserGroupAction(e))),e.renameUserGroup.on((e=>F.renameUserGroupAction(e))),e.inviteUserGroupMembers.on((e=>F.inviteUserGroupMembersAction(e))),e.revokeUserGroupMembers.on((e=>F.revokeUserGroupMembersAction(e))),e.updateUserGroupMembers.on((e=>F.updateUserGroupMembersAction(e))),e.createAccountStep1.on((e=>E.createAccount(e))),e.createAccountStep2.on((e=>E.confirmAccountCreation(e))),e.checkLogin.on((e=>E.checkLogin(e))),e.getMasterPasswordResetDemandList.on((e=>M.getMasterPasswordResetDemandList(e))),e.acceptMasterPasswordResetDemand.on((e=>M.acceptMasterPasswordResetDemand(e))),e.checkIfMasterPasswordIsValid.on((e=>C.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.declineMasterPasswordResetDemand.on((e=>M.declineMasterPasswordResetDemand(e))),e.getMembers.on((e=>F.getMembers(e))),e.addTeamAdmin.on((e=>F.addTeamAdmin(e))),e.removeTeamAdmin.on((e=>F.removeTeamAdmin(e))),e.setTeamSettings.on((e=>N.setTeamSettings(e))),e.updateWebOnboardingMode.on((e=>l.updateWebOnboardingMode(b,_,e))),e.checkDirectorySyncKeyResponse.on((e=>{const{teamId:t,publicKey:r,requestId:o,response:a}=e;"validated"===a?L.keyValidatedByTacAdmin(t,r):"rejected"===a&&L.keyRejectedByTacAdmin(t,o)})),e.queryStaticDataCollections.on((e=>R.query(e))),e.sendSharingResponse.on((e=>(0,S.handleSharingResponse)(P,b,_,e))),e.getDataModel.on((()=>(0,h.getDataUpdates)(b).obfuscatedPersonalDataToSend)),e.getSharingSync.on((()=>b.getState().userSession.sharingSync)),e.getSharingData.on((()=>b.getSharingData())),e.revokeSharing.on((({itemGroupId:e,recipient:t})=>(0,S.handleRevokeSharing)(P,b,_,T,e,t))),e.updateSharingPermission.on((({itemGroupId:e,recipient:t,permission:r})=>(0,S.handleUpdateSharingPermission)(b,_,T,e,t,r))),e.setPendingElementsAsSeen.on((e=>(0,S.setPendingElementsAsSeen)(b,w,e))),e.isUserLastAdminOnItem.on((e=>(0,S.isUserLastAdminOnItem)(b,e))),e.doesUserReceiveItemViaGroup.on((e=>(0,S.doesUserReceiveItemViaGroup)(b,e)))}},58513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(75653),a=r(57193);t.config={commands:{changeUserCrypto:{handler:a.changeUserCrypto}},queries:{getCanUserChangeCrypto:{selector:o.canUserSelectCryptoSelector},getUserDerivationMethod:{selector:o.userDerivationMethodSelector}},liveQueries:{liveUserDerivationMethod:{operator:o.userDerivationMethodSelector$}}}},39319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedDerivationMethods=void 0;var o=r(64816);Object.defineProperty(t,"SupportedDerivationMethods",{enumerable:!0,get:function(){return o.SupportedDerivationMethods}})},21344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(58513);t.bootstrap=e=>{e.register(o.config)}},21583:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(21344);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},75653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userDerivationMethodSelector$=t.userDerivationMethodSelector=t.canUserSelectCryptoSelector=t.teamCryptoForcedPayloadSelector=t.hasCryptoMigrationPhase2EnabledSelector=t.hasCryptoMigrationPhase1EnabledSelector=void 0;const o=r(18948),a=r(3343),i=r(7944),n=r(88205),s=r(65675),c=r(16593),l=r(64816);t.hasCryptoMigrationPhase1EnabledSelector=async e=>(await(0,n.makeFeatureFlipsSelectors)(e.applicationModulesAccess).featureFlipsSelector()).itadmin_SAEX_CryptoMigration_Phase1;t.hasCryptoMigrationPhase2EnabledSelector=async e=>(await(0,n.makeFeatureFlipsSelectors)(e.applicationModulesAccess).featureFlipsSelector()).itadmin_SAEX_CryptoMigration_Phase2;t.teamCryptoForcedPayloadSelector=e=>{const t=(0,i.activeSpacesSelector)(e)[0];return t?.details.info.cryptoForcedPayload??""};t.canUserSelectCryptoSelector=e=>!(0,t.teamCryptoForcedPayloadSelector)(e);t.userDerivationMethodSelector=e=>{switch((0,c.userDefaultCryptoSelector)(e)){case s.ARGON2_DEFAULT_PAYLOAD:return l.SupportedDerivationMethods.ARGON2D;case s.PBKDF2_DEFAULT_PAYLOAD:return l.SupportedDerivationMethods.PBKDF2;case s.KWC3_DEFAULT_PAYLOAD:return l.SupportedDerivationMethods.KWC3;default:return null}};t.userDerivationMethodSelector$=()=>(0,o.pipe)((0,a.map)(t.userDerivationMethodSelector),(0,a.distinctUntilChanged)())},57193:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeUserCrypto=void 0;const o=r(92233),a=r(55696),i=r(48238);t.changeUserCrypto=async function(e,{newDerivationMethod:t}){const{storeService:r}=e,n=r.getPersonalSettings().CryptoUserPayload,s=(0,i.getNewCryptoPayload)(t);if(!s)throw new Error(`[changeUserCrypto] - client sent wrong derivation value (${t})`);return await(0,a.migrateUserCrypto)(e,n,s,o.CryptoMigrationType.SettingsChange)}},77965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllTransactions=void 0;const o=r(16859),a=r(83638);t.decryptAllTransactions=async function(e,t,r){const{announce:i}=r.getInstance().user.getSyncArgs(),n=e.map((async e=>({...e,content:await(0,o.decryptTransactionContent)(t.getInstance(),i,e).catch((t=>{if(e.type!==a.TransactionType.SETTINGS)return"";throw t}))})));return(await Promise.all(n)).filter((e=>!!e.content))}},9027:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllUserData=void 0;const o=r(33740),a=r(77965);t.decryptAllUserData=async function(e,t,r,{transactions:i,sharingKeys:n}){try{const s=await(0,a.decryptAllTransactions)(i,r,e);return{clearTransactions:s,clearPrivateKey:await(0,o.decipherPrivateKey)(t,r,n)}}catch(e){throw new Error(`decipherAllUserData failed with error: ${e}`)}}},73909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDataToMigrate=void 0;const o=r(92233),a=r(46298),i=r(16593);t.getDataToMigrate=async function(e,t){try{const t=e.getState(),r=(0,i.userLoginSelector)(t),o=await(0,a.getDataForMasterPasswordChange)(e,r,{});if((0,a.isApiError)(o))throw new Error(`getDataDoMigrate failed with error: ${o}`);return{transactions:o.data.transactions,sharingKeys:o.data.sharingKeys,timestamp:o.timestamp}}catch(e){throw t(o.CryptoMigrationStatus.ErrorDownload),new Error(`getDataDoMigrate failed with error: ${e}`)}}},48238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewCryptoPayload=void 0;const o=r(65675),a=r(38250);t.getNewCryptoPayload=function(e){switch(e){case a.SupportedDerivationMethods.ARGON2D:return o.ARGON2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.PBKDF2:return o.PBKDF2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.KWC3:return o.KWC3_DEFAULT_PAYLOAD;default:return}}},18767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reEncryptAllUserData=void 0;const o=r(92233),a=r(33740),i=r(16859);t.reEncryptAllUserData=async function(e,{clearTransactions:t,clearPrivateKey:r},n){try{const o=t.map((t=>(0,i.encryptSingleTransaction)(e,t))),n=await Promise.all(o);return{encryptedTransactions:n,encryptedPrivateKey:await(0,a.cipherPrivateKey)(e,r)}}catch(e){throw n(o.CryptoMigrationStatus.ErrorReencryption),new Error(`reEncryptAllUserData failed with error: ${e}`)}}},46076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMasterPasswordEncryptorService=void 0;const o=r(65675),a=r(16593);t.resetMasterPasswordEncryptorService=function(e,t){const{storeService:r,masterPasswordEncryptorService:i}=e,n=r.getState(),s=(0,a.masterPasswordSelector)(n),c=(0,a.serverKeySelector)(n),l=t===o.KWC3_DEFAULT_PAYLOAD?(0,o.getLegacyCryptoConfig)(t):(0,o.parsePayload)(t).cryptoConfig;i.setInstance({raw:s},c,l)}},36116:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAndPersistLocalData=void 0;const o=r(92233),a=r(16038),i=r(55623),n=r(27517);t.updateAndPersistLocalData=async function(e,t,r,s,c){try{e.dispatch((0,n.editPersonalSettings)({CryptoUserPayload:s,CryptoFixedSalt:(0,a.bufferToBase64)((0,i.getRandomValues)(16))})),await t.getInstance().user.persistPersonalSettings();const o=await r.getInstance().getLocalKey();await t.getInstance().user.persistLocalKey(o)}catch(e){throw c(o.CryptoMigrationStatus.ErrorUpdateLocalData),new Error(`updateAndPersistLocalData failed with error: ${e}`)}}},34726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataOnServer=void 0;const o=r(92233),a=r(33740),i=r(46298),n=r(69214),s=r(16593);t.uploadDataOnServer=async function(e,t,r){try{const r=e.getState(),o=(0,s.userLoginSelector)(r),c={...t,transactions:(0,a.formatTransaction)(t.transactions)},l=await(0,n.uploadDataForCryptoChange)(e,o,c);if((0,i.isApiError)(l))throw new Error(`uploadDataForCryptoChange failed with error: ${l}`)}catch(e){throw r(o.CryptoMigrationStatus.ErrorUpload),new Error(`uploadDataForCryptoChange failed with error: ${e}`)}}},55696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.migrateUserCrypto=void 0;const o=r(92233),a=r(65675),i=r(70252),n=r(57903),s=r(9027),c=r(73909),l=r(18767),d=r(46076),u=r(36116),p=r(34726),S=r(64816),g={[a.KWC3_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Kwc3,[a.ARGON2_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Argon2d,[a.PBKDF2_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Pbkdf2};t.migrateUserCrypto=async function(e,t,r,a){try{const{sessionService:i,storeService:m,masterPasswordEncryptorService:y,localStorageService:h,eventLoggerService:v}=e;if(!await(0,n.waitUntilSyncComplete)(m))return{success:!1,error:{code:S.ApiErrorType.ChangeUserCryptoFailed}};const f=e=>v.logEvent(new o.UserMigrateCryptoEvent({newCrypto:g[r],previousCrypto:g[t],type:a,status:e})),{transactions:A,sharingKeys:P,timestamp:b}=await(0,c.getDataToMigrate)(m,f),{clearTransactions:w,clearPrivateKey:T}=await(0,s.decryptAllUserData)(i,m,y,{transactions:A,sharingKeys:P});(0,d.resetMasterPasswordEncryptorService)(e,r);const{encryptedTransactions:_,encryptedPrivateKey:I}=await(0,l.reEncryptAllUserData)(y,{clearTransactions:w,clearPrivateKey:T},f);return await(0,p.uploadDataOnServer)(m,{timestamp:b,transactions:_,sharingKeys:{publicKey:P.publicKey,privateKey:I}},f),await(0,u.updateAndPersistLocalData)(m,i,h,r,f),await i.getInstance().user.attemptSync(o.Trigger.SettingsChange),f(o.CryptoMigrationStatus.Success),{success:!0}}catch(r){return(0,d.resetMasterPasswordEncryptorService)(e,t),(0,i.sendExceptionLog)({funcName:"migrateUserCrypto",fileName:"/carbon/src/CryptoMigration/services/migrate-user-crypto.ts",message:`Migration from KWC3 to Argon2 failed with error: ${r}`}),{success:!1,error:{code:S.ApiErrorType.ChangeUserCryptoFailed,message:r.message}}}}},63549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(55696),a=r(92233),i=r(75653),n=r(65675),s=r(16593);t.setupSubscriptions=function(e,t){e.sessionOpened.on((()=>{const{storeService:e}=t,r=e.getState(),c=(0,i.hasCryptoMigrationPhase1EnabledSelector)(t),l=(0,i.hasCryptoMigrationPhase2EnabledSelector)(t),d=(0,i.teamCryptoForcedPayloadSelector)(r),u=(0,s.userDefaultCryptoSelector)(r);!c||d||u!==n.KWC3_DEFAULT_PAYLOAD?l&&d&&d!==u&&(0,o.migrateUserCrypto)(t,u,d,a.CryptoMigrationType.TeamEnforced):(0,o.migrateUserCrypto)(t,n.KWC3_DEFAULT_PAYLOAD,n.ARGON2_DEFAULT_PAYLOAD,a.CryptoMigrationType.MigrateLegacy)}))}},64816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedDerivationMethods=t.ApiErrorType=void 0,function(e){e.ChangeUserCryptoFailed="CHANGE_USER_CRYPTO_FAILED"}(t.ApiErrorType||(t.ApiErrorType={})),function(e){e.ARGON2D="argon2d",e.PBKDF2="pbkdf2",e.KWC3="kwc3"}(t.SupportedDerivationMethods||(t.SupportedDerivationMethods={}))},44812:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(52921),a=r(31858);t.config={commands:{getDarkWebInsightsReportResults:{handler:o.getDarkWebInsightsReportResults},getDarkWebInsightsSummary:{handler:a.getDarkWebInsightsSummary}},queries:{},liveQueries:{}}},1945:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(44812);t.bootstrap=e=>{e.register(o.config)}},76592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(1945);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},52921:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsReportResults=void 0;const o=r(96805),a=r(16593),i=r(46298),n=r(82512);t.getDarkWebInsightsReportResults=async function(e,t){const{storeService:r}=e,s=r.getState(),c=(0,a.userLoginSelector)(s),l=await(0,n.getDarkWebInsightReport)(r,c,t);return(0,i.isApiError)(l)?{success:!1,error:{code:o.ApiErrorType.GetDarkWebInsightsFailed,message:`get Dark Web Insights Report failed: ${l.message}`}}:{success:!0,data:l}}},31858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummary=void 0;const o=r(96805),a=r(16593),i=r(46298),n=r(19667);t.getDarkWebInsightsSummary=async function(e){const{storeService:t}=e,r=t.getState(),s=(0,a.userLoginSelector)(r),c=await(0,n.getDarkWebInsightsSummaryRequest)(t,s);return(0,i.isApiError)(c)?{success:!1,error:{code:o.ApiErrorType.GetDarkWebInsightsSummaryFailed,message:`get Dark Web Insights Summary failed: ${c.message}`}}:{success:!0,data:c}}},96805:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EmailIncidentViewStatus=t.BreachType=t.ApiErrorType=void 0,function(e){e.GetDarkWebInsightsFailed="GET_DARK_WEB_INSIGHTS_FAILED",e.GetDarkWebInsightsSummaryFailed="GET_DARK_WEB_INSIGHTS_SUMMARY_FAILED"}(t.ApiErrorType||(t.ApiErrorType={})),function(e){e.Password="password",e.CreditCard="creditcard",e.IPAddress="ip",e.MailingAddress="address",e.Phone="phone",e.Email="email",e.Social="social",e.GeoLocation="geolocation",e.UserName="username",e.PersonalInfo="personalinfo"}(t.BreachType||(t.BreachType={})),function(e){e.New="new",e.Viewed="viewed"}(t.EmailIncidentViewStatus||(t.EmailIncidentViewStatus={}))},52578:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCredentialSmartCategorized=t.isSpaceQuarantined=void 0;const o=r(21178),a=r(6205);t.isSpaceQuarantined=function(e){return!!e&&(!("accepted"===e.details.status.toLowerCase()||!e.details.info)&&(Boolean(e.details.info.forcedDomainsEnabled)&&Boolean(e.details.info.removeForcedContentEnabled)))},t.isCredentialSmartCategorized=function(e,t){if(!e)return!1;let r="";if(e.Url){const t=new o.ParsedURL(e.Url).getRootDomain();r=t?t.toLowerCase():""}const i=e.Email?e.Email.toLowerCase():"",n=e.Login?e.Login.toLowerCase():"",s=e.SecondaryLogin?e.SecondaryLogin.toLowerCase():"",c=(0,a.getUserAddedLinkedWebsiteDomains)(e).map((e=>e.toLowerCase()));return t.filter((e=>{const t=e.toLowerCase();return r.includes(t)||i.includes(t)||n.includes(t)||s.includes(t)||c.some((e=>e.includes(t)))})).length>0}},76235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(5847),a=r(4914),i=r(43837),n=r(2946),s=r(13648),c=r(15141),l=r(2282),d=r(81911),u=r(8453),p=r(68728),S=r(17025),g=r(57718),m=r(36351),y=r(72580),h=r(64489),v=r(75912),f=r(95633),A=r(6210),P=r(14037),b=r(80818),w=r(3474),T=r(80529),_=r(60309),I=r(45665),E=r(74172),C=r(11230),D=r(16458);t.config={commands:{...m.config.commands,...D.vaultConfig.commands,...o.config.commands,...a.config.commands,...i.config.commands,...y.config.commands,...n.config.commands,...s.config.commands,...h.config.commands,...v.config.commands,...c.config.commands,...w.config.commands,...f.config.commands,...l.config.commands,...C.importApiConfig.commands,...b.config.commands,...d.config.commands,...u.config.commands,...p.config.commands,...S.config.commands,...A.config.commands,...P.config.commands,...T.config.commands,...E.config.commands,..._.config.commands,...g.config.commands},queries:{...m.config.queries,...D.vaultConfig.queries,...o.config.queries,...a.config.queries,...y.config.queries,...n.config.queries,...s.config.queries,...h.config.queries,...v.config.queries,...c.config.queries,...w.config.queries,...f.config.queries,...l.config.queries,...C.importApiConfig.queries,...b.config.queries,...d.config.queries,...u.config.queries,...p.config.queries,...S.config.queries,...A.config.queries,...P.config.queries,...T.config.queries,..._.config.queries,...g.config.queries,...I.config.queries},liveQueries:{...m.config.liveQueries,...o.config.liveQueries,...a.config.liveQueries,...y.config.liveQueries,...n.config.liveQueries,...s.config.liveQueries,...h.config.liveQueries,...c.config.liveQueries,...w.config.liveQueries,...f.config.liveQueries,...l.config.liveQueries,...C.importApiConfig.liveQueries,...b.config.liveQueries,...d.config.liveQueries,...u.config.liveQueries,...p.config.liveQueries,...S.config.liveQueries,...A.config.liveQueries,...P.config.liveQueries,...T.config.liveQueries,..._.config.liveQueries,...g.config.liveQueries}}},37148:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.ImportSource=void 0,a(r(2124),t),a(r(63499),t),a(r(98760),t),a(r(26655),t),a(r(26763),t),a(r(59198),t),a(r(80666),t),a(r(80630),t),a(r(32921),t),a(r(93301),t),a(r(95175),t),a(r(42262),t),a(r(34130),t),a(r(76707),t),a(r(91315),t),a(r(52490),t),a(r(25),t),a(r(88815),t),a(r(60802),t),a(r(15874),t),function(e){e["1Password"]="1password",e.Bitwarden="bitwarden",e.Chrome="chrome",e.Dash="dash",e.Edge="edge",e.Firefox="firefox",e.Keepass="keepass",e.Keeper="keeper",e.Lastpass="lastpass",e.Other="other",e.Safari="safari"}(t.ImportSource||(t.ImportSource={}))},5847:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(16018),a=r(13370),i=r(8639);t.config={commands:{addBankAccount:{handler:i.addBankAccountHandler},updateBankAccount:{handler:i.updateBankAccountHandler},deleteBankAccount:{handler:i.deleteBankAccountHandler}},queries:{getBankAccount:{selector:o.viewedBankAccountSelector},getBankAccounts:{selector:o.viewedQueriedBankAccountsSelector}},liveQueries:{liveBankAccount:{operator:a.getBankAccount$},liveBankAccounts:{operator:a.bankAccounts$}}}},2124:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(3816),t)},14369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addBankAccountHandler=t.getNewBankAccount=void 0;const o=r(92233),a=r(3816),i=r(23136),n=r(92882),s=r(48313),c=r(53),l=r(78320),d=r(70252),u=r(13675),p=r(79980);t.getNewBankAccount=e=>{const t=(0,c.getUnixTimestamp)();return{kwType:"KWBankStatement",Id:(0,l.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,n.defaultToUS)(e.country),AnonId:(0,l.generateItemUuid)(),SpaceId:(0,n.defaultToEmptyString)(e.spaceId),CreationDatetime:t,UserModificationDatetime:t,BankAccountName:(0,n.defaultToEmptyString)(e.name),BankAccountOwner:(0,n.defaultToEmptyString)(e.owner),BankAccountIBAN:(0,n.defaultToEmptyString)(e.IBAN),BankAccountBIC:(0,n.defaultToEmptyString)(e.BIC),BankAccountBank:(0,n.defaultToEmptyString)(e.bank)}},t.addBankAccountHandler=async function(e,r){if(""===r.BIC&&""===r.IBAN)return{success:!1,error:{code:a.AddBankAccountResultErrorCode.EMPTY_BIC_AND_IBAN}};try{await async function({applicationModulesAccess:e,storeService:r,sessionService:o,eventLoggerService:a},n){if(!r.isAuthenticated())throw new Error("No session available to saveBankAccount");const c=(0,u.sanitizeInputPersonalData)(n),l=(0,t.getNewBankAccount)(c);if(!l.SpaceId){const t=await(0,i.getDefaultSpaceId)(e,r);l.SpaceId=t}(0,p.logAddVaultItem)(r,a,l),r.dispatch((0,s.savePersonalDataItem)(l,l.kwType)),o.getInstance().user.persistPersonalData()}(e,r);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,d.sendExceptionLog)({error:e}),{success:!1}}}},3242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBankAccountHandler=void 0;const o=r(92233),a=r(16018),i=r(3816),n=r(23136),s=r(45291),c=r(70252),l=r(79980),d=({storeService:e,eventLoggerService:t},r)=>{const o=e.getState();try{if(!e.isAuthenticated())return{success:!1,error:{code:i.DeleteBankAccountErrorCode.NOT_AUTHORIZED}};const n=(0,a.bankAccountSelector)(o,r);if(!n)return{success:!1,error:{code:i.DeleteBankAccountErrorCode.NOT_FOUND}};(0,l.logDeleteVaultItem)(e,t,n);const c=(0,s.removePersonalItem)(n.kwType,n.Id,null);return e.dispatch(c),{success:!0}}catch(e){const t=new Error(`[BankAccounts] - deleteBankAccount: ${e}`);return(0,c.sendExceptionLog)({error:t}),{success:!1,error:{code:i.DeleteBankAccountErrorCode.INTERNAL_ERROR}}}};t.deleteBankAccountHandler=function(e,{id:t}){const r=d(e,t);if(r.success){(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save)}return Promise.resolve(r)}},8639:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(14369),t),a(r(31570),t),a(r(3242),t)},31570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBankAccountHandler=t.getUpdatedBankAccount=t.getBankAccountModifiedProperties=void 0;const o=r(92233),a=r(16018),i=r(3816),n=r(23136),s=r(48313),c=r(53),l=r(70252),d=r(85406),u=r(13675),p=r(79980),S=e=>{if(void 0===e)return!1;return void 0===(0,d.getAllBanks)()[e]};function g(e,r){const o=(0,a.bankAccountSelector)(e,r.id);if(!o)return;const i=(0,t.getBankAccountModifiedProperties)(r,o),n=(0,c.getUnixTimestamp)();return{...o,...i,UserModificationDatetime:n}}t.getBankAccountModifiedProperties=(e,t)=>({BankAccountName:e.name??t.BankAccountName,BankAccountOwner:e.owner??t.BankAccountOwner,BankAccountIBAN:e.IBAN??t.BankAccountIBAN,BankAccountBIC:e.BIC??t.BankAccountBIC,BankAccountBank:e.bank??(S(e.country)?"":t.BankAccountBank),SpaceId:e.spaceId??t.SpaceId,LocaleFormat:e.country??t.LocaleFormat}),t.getUpdatedBankAccount=g,t.updateBankAccountHandler=function(e,t){try{const r=function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())throw new Error("No session available to updateBankAccount");const n=e.getState(),c=g(n,(0,u.sanitizeInputPersonalData)(o));if(!c)return{success:!1};if(""===c.BankAccountBIC&&""===c.BankAccountIBAN)return{success:!1,error:{code:i.UpdateBankAccountResultErrorCode.EMPTY_BIC_AND_IBAN}};const l=(0,a.bankAccountSelector)(n,o.id);return(0,p.logEditVaultItem)(e,r,c,l),e.dispatch((0,s.savePersonalDataItem)(c,c.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}(e,t);if(!r.success)return Promise.resolve(r);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,l.sendExceptionLog)({error:e}),Promise.resolve({success:!1})}}},92882:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankInfoFromBankAccountData=t.defaultToUS=t.defaultToEmptyString=void 0;const o=r(16516),a=r(53576),i=r(85406);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToUS=(0,o.defaultTo)(a.Country.US);t.getBankInfoFromBankAccountData=e=>{const r=(0,t.defaultToUS)(e.LocaleFormat),{banks:o}=(0,i.getBanks)({country:r}),a=((e,r)=>{if(r){const[o,a]=(0,t.defaultToEmptyString)(e).split("-"),i=r.find((({code:e})=>[o,a].includes(e)))?.code;return i||"NO_TYPE"}return""})(e.BankAccountBank,o),n=a?.length>0?`${r}-${a}`:"",s=(0,t.defaultToEmptyString)(o?.find((({code:e})=>e===a))?.localizedString);return{country:r,bankCode:a,bankLocalizedName:s,bank:n}}},48931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBankAccountSpecificProps=t.makeNewBankAccount=t.makeUpdatedBankAccount=void 0;const o=r(16516),a=r(53),i=r(78163);function n(e){const t=(0,o.defaultTo)("");return{BankAccountName:t(e.name),BankAccountOwner:t(e.owner),BankAccountIBAN:t(e.IBAN),BankAccountBIC:t(e.BIC),BankAccountBank:t(e.bank)}}t.makeUpdatedBankAccount=async function(e,t){const r=(0,i.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,a.getUnixTimestamp)()});return{...t,...r,...n(e.content)}},t.makeNewBankAccount=async function(e){return{...(0,i.makeNewPersonalDataItemBase)(e),...n(e.content)}},t.makeBankAccountSpecificProps=n},13370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankAccount$=t.bankAccounts$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(16018);t.bankAccounts$=(0,i.getLivePersonalInfo)(n.getLiveBankAccountsSelector);t.getBankAccount$=e=>{const t=(0,n.getViewedBankAccountSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},60931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankAccountMappers=void 0;const o=r(83539);t.getBankAccountMappers=()=>({spaceId:e=>e.SpaceId,accountName:e=>e.BankAccountName,bankName:e=>e.BankAccountBank,lastUse:o.lastUseMapper,id:e=>e.Id})},53704:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bankAccountMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("BankAccountName"),(0,a.stringProp)("BankAccountOwner"),(0,a.stringProp)("BankAccountBank")],t.bankAccountMatch=(0,o.match)(t.searchGetters)},16018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedBankAccountSelector=t.viewedBankAccountSelector=t.getLiveBankAccountsSelector=t.viewedQueriedBankAccountsSelector=t.queryBankAccountsSelector=t.bankAccountMappersSelector=t.bankAccountSelector=t.bankAccountsSelector=void 0;const o=r(16516),a=r(53704),i=r(62826),n=r(24589),s=r(63566),c=r(97006),l=r(49551),d=r(32034),u=r(60931),p=r(57989),S=r(40602);t.bankAccountsSelector=(0,d.createSelector)((e=>e.userSession.personalData.bankAccounts),p.quarantinedSpacesSelector,S.filterOutQuarantinedItems);t.bankAccountSelector=(e,r)=>{const o=(0,t.bankAccountsSelector)(e);return(0,l.findDataModelObject)(r,o)};t.bankAccountMappersSelector=e=>(0,u.getBankAccountMappers)();const g=()=>a.bankAccountMatch;t.queryBankAccountsSelector=(0,n.getQuerySelector)(t.bankAccountsSelector,g,t.bankAccountMappersSelector),t.viewedQueriedBankAccountsSelector=(0,o.compose)((0,s.viewListResults)(i.listView),t.queryBankAccountsSelector),t.getLiveBankAccountsSelector=(0,c.makeLiveSelectorGetter)(t.bankAccountsSelector,(()=>i.listView),g,t.bankAccountMappersSelector);t.viewedBankAccountSelector=(e,r)=>{const o=(0,t.bankAccountSelector)(e,r);return(0,i.detailView)(o)};t.getViewedBankAccountSelector=e=>{const r=(0,d.createSelector)(t.bankAccountsSelector,(t=>(0,l.findDataModelObject)(e,t)));return(0,d.createSelector)(r,i.detailView)}},3816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateBankAccountResultErrorCode=t.AddBankAccountResultErrorCode=t.DeleteBankAccountErrorCode=void 0,function(e){e[e.NOT_AUTHORIZED=0]="NOT_AUTHORIZED",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.INTERNAL_ERROR=2]="INTERNAL_ERROR"}(t.DeleteBankAccountErrorCode||(t.DeleteBankAccountErrorCode={})),function(e){e.EMPTY_BIC_AND_IBAN="EMPTY_BIC_AND_IBAN"}(t.AddBankAccountResultErrorCode||(t.AddBankAccountResultErrorCode={})),function(e){e.EMPTY_BIC_AND_IBAN="EMPTY_BIC_AND_IBAN"}(t.UpdateBankAccountResultErrorCode||(t.UpdateBankAccountResultErrorCode={}))},62826:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailView=void 0;const o=r(82043),a=r(92882),i=e=>{const t=(0,a.getBankInfoFromBankAccountData)(e);return{name:(0,a.defaultToEmptyString)(e.BankAccountName),owner:(0,a.defaultToEmptyString)(e.BankAccountOwner),IBAN:(0,a.defaultToEmptyString)(e.BankAccountIBAN),BIC:(0,a.defaultToEmptyString)(e.BankAccountBIC),bank:t.bank,country:t.country,bankCode:t.bankCode,bankLocalizedName:t.bankLocalizedName}};t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)});t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},4914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(21342),a=r(52283),i=r(44444);t.config={commands:{updateBreachStatus:{handler:i.updateBreachStatusHandler}},queries:{getBreach:{selector:o.viewedBreachSelector},getBreaches:{selector:o.viewedQueriedBreachesSelector},getBreachesPage:{selector:o.breachesPageSelector},getBreachesPaginationToken:{selector:o.breachesPaginationTokenSelector},getBreachesUpdateStatus:{selector:o.breachesUpdaterStatusSelector}},liveQueries:{liveBreach:{operator:a.getBreach$},liveBreaches:{operator:a.breaches$},liveBreachesBatch:{operator:a.breachesBatch$},liveBreachesUpdaterStatus:{operator:a.breachesUpdaterStatus$}}}},63499:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesUpdaterStatus=t.BreachStatus=t.BreachLeakedDataType=void 0;var o=r(67083);Object.defineProperty(t,"BreachLeakedDataType",{enumerable:!0,get:function(){return o.BreachLeakedDataType}}),Object.defineProperty(t,"BreachStatus",{enumerable:!0,get:function(){return o.BreachStatus}});var a=r(95377);Object.defineProperty(t,"BreachesUpdaterStatus",{enumerable:!0,get:function(){return a.BreachesUpdaterStatus}})},95303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=void 0;const o=r(70252),a=r(90503),i=r(90622),n=r(16593),s=r(88205),c=r(36017),l=r(95377),d=r(75130),u=r(44331),p=r(38785),S=r(45291);class g{constructor(e,t,r,o,a){this.storeService=e,this.applicationModulesAccess=t,this.credentialVault=r,this.breachVault=o,this.gateway=a,this.lastRefreshTimestamp=0,this.refreshInProgress=!1}async refresh(e){try{if(this.refreshInProgress)return{vaultSyncNeeded:!1};this.refreshInProgress=!0,this.storeService.dispatch((0,S.updateBreachesUpdaterStatus)(l.BreachesUpdaterStatus.SYNCING));const t=Boolean(e&&e.forceRefresh);if(!await this.isFeatureFlipped()||!this.isSessionOpened()||!this.isRefreshNeeded(t))return this.storeService.dispatch((0,S.updateBreachesUpdaterStatus)(l.BreachesUpdaterStatus.SKIPPED)),this.refreshInProgress=!1,{vaultSyncNeeded:!1};const{breachVault:r,credentialVault:o}=this,a=await this.fetchLatestPublicBreaches(),i=await this.fetchLatestPrivateBreaches();this.resetTimer();const n=o.getAllCredentials(),s=r.getAllBreaches(),d=[...a.breaches,...i.breaches],u=(0,c.getChangesFromIncomingBreaches)(n,s,d);await r.applyChangesFromSync(u,a.revision,i.refreshDate);const p=this.isVaultSyncNeeded(u);return this.storeService.dispatch((0,S.updateBreachesUpdaterStatus)(p?l.BreachesUpdaterStatus.UPDATED:l.BreachesUpdaterStatus.UNCHANGED)),{vaultSyncNeeded:p}}catch(e){this.storeService.dispatch((0,S.updateBreachesUpdaterStatus)(l.BreachesUpdaterStatus.ERROR));const t=new Error(`[Breaches] - refresh: ${e}`);return(0,o.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING}),{vaultSyncNeeded:!1}}finally{this.refreshInProgress=!1}}async isFeatureFlipped(){const{applicationModulesAccess:e}=this,t=await(0,s.makeFeatureFlipsSelectors)(e).featureFlipsSelector();return Boolean(t)&&t[g.BREACHES_REFRESH_FEATURE_FLIP]}isSessionOpened(){const{storeService:e}=this,t=e.getState(),r=(0,n.userLoginSelector)(t),o=(0,i.ukiSelector)(t);return Boolean(o&&r)}isRefreshNeeded(e){return e||Date.now()-this.lastRefreshTimestamp>=g.BREACHES_REFRESH_INTERVAL_MS}resetTimer(){this.lastRefreshTimestamp=Date.now()}isVaultSyncNeeded(e){return e.updates.length+e.deletions.length>0}async fetchLatestPublicBreaches(){const e=this.breachVault.getLatestPublicBreachesRevision();return this.gateway.getLatestPublicBreaches(e)}async fetchLatestPrivateBreaches(){const e=this.breachVault.getPrivateBreachesRefreshDate();let t,r=[];try{const o=await this.gateway.getLatestPrivateBreaches(e);o&&(r=o.breaches,t=o.refreshDate)}catch(e){const t=new Error(`[Breaches] - refresh: fetchPrivateBreaches error: ${e}`);(0,o.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return{breaches:r,refreshDate:t}}}g.BREACHES_REFRESH_INTERVAL_MS=864e5,g.BREACHES_REFRESH_FEATURE_FLIP="breachesFetchWeb";let m=null;t.getInstance=(e,t,r)=>(null===m&&(m=new g(t,e,new u.CredentialVault(t),new d.BreachVault(t),new p.BreachesWS(r,t))),m);t.clearInstance=()=>{m=null}},36017:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangesFromIncomingBreaches=void 0;const o=r(90073),a=r(67083),i=r(86715),n=r(25656),s=r(83480),c=e=>({updates:[e],deletions:[]}),l=(e,t)=>({updates:[...e.updates,...t.updates],deletions:[...e.deletions,...t.deletions]}),d=e=>Boolean(e.Password),u=e=>Array.from(new Set(e)),p=(e,t)=>{const{content:r}=e,{leakedPasswords:o}=e;let i=o;if((0,s.hasBreachLeakedDataOfType)(r,a.BreachLeakedDataType.Password)){const{eventDate:e}=r,a=t.filter((e=>t=>1e3*(t.ModificationDatetime||t.CreationDatetime||0)<Date.parse(e))(e)).filter(d).map((e=>e.Password));i=[...o,...a]}return u(i||[])},S=function(e,t,r){const{content:o}=r,{id:l,lastModificationRevision:d}=o,S=(0,s.findByBreachId)(l,t);if(S){if(d<=S.ContentRevision)return{updates:[],deletions:[]};if((0,s.isBreachDeleted)(o))return{updates:[],deletions:[S.Id]}}const g=((e,t)=>(t.content.domains??[]).reduce(((t,r)=>[...t,...e.get(r)??[]]),[]))(e,r),m=p(r,g);return((e,t,r)=>{const o=!(0,i.isDataLeaksBreachContent)(e),a=r.length>0,n=(0,s.hasBreachLeakedPrivateInfo)(e),c=t.length>0;return o&&!a&&(!n||!c)})(o,g,m)?{updates:[],deletions:[]}:c(S?((e,t,r)=>{const o=u(e.LeakedPasswords||[]),i=u([...e.LeakedPasswords,...r]),n=o.length!==i.length?a.BreachStatus.PENDING:e.Status;return{...e,Content:t,ContentRevision:t.lastModificationRevision,LeakedPasswords:i,Status:n}})(S,o,m):(0,n.makeBreachFromContent)(o,m))};t.getChangesFromIncomingBreaches=function(e,t,r){const a=new Map;return e.forEach((e=>{const t=(0,o.getDomainForCredential)(e)||"",r=a.get(t)??[];a.set(t,[...r,e])})),r.reduce(((e,r)=>l(e,S(a,t,r))),{updates:[],deletions:[]})}},25656:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBreachFromContent=void 0;const o=r(53576),a=r(78320),i=r(67083);t.makeBreachFromContent=(e,t)=>({kwType:o.DataModelType.KWSecurityBreach,LastBackupTime:0,Id:(0,a.generateItemUuid)(),AnonId:(0,a.generateItemUuid)(),BreachId:e.id,Content:e,ContentRevision:e.lastModificationRevision,Status:i.BreachStatus.PENDING,LeakedPasswords:t})},95377:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesUpdaterStatus=void 0,function(e){e.UNKNOWN="unknown",e.SYNCING="syncing",e.SKIPPED="skipped",e.UNCHANGED="unchanged",e.UPDATED="updated",e.ERROR="error"}(t.BreachesUpdaterStatus||(t.BreachesUpdaterStatus={}))},44444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachStatus=t.updateBreachStatusHandler=void 0;const o=r(92233),a=r(48313),i=r(23136),n=r(70252),s=r(95623),c=r(21342);function l(e,t){if(!e.isAuthenticated())throw new Error("No session available to update Breach");const r=e.getState(),o=(0,c.breachSelector)(r,t.id);if(!o)throw new Error("Breach does not exist, cant update");const i={...o,Status:t.status};e.dispatch((0,a.savePersonalDataItem)(i,i.kwType))}t.updateBreachStatusHandler=async function(e,t){const{storeService:r,sessionService:a}=e;try{l(r,t);return(0,i.getDebounceSync)(r,a)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return s.Debugger.error(e),(0,n.sendExceptionLog)({error:e}),{success:!1}}},t.updateBreachStatus=l},38785:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesWS=void 0;const o=r(16516),a=r(14656),i=r(35587),n=r(36513),s=r(56984),c=r(72365),l=r(16038),d=r(32607),u=r(70252),p=r(90503),S=r(16593),g=r(90622),m=r(48162),y=r(86715),h=r(83480),v=r(48162),f=r(56668);t.BreachesWS=class{constructor(e,t){this.wsService=e,this.storeService=t}async getLatestPublicBreaches(e){const t=this.storeService.getState(),r=(0,S.userLoginSelector)(t),o=(0,g.ukiSelector)(t);if(null===r||null===o)throw new Error("[Breaches] - getLatestPublicBreaches: no current authenticated user");const a=await this.wsService.breaches.get({login:r,uki:o,revision:e});if(!(0,d.isWSResponseSuccess)(a)){const e=`[Breaches] getLatestPublicBreaches: ${a.message}(statusCode: ${a.code})`;throw new Error(e)}const{content:i}=a,{latest:n,filesToDownload:s,revision:c}=i,l=[...n,...await this.downloadFileBreaches(s)].filter(y.isSupportedBreachContent);return{revision:c,breaches:(0,h.deduplicateBreachContents)(l).map((e=>(0,v.makeIncomingBreach)(e,[])))}}async getLatestPrivateBreaches(e){const t=this.storeService.getState(),r=(0,S.premiumStatusSelector)(t);if(!(0,m.hasDarkWebMonitoringFeature)(r))return null;const o=(0,S.userLoginSelector)(t),a=(0,g.ukiSelector)(t);if(null===o||null===a)throw new Error("[Breaches] - getLatestPrivateBreaches: no current authenticated user");const i=await this.wsService.dataleaks.leaks({login:o,uki:a,wantsDetails:!0,includeDisabled:!1,lastUpdateDate:e});if(!(0,d.isWSResponseSuccess)(i)){if((0,v.isBreachesWSResponseNotModified)(i))return{breaches:[],refreshDate:e};const t=i.error&&i.error.code?`, code: ${i.error.code}`:"",r=`[Breaches] - getLatestPrivateBreaches: ${i.message} (statusCode: ${i.code}${t})`;throw new Error(r)}const{content:n}=i,{details:s,leaks:c,lastUpdateDate:l}=n,u=await this.extractLeakedPasswords(s),p=c.filter(y.isSupportedBreachContent);return{breaches:(0,h.deduplicateBreachContents)(p).map((e=>(0,v.makeIncomingBreach)(e,u[e.id]||[]))),refreshDate:l}}async downloadFileBreaches(e){return(0,o.flatten)(await(0,i.asyncMap)(e,this.downloadFileBreach))}async downloadFileBreach(e){try{const{data:t}=await(0,a.get)(e);return t.breaches}catch(e){const t=new Error(`[Breaches] - downloadFileBreach: ${e}`);return(0,u.sendExceptionLog)({error:t,code:p.ExceptionCriticality.ERROR}),[]}}async extractLeakedPasswords(e){try{if(!e||!e.cipheredKey||!e.cipheredInfo)return{};const t=this.storeService.getState(),r=(0,S.sharingKeysSelector)(t);if(!r||!r.publicKey||!r.privateKey)return{};const{privateKey:o}=r,a=(0,n.makeAsymmetricEncryption)({hashAlgorithm:s.HashAlgorithm.SHA_1}),i=await a.decrypt(o,e.cipheredKey),d=(0,c.makeDataEncryptorService)(this.storeService),u=(0,l.base64ToBuffer)(i),p=(0,l.arrayBufferToText)(u);d.setInstance({raw:p},"");const g=await d.getInstance().decrypt(e.cipheredInfo),m=(0,f.deflatedUtf8ToUtf16)(g,{skipInflate:!0}),y=JSON.parse(m);return(0,v.getLeakedPasswordFromIncomingDataLeakDetails)(y)}catch(e){const t=new Error(`[Breaches] - extractLeakedPasswords: ${e}`);return(0,u.sendExceptionLog)({error:t}),{}}}}},12756:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIncomingDataLeakPasswordInfo=t.isIncomingDataLeakBreachDetails=void 0;const o=r(16516);t.isIncomingDataLeakBreachDetails=e=>(0,o.is)(Object,e)&&"string"==typeof e.breachId&&""!==e.breachId&&Array.isArray(e.data);t.isIncomingDataLeakPasswordInfo=e=>(0,o.is)(Object,e)&&"password"===e.type&&"plaintext"===e.hashMethod&&"string"==typeof e.value&&""!==e.value},48162:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasDarkWebMonitoringFeature=t.isBreachesWSResponseNotModified=t.getLeakedPasswordFromIncomingDataLeakDetails=t.makeIncomingBreach=void 0;const o=r(12756);t.makeIncomingBreach=(e,t)=>({content:e,leakedPasswords:t});t.getLeakedPasswordFromIncomingDataLeakDetails=e=>{if(!Array.isArray(e))return{};const t=e=>(0,o.isIncomingDataLeakPasswordInfo)(e)?e.value:null;return e.reduce(((e,r)=>{if(!(0,o.isIncomingDataLeakBreachDetails)(r))return e;const{breachId:a,data:i}=r,n=i.map(t).filter(Boolean);return n.length?{...e,[a]:n}:e}),{})};t.isBreachesWSResponseNotModified=e=>304===e.code,t.hasDarkWebMonitoringFeature=function(e){if(!e)return!1;const{capabilities:t}=e;return Boolean(t&&t.dataLeak)}},75130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachVault=void 0;const o=r(45291),a=r(12362),i=r(86691),n=r(21342);t.BreachVault=class{constructor(e){this.storeService=e}async applyChangesFromSync(e,t,r){const n=(0,o.breachesUpdated)(e,t,r);let s=null;const{updates:c,deletions:l}=e,d=c.length+l.length,u=(0,a.getInstance)(),p=(0,i.getInstance)();try{d&&(s=p.lockTopic("iconsUpdates"),await u.add("iconsUpdates",{type:"breachUpdates",breachesIds:c.map((e=>e.Id))})),this.storeService.dispatch(n),d&&p.releaseTopic("iconsUpdates",s)}catch(e){throw s&&p.releaseTopic("iconsUpdates",s),e}}getAllBreaches(){const e=this.storeService.getState();return(0,n.breachesSelector)(e)}getLatestPublicBreachesRevision(){const e=this.storeService.getState();return(0,n.publicBreachesRevisionSelector)(e)}getPrivateBreachesRefreshDate(){const e=this.storeService.getState();return(0,n.privateBreachesLastUpdateTimestamp)(e)}}},44331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialVault=void 0;const o=r(51319);t.CredentialVault=class{constructor(e){this.storeService=e}getAllCredentials(){const e=this.storeService.getState();return(0,o.credentialsSelector)(e)}}},9335:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailItemView=void 0;const o=r(16516),a=r(88749),i=r(86715),n=r(90451),s=(0,o.defaultTo)([]);function c({name:e,domains:t}){if(e)return e;if(t.length>0){const[e]=t;return e}return""}function l(e,t){if(t&&0!==t.length)return(0,n.getIcon)(e)(t[0])}function d(e,t){const r=t.Content,o=(0,i.isDataLeaksBreach)(t)?t.Content.impactedEmails:[];return{domains:s(r.domains),breachType:(0,a.breachTypeMapper)(t),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:o,name:c(r),status:t.Status}}t.detailItemView=function(e,t){const r=t.Content,o=(0,i.isDataLeaksBreach)(t)?t.Content.impactedEmails:[],n=new Set;return{anonId:t.AnonId,breachType:(0,a.breachTypeMapper)(t),domains:s(r.domains),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:o,kwType:t.kwType,leakedData:s(r.leakedData),leakedPasswords:s(t.LeakedPasswords),name:c(r),status:t.Status,compromisedCredentialIds:[...n]}},t.itemView=d,t.listView=function(e,t){return t.map((t=>d(e,t)))}},83480:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasBreachLeakedPrivateInfo=t.hasBreachLeakedDataOfType=t.isBreachDeleted=t.findByBreachId=t.deduplicateBreachContents=void 0;const o=r(16516),a=r(67083),i=r(86715),n=(0,o.takeLast)(1);t.deduplicateBreachContents=(0,o.pipe)((0,o.groupBy)((0,o.prop)("id")),(0,o.mapObjIndexed)((0,o.sortBy)((0,o.prop)("lastModificationRevision"))),(0,o.mapObjIndexed)((e=>n(e))),o.values,o.flatten);t.findByBreachId=(e,t)=>t.find((t=>t.BreachId===e));t.isBreachDeleted=e=>e.status===a.BreachEnvStatus.Deleted;t.hasBreachLeakedDataOfType=(e,t)=>(e.leakedData||[]).findIndex((e=>t===e))>=0;t.hasBreachLeakedPrivateInfo=e=>(0,i.isDataLeaksBreachContent)(e)||((e,t)=>(e.leakedData||[]).findIndex((e=>t.some((t=>t===e))))>=0)(e,[a.BreachLeakedDataType.Email,a.BreachLeakedDataType.Username,a.BreachLeakedDataType.CreditCard,a.BreachLeakedDataType.Phone,a.BreachLeakedDataType.Address,a.BreachLeakedDataType.SSN,a.BreachLeakedDataType.IP,a.BreachLeakedDataType.Location,a.BreachLeakedDataType.PersonalInfo,a.BreachLeakedDataType.SocialNetwork])},86715:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicBreach=t.isDataLeaksBreach=t.isDataLeaksBreachContent=t.isBreach=t.isSupportedBreach=t.isSupportedBreachContent=void 0;const o=r(16516),a=e=>(0,o.is)(Object,e);function i(e){return function(e){return a(e)&&"number"==typeof e.breachModelVersion}(e)&&1===e.breachModelVersion&&Array.isArray(e.domains)&&"string"==typeof e.eventDate&&"string"==typeof e.id}function n(e){return s(e)&&i(e.Content)}function s(e){return Boolean(e)&&"KWSecurityBreach"===e.kwType}function c(e){return function(e){return"impactedEmails"in e&&Array.isArray(e.impactedEmails)}(e)&&e.impactedEmails.length>0}t.isSupportedBreachContent=i,t.isSupportedBreach=n,t.isBreach=s,t.isDataLeaksBreachContent=c;t.isDataLeaksBreach=e=>n(e)&&c(e.Content);t.isPublicBreach=e=>n(e)&&!c(e.Content)},52283:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachesUpdaterStatus$=t.getBreach$=t.breaches$=t.breachesBatch$=void 0;const o=r(18948),a=r(3343),i=r(35893),n=r(33627),s=r(55220),c=r(21342);t.breachesBatch$=e=>{const t=(0,i.parseToken)(e),r=(0,c.getViewedBreachesBatchSelector)(t);return(0,o.pipe)((0,a.map)(r),(0,a.distinctUntilChanged)(n.sameBatch))},t.breaches$=(0,s.getLivePersonalInfo)(c.getLiveBreachesSelector),t.getBreach$=function(e){const t=(0,c.getViewedBreachSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())};t.breachesUpdaterStatus$=()=>(0,o.pipe)((0,a.map)(c.breachesUpdaterStatusSelector),(0,a.distinctUntilChanged)())},88749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachMappers=t.breachTypeMapper=void 0;const o=r(86715);function a(e){return(0,o.isDataLeaksBreach)(e)?"private":"public"}t.breachTypeMapper=a;t.getBreachMappers=()=>({breachType:e=>a(e),eventDate:e=>function({eventDate:e}){return Date.parse(e)}(e.Content),id:e=>e.Id,status:e=>e.Status})},69623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachesBatch=t.viewBreachesBatch=t.getBreachesFirstToken=t.getBreacheSortToken=t.getBreachesFilterToken=void 0;const o=r(16516),a=r(20553),i=r(9335);t.getBreachesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getBreacheSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getBreachesFirstToken=(e,t,r,o)=>(0,a.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewBreachesBatch=(e,t)=>(0,i.listView)(e,t),t.getBreachesBatch=(0,o.curry)(((e,t,r)=>(0,a.getBatch)(r,e,t)))},37600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachMatch=t.searchGetters=void 0;const o=r(64455);t.searchGetters=[],t.breachMatch=(0,o.match)(t.searchGetters)},21342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachesUpdaterStatusSelector=t.getViewedBreachSelector=t.getViewedBreachesBatchSelector=t.getLiveBreachesSelector=t.fieldMappersSelector=t.breachesQuerySelector=t.breachesPaginationTokenSelector=t.breachesPageSelector=t.viewedQueriedBreachesSelector=t.breachMappersSelector=t.viewedBreachSelector=t.breachSelector=t.privateBreachesLastUpdateTimestamp=t.publicBreachesRevisionSelector=t.publicBreachesSelector=t.privateBreachesSelector=t.breachesSelector=void 0;const o=r(18948),a=r(32034),i=r(86715),n=r(49551),s=r(63566),c=r(24589),l=r(35893),d=r(20553),u=r(97006),p=r(9335),S=r(88749),g=r(37600),m=r(69623),y=r(91892),h=e=>e.userSession.personalData.securityBreaches,v=(0,a.createSelector)(h,(e=>e.filter(i.isSupportedBreach)));t.breachesSelector=(0,a.createSelector)(v,(e=>[...e.reduce(((e,t)=>{const r=e.get(t.BreachId);return(!r||r.LastBackupTime<t.LastBackupTime)&&e.set(t.BreachId,t),e}),new Map).values()])),t.privateBreachesSelector=(0,a.createSelector)(h,(e=>[...new Set(e.filter(i.isDataLeaksBreach))])),t.publicBreachesSelector=(0,a.createSelector)(h,(e=>[...new Set(e.filter(i.isPublicBreach))]));t.publicBreachesRevisionSelector=e=>e.userSession.personalData.securityBreachesMetadata.latestPublicBreachesRevision;function f(e,r){const o=(0,t.breachesSelector)(e);return(0,n.findDataModelObject)(r,o)}t.privateBreachesLastUpdateTimestamp=e=>e.userSession.personalData.securityBreachesMetadata.latestDataLeaksBreachesUpdate,t.breachSelector=f,t.viewedBreachSelector=function(e,t){const r=(0,y.iconsSelector)(e),o=f(e,t);return(0,p.detailItemView)(r,o)};t.breachMappersSelector=e=>(0,S.getBreachMappers)();const A=()=>g.breachMatch,P=(0,c.getQuerySelector)(t.breachesSelector,A,t.breachMappersSelector),b=(0,a.createSelector)(y.iconsSelector,(e=>t=>(0,m.viewBreachesBatch)(e,t)));t.viewedQueriedBreachesSelector=(e,t)=>{const r=P(e,t),o=b(e);return(0,s.viewListResults)(o)(r)},t.breachesPageSelector=function(e,r){const o=(0,l.parseToken)(r),{sortToken:a,filterToken:i}=o,n={sortToken:a,filterToken:i},s=(0,S.getBreachMappers)(),c=(0,t.breachesQuerySelector)(e,n),u=b(e),p=(0,d.generateNextToken)(s,o,c),g=(0,d.generatePrevToken)(s,o,c),m=(0,d.getBatch)(s,o,c),y=(0,l.stringifyToken)(p),h=(0,l.stringifyToken)(g);return{batch:u(m),nextToken:y,prevToken:h}};t.breachesPaginationTokenSelector=(e,r)=>{const o=(0,m.getBreacheSortToken)(r),a=(0,m.getBreachesFilterToken)(r),i=(0,S.getBreachMappers)(),n={sortToken:o,filterToken:a},s=(0,t.breachesQuerySelector)(e,n),c=(0,m.getBreachesFirstToken)(i,n,r,s);return(0,l.stringifyToken)(c)};const w=(0,l.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity),T=(0,l.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity);t.breachesQuerySelector=(0,a.createSelector)(S.getBreachMappers,A,w,T,t.breachesSelector,l.queryData),t.fieldMappersSelector=(0,a.createSelector)(t.breachesSelector,S.getBreachMappers),t.getLiveBreachesSelector=(0,u.makeLiveSelectorGetter)(t.breachesSelector,b,A,t.breachMappersSelector);t.getViewedBreachesBatchSelector=e=>{const{sortToken:r,filterToken:o}=e,i={sortToken:r,filterToken:o},n=(0,m.getBreachesBatch)(e),s=(0,a.createSelector)((e=>(0,t.breachesQuerySelector)(e,i)),t.fieldMappersSelector,n),c=(0,l.optimizeBatchSelector)(s);return(0,a.createSelector)(y.iconsSelector,c,m.viewBreachesBatch)},t.getViewedBreachSelector=function(e){const r=(0,a.createSelector)(t.breachesSelector,(t=>(0,n.findDataModelObject)(e,t)));return(0,a.createSelector)(y.iconsSelector,r,p.detailItemView)};t.breachesUpdaterStatusSelector=e=>e.userSession.personalData.breachesUpdaterStatus},79405:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(95303);t.setupSubscriptions=async function(e,t){const{applicationModulesAccess:r,storeService:a,wsService:i}=t;e.syncSuccess.on((()=>{(0,o.getInstance)(r,a,i).refresh({forceRefresh:!1})}))}},67083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachCriticality=t.BreachEnvStatus=t.BreachLeakedDataType=t.BreachStatus=void 0,function(e){e.PENDING="PENDING",e.VIEWED="VIEWED",e.ACKNOWLEDGED="ACKNOWLEDGED"}(t.BreachStatus||(t.BreachStatus={})),function(e){e.Username="username",e.Password="password",e.Email="email",e.CreditCard="creditcard",e.Phone="phone",e.Address="address",e.SSN="ssn",e.IP="ip",e.Location="geolocation",e.PersonalInfo="personalinfo",e.SocialNetwork="social"}(t.BreachLeakedDataType||(t.BreachLeakedDataType={})),function(e){e.Legacy="legacy",e.Live="live",e.Staging="staging",e.Deleted="deleted"}(t.BreachEnvStatus||(t.BreachEnvStatus={})),function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.BreachCriticality||(t.BreachCriticality={}))},40220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentData=t.getChangeSet=t.getChangedProperties=t.getChangedPropertiesForRemoval=void 0;const o=r(16516),a=r(78320),i=r(53),n=r(15171),s={KWAuthentifiant:{Email:"",Login:"",Note:"",Password:"",SecondaryLogin:"",Title:"",Url:"",UserSelectedUrl:"",LinkedServices:{associated_domains:[]}},KWSecureNote:{Content:"",Title:""}};function c(e){const t=s[e.kwType];return Object.keys(t).filter((r=>"LinkedServices"===r?e[r]?.associated_domains&&e[r].associated_domains.length>0:e[r]&&e[r]!==t[r]))}function l(e,t){const r=s[e.kwType];return Object.keys(r).filter((r=>{if("LinkedServices"===r){const o=(e[r]?.associated_domains??[]).map((e=>e.domain)),a=(t[r]?.associated_domains??[]).map((e=>e.domain));return!(0,n.areStringListsEquivalent)(o,a)}return e[r]&&""!==e[r]&&e[r]!==t[r]}))}function d(e){return Object.keys(s[e.kwType]).reduce(((t,r)=>(t[r]="LinkedServices"===r?e[r]?.associated_domains?e[r]:{associated_domains:[]}:e[r]||"",t)),{})}t.getChangedPropertiesForRemoval=c,t.getChangedProperties=l,t.getChangeSet=function(e){const{change:t,deviceName:r,oldItem:n,userLogin:s,platformInfo:u}=e;if((0,o.isNil)(n))return null;const p="removal"===t.type?c(n):l(n,t.updatedItem);return 0===p.length?null:{kwType:"KWChangeSet",ChangedProperties:p,CurrentData:d(n),Id:(0,a.generateItemUuid)(),Platform:u.platformName,DeviceName:r||"",ModificationDate:(0,i.getUnixTimestamp)(),Removed:(0,o.defaultTo)(!1,"removal"===t.type),User:s}},t.getCurrentData=d},85225:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeRemovalChange=t.makeUpdateChange=void 0;t.makeUpdateChange=e=>({type:"update",updatedItem:e});t.makeRemovalChange=e=>({type:"removal",itemId:e.Id,itemKwType:e.kwType})},73566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedItemChangeHistory=t.isChangeHistoryCandidate=t.getEmptyChangeHistory=void 0;const o=r(16516),a=r(53576),i=r(78320),n=r(40220),s=r(84977),c=r(83638),l=r(49551);function d(e){const[t,r,o]="removal"===e.type?[e.itemId,e.itemKwType,""]:[e.updatedItem.Id,e.updatedItem.kwType,e.updatedItem.Title||""];return{kwType:"KWDataChangeHistory",ChangeSets:[],Id:(0,i.generateItemUuid)(),ObjectId:t,ObjectTitle:o,ObjectType:(0,c.getTransactionTypeFromDataModelType)(r),LastBackupTime:0}}t.getEmptyChangeHistory=d;const u=(e,t)=>(0,o.equals)(t.CurrentData,e.CurrentData);t.isChangeHistoryCandidate=function(e){return(0,a.isCredential)(e)||(0,a.isNote)(e)},t.getUpdatedItemChangeHistory=function(e){const{deviceName:t,personalData:r,change:a,userLogin:i,platformInfo:c}=e,[p,S,g]="removal"===a.type?[a.itemId,a.itemKwType,""]:[a.updatedItem.Id,a.updatedItem.kwType,a.updatedItem.Title],m=s.default[S],y=(0,l.findDataModelObject)(p,r[m]),h=(0,n.getChangeSet)({deviceName:t,change:a,oldItem:y,userLogin:i,platformInfo:c});if(!h)return null;const v=r.changeHistories.find((e=>e?.ObjectId?.toUpperCase()===(p||"").toUpperCase())),f=v||d(a),A=(0,o.last)(f.ChangeSets);return A&&u(A,h)?null:{...f,ObjectTitle:g,ChangeSets:f.ChangeSets.concat(h)}}},35385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsHistoriesSelector=void 0;const o=r(32034),a=r(40602),i=r(83659),n=r(57989),s=r(83638),c=e=>e.ObjectType===s.TransactionType.AUTHENTIFIANT,l=(0,o.createSelector)((e=>e.userSession.personalData.changeHistories),(e=>e.filter(c)));t.credentialsHistoriesSelector=(0,o.createSelector)(l,n.quarantinedSpacesSelector,i.unsafeAllCredentialsSelector,a.filterOutQuarantinedItems)},43837:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(42682);t.config={commands:{addCollection:{handler:o.addCollectionHandler},deleteCollection:{handler:o.deleteCollectionHandler},removeItemsFromCollections:{handler:o.removeItemsFromCollectionsHandler},updateCollection:{handler:o.updateCollectionHandler}},queries:{},liveQueries:{}}},55740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCollectionHandler=t.getNewCollection=void 0;const o=r(53576),a=r(92233),i=r(23136),n=r(48313),s=r(53),c=r(78320),l=r(70252),d=r(13675);function u(e){const t=(0,s.getUnixTimestamp)();return{kwType:"KWCollection",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:o.Country.UNIVERSAL,AnonId:(0,c.generateItemUuid)(),SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Name:e.name,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))}}t.getNewCollection=u,t.addCollectionHandler=async function(e,t){try{const r=await async function({applicationModulesAccess:e,storeService:t,sessionService:r},o){if(!t.isAuthenticated())throw new Error("No session available to addCollection");const a=u((0,d.sanitizeInputPersonalData)(o));if(!a.SpaceId){const r=await(0,i.getDefaultSpaceId)(e,t);a.SpaceId=r}return t.dispatch((0,n.savePersonalDataItem)(a,a.kwType)),r.getInstance().user.persistPersonalData(),a.Id}(e,t);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),{success:!0,id:r}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}},9833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCollectionHandler=void 0;const o=r(92233),a=r(23136),i=r(70252),n=r(53576),s=r(45291);t.deleteCollectionHandler=async function(e,t){try{await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to deleteCollection");const o=(0,s.removePersonalItem)(n.DataModelType.KWCollection,r,null);e.dispatch(o),t.getInstance().user.persistPersonalData()}(e,t.id);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,i.sendExceptionLog)({error:e}),{success:!1}}}},42682:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(55740),t),a(r(9833),t),a(r(73240),t),a(r(6366),t)},73240:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemsFromCollectionsHandler=void 0;const o=r(53626),a=r(6366);t.removeItemsFromCollectionsHandler=async function(e,t){const r=e.storeService.getState(),i=(0,o.collectionsSelector)(r),n=[];let s,c;if(i.forEach((e=>{s=e.VaultItems.length,e.VaultItems=e.VaultItems.filter((e=>!t.ids.includes(e.Id))),c=e.VaultItems.length,s!==c&&n.push(e)})),!n.length)return;const l=n.map((t=>(0,a.updateCollectionHandler)(e,{id:t.Id,name:t.Name,spaceId:t.SpaceId,vaultItems:t.VaultItems.map((e=>({id:e.Id,type:e.Type})))})));return{success:!(await Promise.all(l)).some((e=>!e.success))}}},6366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCollectionHandler=void 0;const o=r(92233),a=r(23136),i=r(48313),n=r(53),s=r(70252),c=r(13675),l=r(53626),d=e=>({LastUse:(0,n.getUnixTimestamp)(),Name:e.name,SpaceId:e.spaceId,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))});async function u(e,t,r){if(!e.isAuthenticated())throw new Error("No session available to updateCollection");const o=function(e,t){const r=(0,l.collectionSelector)(e,t.id);if(!r)throw new Error("[updateCollection]: unable to find collection to update.");return{...r,...d(t)}}(e.getState(),(0,c.sanitizeInputPersonalData)(r));return e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData()}t.updateCollectionHandler=async function(e,t){try{await u(e.storeService,e.sessionService,t);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,s.sendExceptionLog)({error:e}),{success:!1}}}},10770:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(42682),t),a(r(53626),t),a(r(182),t)},53626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collectionSelector=t.collectionsSelector=void 0;const o=r(49551);t.collectionsSelector=e=>e.userSession.personalData.collections;t.collectionSelector=(e,r)=>{const a=(0,t.collectionsSelector)(e);return(0,o.findDataModelObject)(r,a)}},182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectionNamesContainingVaultItemId=void 0;t.getCollectionNamesContainingVaultItemId=(e,t,r=[])=>t.flatMap((t=>t.VaultItems.some((t=>t.Id===e))?t.Name:[])).concat(r.flatMap((t=>t.vaultItems.some((t=>t.id===e))?t.name:[])))},2946:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(8777),a=r(71806),i=r(7657),n=r(10043),s=r(35410),c=r(80920),l=r(79895),d=r(60581),u=r(66663),p=r(28831),S=r(73567),g=r(9763),m=r(52109),y=r(39546),h=r(70853),v=r(8766),f=r(15171);t.config={commands:{addCredential:{handler:g.createCredential},deleteCredential:{handler:m.deleteCredentialHandler},deleteCredentialsInBulk:{handler:y.deleteCredentialsInBulkHandler},updateCredential:{handler:h.updateCredentialHandler},updateLinkedWebsites:{handler:f.updateLinkedWebsitesHandler}},queries:{canUserAddNewCredential:{selector:o.canUserAddNewCredentialSelector},getCredential:{selector:d.viewedCredentialSelector},getCredentialCategories:{selector:l.viewedCredentialCategoriesSelector},getCredentials:{selector:u.viewedQueriedCredentialsSelector},getCredentialsByDomain:{selector:p.viewedQueriedCredentialsByDomainSelector},getCredentialsCount:{selector:a.credentialsCountSelector},getCredentialLimitStatus:{selector:i.credentialLimitStatusSelector},getCredentialsPage:{selector:n.credentialsPageSelector},getCredentialsPaginationToken:{selector:s.credentialsPaginationTokenSelector},getDashlaneDefinedLinkedWebsites:{selector:v.getDashlaneDefinedLinkedWebsitesSelector},getShouldShowRequireMasterPassword:{selector:c.shouldShowRequireMasterPasswordSelector}},liveQueries:{liveCanUserAddNewCredential:{operator:S.canUserAddNewCredential$},liveCredentialLimitStatus:{operator:S.credentialLimitStatus$},liveCredential:{operator:S.getCredential$},liveCredentials:{operator:S.credentials$},liveCredentialsByDomain:{operator:S.credentialsByDomain$},liveCredentialsBatch:{operator:S.credentialsBatch$},liveCredentialsCount:{operator:S.credentialsCount$}}}},98760:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(83690),t)},39373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedCredentialsPassword=t.removeCredentialsWithQuarantinedSpaces=t.fixCredentialsWithMissingTitles=t.fixCredentialWithMissingTitle=void 0;const o=r(52578),a=r(89489),i=r(90073),n=r(37275);function s(e){return e.Title?e:Object.assign({},e,{Title:(0,i.getDomainForCredential)(e)})}t.fixCredentialWithMissingTitle=s,t.fixCredentialsWithMissingTitles=function(e){return e.map(s)},t.removeCredentialsWithQuarantinedSpaces=function(e,t){if(!e.spaces||0===e.spaces.length)return t;const r=[];return e.spaces.filter(o.isSpaceQuarantined).forEach((e=>{const a=e.details.info&&e.details.info.teamDomains?e.details.info.teamDomains:[];t.filter((e=>(0,o.isCredentialSmartCategorized)(e,a))).forEach((t=>{""!==t.SpaceId&&t.SpaceId===e.details.teamId&&r.push(t)}))})),t.filter((e=>!r.includes(e)))},t.handleLimitedSharedCredentialsPassword=function(e,t,r){const o=(0,n.getSharingDataWithCollections)(t),i=(0,a.getLimitedSharedItemIds)(t,o.collections,o.itemGroups,r);return e.map((e=>i[e.Id]?Object.assign({},e,{Password:"************",limitedPermissions:!0}):e))}},36439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countCredentials=void 0;const o=r(35893);t.countCredentials=(e,t,r,a)=>(0,o.filterData)(e,t,r,a).length},90073:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainForCredential=void 0;const o=r(21178);t.getDomainForCredential=e=>new o.ParsedURL(e.Url).getRootDomain()},52109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCredentialHandler=void 0;const o=r(92233),a=r(76496),i=r(23136),n=r(95623),s=r(70252);t.deleteCredentialHandler=async({sessionService:e,storeService:t,wsService:r,eventLoggerService:c},{credentialId:l})=>{try{if(!(await(0,a.deletePersonalDataItem)({storeService:t,wsService:r,eventLoggerService:c},l,{manualHealthUpdate:!0})).success)return Promise.resolve({success:!1});return(0,i.getDebounceSync)(t,e)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){const t=new Error(`[Credentials] - deleteCredentialHandler: ${e}`);return(0,s.sendExceptionLog)({error:t}),(0,n.logError)(t),Promise.resolve({success:!1})}}},39546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCredentialsInBulkHandler=void 0;const o=r(28354),a=r(92233),i=r(86392),n=r(10770),s=r(76496),c=r(23136),l=r(95623),d=r(70252);t.deleteCredentialsInBulkHandler=async(e,{credentialList:t})=>{const{sessionService:r,storeService:i,wsService:p,eventLoggerService:S,applicationModulesAccess:g}=e;try{let l=[];const d=(0,o.v4)(),m=t.map((e=>(0,s.deletePersonalDataItem)({storeService:i,wsService:p,eventLoggerService:S,applicationModulesAccess:g},e,{multiSelectId:d,manualHealthUpdate:!0}).then((t=>({...t,itemId:e})))));await Promise.all(m).then((e=>l=e.filter((e=>!e.success))));(0,c.getDebounceSync)(i,r)({immediateCall:!0},a.Trigger.Save);const y=t.filter((e=>!l.some((t=>t.itemId===e))));return u(y,g),(0,n.removeItemsFromCollectionsHandler)(e,{ids:y}),l.length>0?Promise.resolve({success:!1,notRemoved:l.length}):Promise.resolve({success:!0})}catch(e){const t=new Error(`[Credentials] - deleteCredentialsInBulkHandler: ${e}`);return(0,d.sendExceptionLog)({error:t}),(0,l.logError)(t),Promise.resolve({success:!1})}};const u=async(e,t)=>{const{commands:r}=t.createClients().vaultItemsCrud;return await r.emitTemporaryVaultItemEvent({ids:[...e],eventType:i.EventType.Deleted}),!0}},70853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredentialHandler=void 0;const o=r(95623),a=r(70252),i=r(88779);t.updateCredentialHandler=async function(e,t){const{storeService:r,sessionService:n,eventLoggerService:s,applicationModulesAccess:c}=e;try{return await(0,i.updateCredential)({storeService:r,sessionService:n,eventLoggerService:s,applicationModulesAccess:c},t),{success:!0}}catch(e){return(0,o.logError)(e),(0,a.sendExceptionLog)({error:e}),{success:!1}}}},23529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsDisplayTitles=void 0;const o=r(90073);t.getCredentialsDisplayTitles=function(e){const t=e.reduce(((e,t)=>{const{Id:r,Title:a}=t,i=a||(0,o.getDomainForCredential)(t);return e.concat([[r,i]])}),[]);return new Map(t)}},88542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewCredential=t.afterCredentialSaved=t.notifySharersCredentialUpdated=t.makeCredentialSpecificProps=t.makeNewCredential=t.makeUpdatedCredential=t.beforeCredentialChange=t.sharedFields=t.SaveFrom=void 0;const o=r(16516),a=r(50415),i=r(53576),n=r(21178),s=r(47975),c=r(87496),l=r(61923),d=r(48313),u=r(53);t.SaveFrom=(0,a.Enum)("MANUAL","SAVE_PASSWORD","DATACAPTURE","IMPORT");const p=r(70252),S=r(78163),g=r(43145),m=r(65968),y=r(83687),h=r(92307),v=r(90451),f=r(53576);t.sharedFields=["Email","Login","Note","OtpSecret","OtpUrl","Password","SecondaryLogin","Title","Url","UseFixedUrl","UserSelectedUrl","LinkedServices"];const A=(e,t)=>({...e,content:{...e.content,category:t}}),P=(0,o.defaultTo)("");function b(e,t){const r=t?.UserSelectedUrl??"",o=t?.UseFixedUrl??!1,a=t?.TrustedUrlGroup??[],n=e.origin===i.SaveOrigin.MANUAL,s=t?.Url!==e.content.url,l=(0,c.cleanUrlForPersonalData)(e.content.url,{keepQueryString:n}),d=n&&s?{UserSelectedUrl:l,UseFixedUrl:!0}:{UserSelectedUrl:r,UseFixedUrl:o};return{Url:l,TrustedUrlGroup:(0,c.getUpdatedTrustedUrlList)(a,l),...d}}async function w(e,t,r=(0,u.getUnixTimestamp)()){const{content:a}=e,{email:i,login:n,secondaryLogin:c}=(0,l.normalizeUsernames)(a.email,a.login,a.secondaryLogin),d={associated_domains:a.linkedWebsites?.addedByUser?.map((e=>({source:f.LinkedWebsiteSource.Manual,domain:e})))??[]},p=P(a.password),S=!t||t.Password!==p?{ModificationDatetime:r}:{},g=function(e,t){return({itemField:r,existingItemField:a,defaultValue:i})=>(0,o.isNil)(e[r])?t&&!(0,o.isNil)(t[a])?t[a]:i:e[r]}(a,t);return{AutoLogin:g({itemField:"autoLogin",existingItemField:"AutoLogin",defaultValue:!0}),AutoProtected:g({itemField:"protectWithMasterPassword",existingItemField:"AutoProtected",defaultValue:!1}),Category:g({itemField:"category",existingItemField:"Category",defaultValue:""}),Checked:g({itemField:"checked",existingItemField:"Checked",defaultValue:!1}),Email:i,Login:n,Note:g({itemField:"note",existingItemField:"Note",defaultValue:""}),Password:p,SecondaryLogin:c,Status:"ACCOUNT_NOT_VERIFIED",Strength:p?await(0,s.evaluatePasswordStrength)(p):0,SubdomainOnly:Boolean(a.onlyForThisSubdomain),Title:g({itemField:"title",existingItemField:"Title",defaultValue:""}),...b(e,t),OtpSecret:g({itemField:"otpSecret",existingItemField:"OtpSecret",defaultValue:void 0}),OtpUrl:g({itemField:"otpUrl",existingItemField:"OtpUrl",defaultValue:void 0}),LinkedServices:d,...S}}t.beforeCredentialChange=function(e,t){const r=t.credentialCategories,o=e.content.category;if(!o)return e;if(r.find((e=>e.Id===o)))return e;const a=r.find((e=>e.CategoryName===o));return A(e,a?a.Id:"")},t.makeUpdatedCredential=async function(e,t){const r=(0,u.getUnixTimestamp)(),o=await w(e,t,r);return{...t,...(0,S.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:r}),...o}},t.makeNewCredential=async function(e){const t=(0,u.getUnixTimestamp)(),r=await w(e,null,t);return function(e){const{Title:t,Url:r}=e;return{...e,Title:t||P(new n.ParsedURL(r).getRootDomain())}}({...(0,S.makeNewPersonalDataItemBase)(e,t),...r})},t.makeCredentialSpecificProps=w,t.notifySharersCredentialUpdated=async function(e,r,a,i){!(0,o.equals)((0,o.pick)(t.sharedFields,r),(0,o.pick)(t.sharedFields,a))&&await(0,S.notifySharersOnUpdate)(e,a,i).catch((e=>{const t=new Error(`[Sharing] - notifySharersCredentialUpdated: ${e}`);(0,p.sendExceptionLog)({error:t})}))},t.afterCredentialSaved=function(e,t){(0,g.associateGeneratedPasswordsToCredential)(e.getPersonalData().generatedPasswords,t).forEach((t=>{e.dispatch((0,d.saveGeneratedPassword)(t))}))},t.viewCredential=function(e,t,r,o,a,i,n){if(!e)return;const s=(0,y.getSharingStatusDetail)(o,t,r),c=(0,v.getIcon)(i),l=(0,h.getCategory)(a),d=(0,h.getSmartCategorizedSpace)(n);return(0,m.detailView)(s,l,c,d,e)}},73567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialLimitStatus$=t.canUserAddNewCredential$=t.credentialsByDomain$=t.credentials$=t.credentialsCount$=t.getCredential$=t.credentialsBatch$=void 0;const o=r(18948),a=r(3343),i=r(8777),n=r(7657),s=r(71806),c=r(61645),l=r(86685),d=r(78767),u=r(65950),p=r(35893),S=r(33627),g=r(55220);t.credentialsBatch$=e=>{const t=(0,p.parseToken)(e),r=(0,d.getViewedCredentialsBatchSelector)(t);return(0,o.pipe)((0,a.map)(r),(0,a.distinctUntilChanged)(S.sameBatch))};t.getCredential$=e=>{const t=(0,l.getViewedCredentialSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())};t.credentialsCount$=e=>{const t=(0,p.parseToken)(e);return(0,o.pipe)((0,a.map)((e=>(0,s.credentialsCountSelector)(e,t))),(0,a.distinctUntilChanged)())},t.credentials$=(0,g.getLivePersonalInfo)(c.getLiveCredentialsSelector);t.credentialsByDomain$=e=>{const{domain:t,...r}=(0,p.parseToken)(e),i=(0,u.getLiveCredentialsByDomainSelector)(t)(r);return(0,o.pipe)((0,a.map)(i),(0,a.distinctUntilChanged)(((e,t)=>e.matchingCount===t.matchingCount&&(0,S.sameBatch)(e.items,t.items))))};t.canUserAddNewCredential$=()=>(0,o.pipe)((0,a.map)(i.canUserAddNewCredentialSelector),(0,a.distinctUntilChanged)());t.credentialLimitStatus$=()=>(0,o.pipe)((0,a.map)(n.credentialLimitStatusSelector),(0,a.distinctUntilChanged)())},94687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMappers=void 0;const o=r(16516),a=r(83539),i=r(71646),n=(0,o.curry)(((e,t)=>e.get(t.Id)||"")),s=e=>!!e.Attachments&&e.Attachments.length>0,c=(0,o.curry)(((e,t)=>!!e[t.Id])),l=(0,o.curry)(((e,t)=>{const r=t.Category,o=(e||[]).find((e=>e.Id===r));return o&&o.CategoryName?o.CategoryName:"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"}));t.getCredentialMappers=(e,t,r,o,d,u)=>({category:l(e),groupIds:e=>(0,i.getItemUserGroupIds)(o,e.Id),sharingUserIds:e=>(0,i.getItemUserIds)(o,e.Id),hasAttachments:s,id:e=>e.Id,isLimited:c(t),lastUse:a.lastUseMapper,login:e=>e.Login,numberUse:e=>e.NumberUse,spaceId:e=>e.SpaceId,title:n(r),email:e=>e.Email,collectionIds:e=>((e,t,r)=>t.flatMap((t=>t.VaultItems.some((t=>t.Id===e))?t.Id:[])).concat(r.flatMap((t=>t.vaultItems.some((t=>t.id===e))?t.id:[]))))(e.Id,d,u)})},25501:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsBatch=t.viewCredentialsBatch=t.getCredentialsFirstToken=t.getCredentialsSortToken=t.getCredentialsFilterToken=void 0;const o=r(16516),a=r(20553),i=r(29179),n=r(83687),s=r(92307),c=r(90451);t.getCredentialsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getCredentialsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getCredentialsFirstToken=(e,t,r,o)=>(0,a.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewCredentialsBatch=(e,t,r,o,a)=>{const l=(0,n.getSharingStatusItem)(t,r),d=(0,c.getIcon)(a),u=(0,s.getCategory)(o);return(0,i.listView)(l,u,d,e)},t.getCredentialsBatch=(0,o.curry)(((e,t,r)=>(0,a.getBatch)(r,e,t)))},31400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMatch=void 0;const o=r(64455),a=r(82234),i=r(6205),n=r(10770);t.getCredentialMatch=(e,t)=>(0,o.match)(((e,t)=>[(0,a.stringProp)("Email"),(0,a.stringProp)("Login"),(0,a.stringProp)("Title"),(0,a.stringProp)("Note"),(0,a.stringProp)("SecondaryLogin"),null===e&&null===t?(0,a.stringProp)("CategoryName"):r=>(0,n.getCollectionNamesContainingVaultItemId)(r.Id,e,t).join(" "),e=>(0,i.getDashlaneDefinedLinkedWebsites)(e.Url).join(" "),e=>(0,i.getUserAddedLinkedWebsitesRootDomains)(e).join(" ")])(e,t))},8777:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canUserAddNewCredentialSelector=void 0;const o=r(32034),a=r(7657),i=r(37148);t.canUserAddNewCredentialSelector=(0,o.createSelector)(a.credentialLimitStatusSelector,(e=>e!==i.CredentialLimitStatus.AtOrAboveLimit))},74380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countAllCredentialsSelector=void 0;t.countAllCredentialsSelector=e=>e.userSession.personalData.credentials.length},79895:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialCategoriesSelector=t.credentialCategoryNamesMapSelector=t.credentialCategoriesSelector=void 0;const o=r(32034),a=r(71120);t.credentialCategoriesSelector=e=>e.userSession.personalData.credentialCategories,t.credentialCategoryNamesMapSelector=(0,o.createSelector)([t.credentialCategoriesSelector],(e=>e.reduce(((e,t)=>(e[t.Id]=t.CategoryName,e)),{}))),t.viewedCredentialCategoriesSelector=(0,o.createSelector)(t.credentialCategoriesSelector,(e=>({items:(0,a.listView)(e),matchingCount:e.length})))},85505:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialMatchSelector=void 0;const o=r(53626),a=r(31400),i=r(31607);t.credentialMatchSelector=e=>{const t=(0,i.sharedCollectionsWithItemsSelector)(e),r=(0,o.collectionsSelector)(e);return(0,a.getCredentialMatch)(r,t)}},19736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSelector=void 0;const o=r(51319),a=r(49551);t.credentialSelector=(e,t)=>{const r=(0,o.credentialsSelector)(e);return(0,a.findDataModelObject)(t,r)}},88083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsByDomainSelector=t.getCredentialByDomainMatchType=t.DomainMatchType=void 0;const o=r(32034),a=r(21178),i=r(51319),n=r(6205);var s;!function(e){e.MainWebsite="MainWebsite",e.DashlaneDefinedLinkedWebsite="DashlaneDefinedLinkedWebsite",e.UserDefinedLinkedWebsite="UserDefinedLinkedWebsite",e.None="None"}(s=t.DomainMatchType||(t.DomainMatchType={}));t.getCredentialByDomainMatchType=(e,t)=>{if(!e)return s.None;return e===new a.ParsedURL(t.Url).getRootDomain()?s.MainWebsite:(0,n.getDashlaneDefinedLinkedWebsites)(t.Url).includes(e)?s.DashlaneDefinedLinkedWebsite:(0,n.getUserAddedLinkedWebsitesRootDomains)(t).includes(e)?s.UserDefinedLinkedWebsite:s.None};t.getCredentialsByDomainSelector=e=>(0,o.createSelector)(i.credentialsSelector,(r=>((e,r)=>e.filter((e=>{const o=(0,t.getCredentialByDomainMatchType)(r,e);return[s.MainWebsite,s.DashlaneDefinedLinkedWebsite,s.UserDefinedLinkedWebsite].includes(o)})))(r,e)))},71806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsCountSelector=void 0;const o=r(32034),a=r(49960),i=r(51319),n=r(85505),s=r(36439),c=r(7439);t.credentialsCountSelector=(0,o.createSelector)(a.fieldMappersSelector,n.credentialMatchSelector,c.filterTokenSelector,i.credentialsSelector,s.countCredentials)},60463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialDisplayTitlesSelector=void 0;const o=r(32034),a=r(51319),i=r(23529);t.credentialDisplayTitlesSelector=(0,o.createSelector)(a.credentialsSelector,i.getCredentialsDisplayTitles)},7657:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialLimitStatusSelector=void 0;const o=r(32034),a=r(37148),i=r(51319),n=r(16593);t.credentialLimitStatusSelector=(0,o.createSelector)(n.nodePremiumStatusSelector,i.credentialsSelector,((e,t)=>{if(!e||!e.capabilities)return a.CredentialLimitStatus.AtOrAboveLimit;if(!e.capabilities?.passwordsLimit?.enabled)return a.CredentialLimitStatus.Unlimited;const r=t.length,o=e.capabilities?.passwordsLimit?.info?.limit;return r>=o?a.CredentialLimitStatus.AtOrAboveLimit:r>=o-5?a.CredentialLimitStatus.NearLimit:a.CredentialLimitStatus.UnderLimit}))},10043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPageSelector=void 0;const o=r(20553),a=r(35893),i=r(49960),n=r(9365),s=r(51443);t.credentialsPageSelector=(e,t)=>{const r=(0,a.parseToken)(t),{sortToken:c,filterToken:l}=r,d={sortToken:c,filterToken:l},u=(0,i.fieldMappersSelector)(e),p=(0,n.credentialsQuerySelector)(e,d),S=(0,s.listViewSelector)(e),g=(0,o.generateNextToken)(u,r,p),m=(0,o.generatePrevToken)(u,r,p),y=(0,o.getBatch)(u,r,p),h=(0,a.stringifyToken)(g),v=(0,a.stringifyToken)(m);return{batch:S(y),nextToken:h,prevToken:v}}},35410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPaginationTokenSelector=void 0;const o=r(25501),a=r(49960),i=r(9365),n=r(35893);t.credentialsPaginationTokenSelector=(e,t)=>{const r=(0,o.getCredentialsSortToken)(t),s=(0,o.getCredentialsFilterToken)(t),c=(0,a.fieldMappersSelector)(e),l={sortToken:r,filterToken:s},d=(0,i.credentialsQuerySelector)(e,l),u=(0,o.getCredentialsFirstToken)(c,l,t,d);return(0,n.stringifyToken)(u)}},9365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsQuerySelector=void 0;const o=r(32034),a=r(49960),i=r(7439),n=r(92897),s=r(51319),c=r(85505),l=r(35893);t.credentialsQuerySelector=(0,o.createSelector)(a.fieldMappersSelector,c.credentialMatchSelector,n.sortTokenSelector,i.filterTokenSelector,s.credentialsSelector,l.queryData)},51319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsSelector=void 0;const o=r(32034),a=r(83659),i=r(92888),n=r(57989),s=r(40602),c=r(79895),l=(0,o.createSelector)([e=>(0,i.hasCredentialsDedupViewSelector)(e)?(0,i.dedupedCredentialsSelector)(e):(0,a.unsafeAllCredentialsSelector)(e),c.credentialCategoryNamesMapSelector],((e,t)=>e.map((e=>({...e,CategoryName:t[e.Category]})))));t.credentialsSelector=(0,o.createSelector)(l,n.quarantinedSpacesSelector,s.filterOutQuarantinedItems)},92888:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasCredentialsDedupViewSelector=t.dedupedCredentialsSelector=void 0;const o=r(32034),a=r(53682),i=r(66982),n=r(83659),s={Alias:i.genericMerge,Attachments:i.concatMerge,AutoLogin:i.strictEqual,AutoProtected:i.boolEqual,Category:i.genericMerge,Checked:i.strictEqual,ConnectionOptions:i.genericMerge,CreationDatetime:i.minMerge,Email:i.strictEqual,LastUse:i.maxMerge,LinkedServices:i.strictEqual,Login:i.strictEqual,ModificationDatetime:i.maxMerge,Note:i.genericMerge,NumberUse:i.sumMerge,OtpSecret:i.strictEqual,OtpUrl:i.strictEqual,Password:i.strictEqual,Port:i.genericMerge,SID:i.genericMerge,SecondaryLogin:i.strictEqual,Server:i.genericMerge,SharedObject:i.strictEqual,SpaceId:i.strictEqual,Status:i.strictEqual,Strength:i.strictEqual,SubdomainOnly:i.boolEqual,Title:i.strictEqual,TrustedUrlGroup:i.concatMerge,Url:i.strictEqual,UseFixedUrl:i.strictEqual,UserModificationDatetime:i.maxMerge,UserSelectedUrl:i.strictEqual,kwType:i.strictEqual,limitedPermissions:i.strictEqual};t.dedupedCredentialsSelector=(0,o.createSelector)(n.unsafeAllCredentialsSelector,(0,a.dedupItems)(["Password","Title","Url"],s));t.hasCredentialsDedupViewSelector=e=>e.userSession.credentialsDedupViewState.credentialsDedupView},49960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldMappersSelector=void 0;const o=r(32034),a=r(94687),i=r(79895),n=r(60463),s=r(91210),c=r(89698),l=r(10770),d=r(31607);t.fieldMappersSelector=(0,o.createSelector)(i.credentialCategoriesSelector,s.limitedSharingItemsSelector,n.credentialDisplayTitlesSelector,c.acceptedItemGroupsSelector,l.collectionsSelector,d.sharedCollectionsWithItemsSelector,a.getCredentialMappers)},7439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterTokenSelector=void 0;const o=r(16516),a=r(35893);t.filterTokenSelector=(0,a.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity)},8766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDashlaneDefinedLinkedWebsitesSelector=void 0;const o=r(6205);t.getDashlaneDefinedLinkedWebsitesSelector=(e,t)=>(0,o.getDashlaneDefinedLinkedWebsites)(t)},65950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsByDomainSelector=void 0;const o=r(97006),a=r(51443),i=r(49960),n=r(85505),s=r(88083);t.getLiveCredentialsByDomainSelector=e=>(0,o.makeLiveSelectorGetter)((0,s.getCredentialsByDomainSelector)(e),a.listViewSelector,n.credentialMatchSelector,i.fieldMappersSelector)},61645:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsSelector=void 0;const o=r(97006),a=r(51319),i=r(51443),n=r(49960),s=r(85505);t.getLiveCredentialsSelector=(0,o.makeLiveSelectorGetter)(a.credentialsSelector,i.listViewSelector,s.credentialMatchSelector,n.fieldMappersSelector)},80920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowRequireMasterPasswordSelector=void 0;const o=r(38981);t.shouldShowRequireMasterPasswordSelector=e=>!(0,o.isSSOUserSelector)(e)},86685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialSelector=void 0;const o=r(32034),a=r(52102),i=r(91210),n=r(51319),s=r(79895),c=r(91892),l=r(16593),d=r(49551),u=r(7944),p=r(88542);t.getViewedCredentialSelector=e=>{const t=(0,o.createSelector)(n.credentialsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,o.createSelector)(t,a.sharingDataSelector,l.userIdSelector,i.limitedSharingItemsSelector,s.credentialCategoriesSelector,c.iconsSelector,u.spacesSelector,p.viewCredential)}},78767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialsBatchSelector=void 0;const o=r(32034),a=r(91210),i=r(80993),n=r(79895),s=r(9365),c=r(49960),l=r(91892),d=r(25501),u=r(35893);t.getViewedCredentialsBatchSelector=e=>{const{sortToken:t,filterToken:r}=e,p={sortToken:t,filterToken:r},S=(0,d.getCredentialsBatch)(e),g=(0,o.createSelector)((e=>(0,s.credentialsQuerySelector)(e,p)),c.fieldMappersSelector,S),m=(0,u.optimizeBatchSelector)(g);return(0,o.createSelector)(m,i.sortedSharedItemIdsSelector,a.limitedSharingItemsSelector,n.credentialCategoriesSelector,l.iconsSelector,d.viewCredentialsBatch)}},51443:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listViewSelector=void 0;const o=r(32034),a=r(25501),i=r(80993),n=r(91210),s=r(79895),c=r(91892);t.listViewSelector=(0,o.createSelector)(i.sortedSharedItemIdsSelector,n.limitedSharingItemsSelector,s.credentialCategoriesSelector,c.iconsSelector,((e,t,r,o)=>i=>(0,a.viewCredentialsBatch)(i,e,t,r,o)))},19325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryByDomainSelector=void 0;const o=r(24589),a=r(49960),i=r(85505),n=r(88083);t.getQueryByDomainSelector=e=>(0,o.getQuerySelector)((0,n.getCredentialsByDomainSelector)(e),i.credentialMatchSelector,a.fieldMappersSelector)},41841:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.querySelector=void 0;const o=r(24589),a=r(51319),i=r(49960),n=r(85505);t.querySelector=(0,o.getQuerySelector)(a.credentialsSelector,n.credentialMatchSelector,i.fieldMappersSelector)},92897:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortTokenSelector=void 0;const o=r(16516),a=r(35893);t.sortTokenSelector=(0,a.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity)},83659:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeAllCredentialsSelector=void 0;t.unsafeAllCredentialsSelector=e=>e.userSession.personalData.credentials},60581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialSelector=void 0;const o=r(88542),a=r(91210),i=r(52102),n=r(19736),s=r(79895),c=r(16593),l=r(91892),d=r(7944);t.viewedCredentialSelector=(e,t)=>{const r=(0,n.credentialSelector)(e,t);if(!r)return;const u=(0,s.credentialCategoriesSelector)(e),p=(0,i.sharingDataSelector)(e),S=(0,c.userIdSelector)(e),g=(0,a.limitedSharingItemsSelector)(e),m=(0,l.iconsSelector)(e),y=(0,d.spacesSelector)(e);return(0,o.viewCredential)(r,p,S,g,u,m,y)}},28831:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsByDomainSelector=void 0;const o=r(19325),a=r(51443),i=r(63566);t.viewedQueriedCredentialsByDomainSelector=(e,t)=>{const{domain:r,...n}=t,s=(0,o.getQueryByDomainSelector)(r)(e,n),c=(0,a.listViewSelector)(e);return(0,i.viewListResults)(c)(s)}},66663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsSelector=void 0;const o=r(63566),a=r(41841),i=r(51443);t.viewedQueriedCredentialsSelector=(e,t)=>{const r=(0,a.querySelector)(e,t),n=(0,i.listViewSelector)(e);return(0,o.viewListResults)(n)(r)}},9763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCredential=t.createBaseCredentialModel=void 0;const o=r(16516),a=r(21178),i=r(53576),n=r(61923),s=r(13675),c=r(47975),l=r(78320),d=r(53),u=r(90771),p=r(23439),S=r(78163),g=r(23136);t.createBaseCredentialModel=(e=i.Country.NO_TYPE)=>{const t=(0,d.getUnixTimestamp)();return{kwType:"KWAuthentifiant",Id:(0,l.generateItemUuid)(),AnonId:(0,l.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,LocaleFormat:e}},t.createCredential=async function({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:d},m,y){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const h=await(0,g.getDefaultSpaceId)(d,e),v=(0,p.getUrlFields)(m.url,!0),{email:f,login:A,secondaryLogin:P}=(0,n.normalizeUsernames)(m.email,m.login,m.secondaryLogin),b=e.getPersonalData(),w=e.getPlatformInfo(),T=(0,p.getCategoryIdByName)(b,m.category),_=(0,o.defaultTo)("",m.password),I=(0,o.defaultTo)(h,m.spaceId),E=_?await(0,c.evaluatePasswordStrength)(_):0,C=y||(()=>({})),D=new a.ParsedURL(m.url).getRootDomain(),O=(0,s.sanitizeInputPersonalData)({...(0,t.createBaseCredentialModel)(i.Country[w.country]),AutoProtected:m.protectWithMasterPassword,Title:D,Email:f,Login:A,SubdomainOnly:m.onlyForThisSubdomain,SecondaryLogin:P,Password:_,Strength:E,Status:"ACCOUNT_NOT_VERIFIED",Category:T,SpaceId:I,AutoLogin:m.autoLogin??!0,...v,...C(m)});return(0,u.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:d},O),d&&(0,S.shouldSendCreateOrModifiedCredentialActivityLog)(e,d,O)&&await(0,S.computeAndSendCreatedCredentialActivityLog)(d,{domainUrl:O.Url}),{credentialId:O.Id}}},23439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlFields=t.getCategoryIdByName=void 0;const o=r(87496);t.getCategoryIdByName=(e,t)=>{const r=e.credentialCategories;if(!t)return"";if(r.find((e=>e.Id===t)))return t;const o=r.find((e=>e.CategoryName===t));return o?.Id};t.getUrlFields=(e,t,r)=>{const a=r?.Url!==e,i=(0,o.cleanUrlForPersonalData)(e,{keepQueryString:t}),n=t&&a?{UserSelectedUrl:i,UseFixedUrl:!0}:{UserSelectedUrl:r?.UserSelectedUrl??"",UseFixedUrl:r?.UseFixedUrl??!1};return{Url:i,TrustedUrlGroup:(0,o.getUpdatedTrustedUrlList)(r?.TrustedUrlGroup??[],i),...n}}},90771:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCredentialAsPersonalDataItem=void 0;const o=r(86392),a=r(92233),i=r(48313),n=r(12362),s=r(86691),c=r(56915),l=r(73566),d=r(85225),u=r(23136),p=r(88542),S=r(79980);t.saveCredentialAsPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:g},m,y){y&&(0,p.notifySharersCredentialUpdated)(e,y,m,g);const h=e.getPersonalData(),v=(0,l.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:h,change:(0,d.makeUpdateChange)(m),userLogin:e.getUserLogin(),platformInfo:(0,c.platformInfoSelector)(e.getState())});let f=null;const A=(0,n.getInstance)(),P=(0,s.getInstance)();try{f=P.lockTopic("iconsUpdates"),e.dispatch((0,i.savePersonalDataItem)(m,m.kwType,v)),await t.getInstance().user.persistPersonalData(),(0,p.afterCredentialSaved)(e,m);const n={type:"credentialUpdates",credentialIds:[m.Id]};await A.add("iconsUpdates",n),y?(0,S.logEditVaultItem)(e,r,m,y):(0,S.logAddVaultItem)(e,r,m);const{commands:s}=g.createClients().vaultItemsCrud;await s.emitTemporaryVaultItemEvent({ids:[m.Id],eventType:y?o.EventType.Updated:o.EventType.Created});(0,u.getDebounceSync)(e,t)({immediateCall:!0},a.Trigger.Save)}finally{f&&P.releaseTopic("iconsUpdates",f)}}},88779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredential=void 0;const o=r(19736),a=r(53),i=r(90771),n=r(23439),s=r(78163);t.updateCredential=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},l,d){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const u=e.getState(),p=(0,o.credentialSelector)(u,l.id);if(!p)throw new Error("Credential does not exist, cant update");const S=l.update.url?(0,n.getUrlFields)(l.update.url,l.update.isUrlSelectedByUser,p):{},g=d||(()=>({})),m={...p,...S,Password:void 0!==l.update.password?l.update.password:p.Password,Email:l.update.email??p.Email,Login:l.update.login??p.Login,Checked:void 0!==l.update.isExcludedFromHealth?l.update.isExcludedFromHealth:p.Checked,LinkedServices:l.update.linkedServices??p.LinkedServices,ModificationDatetime:(0,a.getUnixTimestamp)(),...g(l)};(0,i.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},m,p),c&&(0,s.shouldSendCreateOrModifiedCredentialActivityLog)(e,c,m)&&await(0,s.computeAndSendModifiedCredentialActivityLog)(c,{domainUrl:m.Url})}},83690:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialLimitStatus=void 0,function(e){e.Unlimited="unlimited",e.UnderLimit="underLimit",e.NearLimit="nearLimit",e.AtOrAboveLimit="atOrAboveLimit"}(t.CredentialLimitStatus||(t.CredentialLimitStatus={}))},38786:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAmazonWebsite=void 0;const o=r(21178);t.isAmazonWebsite=e=>"amazon"===new o.ParsedURL(e).getRootDomainName()},87496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedTrustedUrlList=t.cleanUrlForPersonalData=t.getBestUrl=t.getFirstTrustedUrl=t.getBaseTrustedUrls=void 0;const o=r(51121),a=r(16516),i=r(21178),n=r(38786),s=r(53),c=e=>new i.ParsedURL(e).getUrlWithFallbackHttpsProtocol(),l=(0,a.compose)((e=>{const{protocol:t,hostname:r,port:a}=(0,o.parse)(e);return t&&/^https?:/.test(t)?(0,o.format)({protocol:t,hostname:r,port:a}):null}),c,a.trim),d=e=>!(0,a.isNil)(e);t.getBaseTrustedUrls=(0,a.compose)((e=>e.filter(d)),(0,a.map)(l),(0,a.map)((0,a.defaultTo)("")),(0,a.map)((0,a.prop)("TrustedUrl")),(0,a.defaultTo)([]));t.getFirstTrustedUrl=e=>(0,a.defaultTo)("")((0,a.head)((0,t.getBaseTrustedUrls)(e.TrustedUrlGroup)));function u(e,t){if(!e)return"";if((0,n.isAmazonWebsite)(e))return e;let r=e;return{keepQueryString:!1,...t}.keepQueryString||(r=function(e){const t=e.indexOf("?");return t>-1?e.slice(0,t):e}(r)),c(r)}t.getBestUrl=e=>{const r=(o=e).UseFixedUrl&&o.UserSelectedUrl?o.UserSelectedUrl:null;var o;return r&&r.length?r:e.Url&&e.Url.length?e.Url:(0,t.getFirstTrustedUrl)(e)},t.cleanUrlForPersonalData=u,t.getUpdatedTrustedUrlList=function(e,t){const r=u(t),o=new i.ParsedURL(r).getRootDomain(),a=(e||[]).filter((e=>new i.ParsedURL(e.TrustedUrl).getRootDomain()===o));if(a.some((e=>e.TrustedUrl===r)))return a;const n=a.length>=20?a.length-20+1:0;return a.slice(n).concat({TrustedUrl:r,TrustedUrlExpire:(0,s.getUnixTimestamp)().toString()})}},61923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeUsernames=void 0;const o=r(16516),a=r(28445);t.normalizeUsernames=function(e,t,r){const i=(0,o.defaultTo)("");let n=e,s=t;return(0,a.looksLikeEmail)(t)?(n=t,(0,a.looksLikeEmail)(e)?(n=e,s=""):s=e):(0,a.looksLikeEmail)(e)||((0,o.isEmpty)(e)||(s=e),(0,a.looksLikeEmail)(t)?n=t:((0,o.isEmpty)(t)||(s=t),n="")),{email:i(n),login:i(s),secondaryLogin:i(r)}}},71120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const o=(0,r(16516).defaultTo)("");t.detailView=e=>{if(e)return{id:e.Id,categoryName:o(e.CategoryName)}};t.listView=e=>e.map(t.detailView)},65968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const o=r(16516),a=r(82043),i=r(71120),n=r(90073),s=r(6205),c=(0,o.defaultTo)(""),l=(0,o.defaultTo)(!1);t.detailView=(0,o.curry)(((e,t,r,o,d)=>{const u=t(d.Category),p=e(d.Id),S=r(d.Url),g=c(d.Password),m=o(d),y={addedByDashlane:(0,s.getDashlaneDefinedLinkedWebsites)(d.Url),addedByUser:(0,s.getUserAddedLinkedWebsiteDomains)(d)};return{...(0,a.dataModelDetailView)(d),autoLogin:d.AutoLogin||!1,autoProtected:l(d.AutoProtected),category:(0,i.detailView)(u),domainIcon:S,email:c(d.Email),forceCategorizedSpace:m,linkedWebsites:y,login:c(d.Login),note:c(d.Note),hasOtp:Boolean(d.OtpSecret)||Boolean(d.OtpUrl),otpSecret:c(d.OtpSecret),otpUrl:c(d.OtpUrl),password:g,secondaryLogin:d.SecondaryLogin,sharingStatus:p,strength:d.Strength||0,subdomainOnly:d.SubdomainOnly||!1,title:c(d.Title||(0,n.getDomainForCredential)(d)),url:c(d.Url||d.UserSelectedUrl)}}))},29179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=r(16516),a=r(82043),i=r(71120),n=r(90073),s=(0,o.defaultTo)("");t.itemView=(0,o.curry)(((e,t,r,c)=>{const l=t(c.Category);return{...(0,a.dataModelItemView)(c),autoProtected:(0,o.defaultTo)(!1,c.AutoProtected),category:(0,i.detailView)(l),domainIcon:r(c.Url),email:s(c.Email),login:s(c.Login),password:s(c.Password),sharingSatus:e(c.Id),title:s(c.Title||(0,n.getDomainForCredential)(c)),url:s(c.Url||c.UserSelectedUrl)}}));t.listView=(e,r,o,a)=>{const i=(0,t.itemView)(e,r,o);return a.map(i)}},19065:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataManagementController=void 0;const o=r(92233),a=r(35834),i=r(50886),n=r(76496),s=r(23136),c=r(84511),l=r(10770),d={immediateCall:!0};t.makeDataManagementController=e=>{const t=(0,s.getDebounceSync)(e.storeService,e.sessionService);return{savePaymentCardFromClient:r=>function(e,t,r){(0,a.savePaymentCard)(e,r),t(d,o.Trigger.Save)}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService},t,r),savePersonalDataItem:r=>async function(e,t,r){const{storeService:n,sessionService:s,eventLoggerService:l,applicationModulesAccess:u}=e;if("KWPaymentMean_creditCard"===r.kwType)return(0,a.savePaymentCard)({storeService:n,sessionService:s,eventLoggerService:l},r.content),t(d,o.Trigger.Save),Promise.resolve({success:!0,itemId:""});{const a=await(0,i.addPersonalDataItem)({storeService:n,sessionService:s,eventLoggerService:l,applicationModulesAccess:u},r),p=n.getState(),S=(0,c.isSharedSelector)(p,r.content.id);return"KWAuthentifiant"===r.kwType&&r.shouldSkipSync||(S?await e.sessionService.getInstance().user.attemptSync(o.Trigger.SettingsChange):t(d,o.Trigger.Save)),a}}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},t,r),removePersonalDataItem:r=>function(e,t,r,a){return(0,n.deletePersonalDataItem)(e,a).then((i=>(i.success&&(r(d,o.Trigger.Save),(0,l.removeItemsFromCollectionsHandler)({storeService:e.storeService,sessionService:t},{ids:[a]})),i)))}({storeService:e.storeService,wsService:e.wsService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},e.sessionService,t,r),updateMetadataItemFilledOnPage:(r,a,n)=>function(e,t,r,a,n){(0,i.updatePersonalDataUsageMetadata)(e,r,a,n),t({},o.Trigger.SaveMeta)}(e.storeService,t,r,a,n)}}},53682:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dedupItems=t.merge=void 0;t.merge=(e,t,r)=>{const o={};return Object.keys(r).every((a=>{const i=r[a](e[a],t[a]);return i.success&&(o[a]=i.result),i.success}))?{success:!0,result:{...e,...t,...o}}:{success:!1}};t.dedupItems=(e,r)=>o=>{const a=[],i={};for(const n of o){const o=e.reduce(((e,t)=>`${e}${n[t]}`),"");if(o in i){const e=i[o];let s=!1;for(const o of e){const e=a[o],i=(0,t.merge)(n,e,r);if(i.success){a[o]=i.result,s=!0;break}}s||(a.push(n),e.push(a.length-1))}else a.push(n),i[o]=[a.length-1]}return a}},66982:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.concatMerge=t.minMerge=t.maxMerge=t.sumMerge=t.genericMerge=t.boolEqual=t.strictEqual=void 0;t.strictEqual=(e,t)=>e===t?{success:!0,result:e}:{success:!1};t.boolEqual=(e,t)=>Boolean(e)===Boolean(t)?{success:!0,result:e}:{success:!1};t.genericMerge=(e,t)=>e===t?{success:!0,result:e}:e&&t?{success:!1}:{success:!0,result:e||t};const r=e=>(t,r)=>({success:!0,result:void 0===t&&void 0===r?void 0:e(t??0,r??0)});t.sumMerge=r(((e,t)=>e+t)),t.maxMerge=r(Math.max),t.minMerge=r(Math.min);t.concatMerge=(e,t)=>({success:!0,result:void 0===e&&void 0===t?void 0:[...e??[],...t??[]]})},45157:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoveChangeHistory=void 0;const o=r(73566),a=r(56915),i=r(16593),n=r(72678),s=r(85225);t.getRemoveChangeHistory=function(e,t){const r=e.getState(),c=(0,n.personalDataSelector)(r),l=(0,a.platformInfoSelector)(r),d=(0,i.userLoginSelector)(r),{localSettings:u}=e.getState().userSession,p=u.deviceName,S=(0,s.makeRemovalChange)(t);return(0,o.getUpdatedItemChangeHistory)({change:S,deviceName:p,personalData:c,userLogin:d,platformInfo:l})}},76496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePersonalDataItem=t.findPersonalDataItemToDelete=void 0;const o=r(16516),a=r(53576),i=r(58107),n=r(71646),s=r(95623),c=r(45291),l=r(45157),d=r(49551),u=r(70252),p=r(36884),S=r(36513),g=r(63698),m=r(90622),y=r(16593),h=r(76089),v=r(79980),f=r(92233),A=r(92310),P=r(78163),b=r(86392),w=["addresses","bankAccounts","companies","credentialCategories","credentials","driverLicenses","emails","fiscalIds","idCards","identities","noteCategories","notes","passports","paymentCards","paypalAccounts","personalWebsites","phones","secureFileInfo","socialSecurityIds"];function T(e,t){let r,a=0;const i=e.getPersonalData(),n=(0,o.pick)(w,i);for(const e of Object.keys(n))if(r=(0,d.findDataModelObject)(t,n[e]),r){a=n[e].length;break}return{itemToDelete:r,currentItemsCountForDataType:a}}t.findPersonalDataItemToDelete=T,t.deletePersonalDataItem=async function({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:o},d,w){const{FORBIDDEN_GROUP_ITEM:_,FORBIDDEN_LAST_ADMIN:I,INTERNAL_ERROR:E,LEAVE_SHARING_FAILED:C,NOT_AUTHORIZED:D,NOT_FOUND:O}=a.RemovePersonalDataItemFailureReason;let M=null;try{if(!e.isAuthenticated()){const e="No session available to delete personal item";return s.Debugger.log(e),{success:!1,reason:D,message:e}}const{itemToDelete:u}=T(e,d);if(!u){const e=`Unable to find personal item to delete: ${d}`;return s.Debugger.error(e),{success:!1,reason:O,message:e}}const E=(0,a.isCredential)(u);if(E||(0,a.isNote)(u)){const r=await(0,S.makeCryptoService)(),o=e.getUserLogin(),a=(0,m.ukiSelector)(e.getState()),{makeRefuseItemGroupEvent:s}=(0,p.makeItemGroupService)(t,r),{Id:c}=u,{userGroups:d,itemGroups:y}=e.getSharingData(),h=(0,n.findItemItemGroup)(c,y),v=w&&w.ignoreSharing;if(h&&!v){const e=(0,i.isUserLastAdmin)(h,o),t=(0,i.doesUserReceiveItemGroupViaGroup)(h,d,o);if(!(!e&&!t))return{success:!1,reason:e?I:_,message:"Unshare the item before deleting it"};try{const{groupId:e,revision:t}=h,{refuseItemGroup:r}=(0,g.makeItemGroupWS)(),i=s(e,t,null);await r(o,a,i)}catch(e){return{success:!1,reason:C,message:`${e}`}}}M=(0,l.getRemoveChangeHistory)(e,u)}(0,v.logDeleteVaultItem)(e,r,u,f.UpdateCredentialOrigin.Manual,w?.multiSelectId||null);const N=(0,c.removePersonalItem)(u.kwType,u.Id,M);if(e.dispatch(N),E){const t=e.getState();if((0,y.isOnboardingNotificationShowingSelector)(t)){const t=(0,h.webOnboardingModeReset)();e.dispatch(t)}}if(o&&E&&(0,P.hasVaultAuditLogsFFActivated)(o)){const t=(0,A.currentTeamIdSelector)(e.getState());u.SpaceId===t&&await(0,P.computeAndSendDeletedCredentialActivityLog)(o,{domainUrl:u.Url})}if(o&&!w?.manualHealthUpdate&&E){const{commands:e}=o.createClients().vaultItemsCrud;await e.emitTemporaryVaultItemEvent({ids:[u.Id],eventType:b.EventType.Deleted})}return{success:!0}}catch(e){const t=`[DataManagement] - deletePersonalDataItem: ${e}`,r=new Error(t);return(0,u.sendExceptionLog)({error:r}),{success:!1,reason:E,message:t}}}},57779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateNoteOrCredential=void 0;const o=r(53576),a=r(48313),i=r(78320),n=r(49551),s=r(12362),c=r(86691);t.duplicateNoteOrCredential=async function(e,t){let r=null;const l=(0,s.getInstance)(),d=(0,c.getInstance)(),{notes:u,credentials:p,changeHistories:S}=e.getPersonalData(),g=[...u,...p],m=(0,n.findDataModelObject)(t,g);if(!m)return null;const y=(0,i.generateItemUuid)(),h={...m,Id:y},v=S.find((e=>e.ObjectId.toUpperCase()===t.toUpperCase()));if((0,o.isCredential)(m)){r=d.lockTopic("iconsUpdates");const e={credentialIds:[y],type:"credentialUpdates"};await l.add("iconsUpdates",e)}const f=(0,a.savePersonalDataItem)(h,h.kwType,v);return e.dispatch(f),r&&d.releaseTopic("iconsUpdates",r),y}},75912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(57012),a=r(40086);t.config={commands:{getPersonalDataExport:{handler:o.getPersonalDataExport}},queries:{getIsForcedDomainsEnabled:{selector:a.isForcedDomainsEnabledSelector}},liveQueries:{}}},40086:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isForcedDomainsEnabledSelector=void 0;const o=r(16593);t.isForcedDomainsEnabledSelector=e=>{const t=(0,o.activeSpacesSelector)(e)[0];return t?.info?.forcedDomainsEnabled??!1}},24108:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsExport=void 0;const o=r(53576),a=r(92307),i=r(33553),n=r(28780),s=e=>e.reduce(((e,t)=>(t.VaultItems.filter((e=>e.Type===o.DataModelType.KWAuthentifiant)).map((e=>e.Id)).forEach((r=>{e[r]?e[r].push(t.Name):e[r]=[t.Name]})),e)),{}),c=(e,t,r,o)=>{const i=(0,a.getCategory)(e,t)?.CategoryName||"",n=r[o.Id];if(n?.length){const e=n.join(", ");return i?`${i}, ${e}`:e}return i};t.getCredentialsExport=function(e){const t=e.credentials,r=e.credentialCategories,o=e.collections,a=s(o),l=[{headerKey:"username",dataKey:"Email"},{headerKey:"username2",dataKey:"Login"},{headerKey:"username3",dataKey:"SecondaryLogin"},{headerKey:"title",dataKey:"Title"},{headerKey:"password",dataKey:"Password"},{headerKey:"note",dataKey:"Note"},{headerKey:"url",dataKey:"Url"},{headerKey:"category",dataKey:"Category"},{headerKey:"otpSecret",dataKey:"OtpSecret"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(l),(d=t,d.map((e=>{const t=[e.Email,e.Login,e.SecondaryLogin].filter((e=>void 0!==e&&""!==e)),[o="",n="",s=""]=t;return l.map((t=>{const l=e[t.dataKey]??"";if("Category"!==t.dataKey||""===l&&!a[e.Id]?.length){if("Email"===t.dataKey)return(0,i.handleSpecialCharacter)(o);if("Login"===t.dataKey)return(0,i.handleSpecialCharacter)(n);if("SecondaryLogin"===t.dataKey)return(0,i.handleSpecialCharacter)(s);if("Note"===t.dataKey&&""!==l)return(0,i.handleSpecialCharacter)(l);if("Password"===t.dataKey){const e=`${l}`;return(0,i.handleSpecialCharacter)(e)}{const e=`${l}`;return(0,i.handleSpecialCharacter)(e)}}{const t=c(r,l,a,e);return(0,i.handleSpecialCharacter)(t)}})).join(",")}))).join("\r\n")]);var d}},88096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCSVExport=void 0;const o=r(49267);o.configure({useWebWorkers:!1});const a=r(24108),i=r(31107),n=r(40549),s=r(8177),c=r(29375),l=[{filename:"credentials",generator:a.getCredentialsExport},{filename:"personalInfo",generator:c.getPersonalInfoExport},{filename:"securenotes",generator:i.getSecureNotesExport},{filename:"payments",generator:n.getPaymentsExport},{filename:"ids",generator:s.getIdsExport}],d=e=>new Promise(((t,r)=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{const e=o.result;e?t(e.toString()):r(new Error("Error creating CSV export."))}}));t.getCSVExport=async function(e){const t=new o.ZipWriter(new o.BlobWriter("application/zip")),r=[];for(const{filename:a,generator:i}of l){const n=i(e);r.push(t.add(`${a}.csv`,new o.BlobReader(new Blob([n],{type:"text/csv"}))))}await Promise.all(r);const a=await t.close();return await d(a)}},54130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDashlaneSecureExport=void 0;const o=r(16516),a=r(56668),i=r(61797);t.getDashlaneSecureExport=async function(e,t){const r=(0,o.join)(";",(0,o.pluck)("Id",t));t.forEach((e=>{delete e.Attachments}));const n=(0,i.getDashlaneXml)(t),s=(0,a.utf16ToDeflatedUtf8)(n),c=await e.encrypt(s);return(0,o.join)("\n",["-------------------- Dashlane Secured Export ----------------------","--------------------        Id BEGIN         ----------------------",r,"--------------------         Id END          ----------------------","--------------------       Data BEGIN        ----------------------",c,"--------------------        Data END         ----------------------","--------------------       Files BEGIN       ----------------------","--------------------        Files END        ----------------------\n"])}},8177:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdsExport=void 0;const o=r(72099),a=r(33553),i=r(28780);t.getIdsExport=function(e){const t=new Map;e.identities.forEach((e=>{t.set(e.Id,e)}));const r=e.idCards,n=e.passports,s=e.driverLicenses,c=e.socialSecurityIds,l=e.fiscalIds,d=[{headerKey:"type",dataKey:"type"},{headerKey:"number",dataKey:"Number"},{headerKey:"name",dataKey:"Fullname"},{headerKey:"issue_date",dataKey:"DeliveryDate"},{headerKey:"expiration_date",dataKey:"ExpireDate"},{headerKey:"place_of_issue",dataKey:"DeliveryPlace"},{headerKey:"state",dataKey:"State"}];return(0,i.formatDataToCSV)([(0,i.formatHeader)(d),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const i=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"card";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??i;return(0,a.handleSpecialCharacter)(e)}return(0,a.handleSpecialCharacter)(i)})).join(",")})))(e).join("\r\n"))(r),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const i=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"passport";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??i;return(0,a.handleSpecialCharacter)(e)}return(0,a.handleSpecialCharacter)(i)})).join(",")})))(e).join("\r\n"))(n),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const i=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"license";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??i;return(0,a.handleSpecialCharacter)(e)}return(0,a.handleSpecialCharacter)(i)})).join(",")})))(e).join("\r\n"))(s),(e=>(e=>e.map((e=>{const r=t.get(e.Id);return d.map((t=>{const i=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"social_security";if("Number"===t.dataKey){const t=e.SocialSecurityNumber;return(0,a.handleSpecialCharacter)(t)}if("Fullname"===t.dataKey){const t=r?(0,o.identityToName)(r):e.SocialSecurityFullname;return(0,a.handleSpecialCharacter)(t)}return(0,a.handleSpecialCharacter)(i)})).join(",")})))(e).join("\r\n"))(c),(e=>(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("tax_number");if("Number"===t.dataKey){const t=e.FiscalNumber;return(0,a.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(e).join("\r\n"))(l)])}},40549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentsExport=void 0;const o=r(33553),a=r(28780);t.getPaymentsExport=function(e){const t=e.bankAccounts,r=e.paymentCards,i=[{headerKey:"type",dataKey:"Type"},{headerKey:"account_name",dataKey:"BankAccountName"},{headerKey:"account_holder",dataKey:"BankAccountOwner"},{headerKey:"cc_number",dataKey:"CardNumber"},{headerKey:"code",dataKey:"SecurityCode"},{headerKey:"expiration_month",dataKey:"ExpireMonth"},{headerKey:"expiration_year",dataKey:"ExpireYear"},{headerKey:"routing_number",dataKey:"BankAccountBIC"},{headerKey:"account_number",dataKey:"BankAccountIBAN"},{headerKey:"country",dataKey:"LocaleFormat"},{headerKey:"issuing_bank",dataKey:"BankAccountBank"},{headerKey:"note",dataKey:"CCNote"},{headerKey:"name",dataKey:"Name"}];return(0,a.formatDataToCSV)([(0,a.formatHeader)(i),(s=t,(e=>e.map((e=>i.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,o.handleSpecialCharacter)("bank");{const e=`${r}`;return(0,o.handleSpecialCharacter)(e)}})).join(","))))(s).join("\r\n")),(n=r,(e=>e.map((e=>i.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,o.handleSpecialCharacter)("payment_card");if("BankAccountName"===t.dataKey){const t=e.OwnerName;return(0,o.handleSpecialCharacter)(t)}return(0,o.handleSpecialCharacter)(r)})).join(","))))(n).join("\r\n"))]);var n,s}},57012:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalDataExport=t.getFilteredPersonalData=t.filterNonExportableData=void 0;const o=r(53576),a=r(54130),i=r(61969),n=r(72365),s=r(65675),c=r(49901),l=r(91210),d=r(57989),u=r(40602),p=r(99281),S=r(16018),g=r(10770),m=r(80624),y=r(51319),h=r(79895),v=r(23437),f=r(9774),A=r(26147),P=r(41092),b=r(28074),w=r(75705),T=r(18665),_=r(65401),I=r(58235),E=r(81473),C=r(82439),D=r(27147),O=r(40086),M=r(88096),N="";t.filterNonExportableData=(e,t)=>{const r=(0,O.isForcedDomainsEnabledSelector)(e),a=(0,l.limitedSharingItemsSelector)(e);return t.filter((e=>{let t=!1;const i=!!a[e.Id]||!!e.limitedPermissions;return r&&(0,o.isDataModelObject)(e)&&(t=e.SpaceId!==c.PERSONAL_SPACE_ID),!t&&!i}))};const F=(e,r)=>{const o=(0,d.quarantinedSpacesSelector)(e);return(0,t.filterNonExportableData)(e,(0,u.filterOutQuarantinedItems)(r(e),o))};t.getFilteredPersonalData=e=>({addresses:F(e,p.addressesSelector),bankAccounts:F(e,S.bankAccountsSelector),collections:F(e,g.collectionsSelector),companies:F(e,m.companiesSelector),credentials:F(e,y.credentialsSelector),credentialCategories:(0,t.filterNonExportableData)(e,(0,h.credentialCategoriesSelector)(e)),driverLicenses:F(e,f.driverLicensesSelector),emails:F(e,A.emailsSelector),fiscalIds:F(e,P.fiscalIdsSelector),idCards:F(e,v.idCardsSelector),identities:F(e,b.identitiesSelector),notes:F(e,w.notesSelector),passkeys:F(e,T.passkeysSelector),passports:F(e,_.passportsSelector),paymentCards:F(e,I.paymentCardsSelector),personalWebsites:F(e,E.personalWebsitesSelector),phones:F(e,C.phonesSelector),socialSecurityIds:F(e,D.socialSecurityIdsSelector)}),t.getPersonalDataExport=async function(e,r){const{storeService:o}=e,c=o.getState(),{exportType:l,password:d}=r,u=(0,t.getFilteredPersonalData)(c);switch(l){case"csv":return{success:!0,response:{filename:"dashlane-credential-export.zip",content:await(0,M.getCSVExport)(u)}};case"secure-dashlane":{if(!d)return{success:!1,error:{code:i.GetPersonalDataExportErrorMessage.UNDEFINED_PASSWORD_ERROR}};const e=(0,n.makeDataEncryptorService)(o),t=(0,s.makeFlexibleMarkerCryptoConfig)("argon2d");e.setInstance({raw:d},N,t);const r=Object.values(u).flat().map((e=>({...e})));return{success:!0,response:{filename:"Dashlane Export.dash",content:await(0,a.getDashlaneSecureExport)(e.getInstance(),r)}}}default:return{success:!1,error:{code:i.GetPersonalDataExportErrorMessage.UNSUPPORTED_DATATYPE_ERROR}}}}},29375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalInfoExport=void 0;const o=r(33321),a=r(53576),i=r(33553),n=r(28780),s=e=>{const{LocaleFormat:t,Number:r}=e;if(!!t&&t!==a.Country.UNIVERSAL&&t!==a.Country.NO_TYPE&&(0,o.isSupportedCountry)(t)){const t=a.Country[e.LocaleFormat];return`+${(0,o.getCountryCallingCode)(t)}${r}`}return r};t.getPersonalInfoExport=function(e){const t=e.identities,r=e.emails,o=e.phones,a=e.addresses,c=e.companies,l=e.personalWebsites,d=[{headerKey:"type",dataKey:"type"},{headerKey:"title",dataKey:"Title"},{headerKey:"first_name",dataKey:"FirstName"},{headerKey:"middle_name",dataKey:"MiddleName"},{headerKey:"last_name",dataKey:"LastName"},{headerKey:"login",dataKey:"Pseudo"},{headerKey:"date_of_birth",dataKey:"BirthDate"},{headerKey:"place_of_birth",dataKey:"BirthPlace"},{headerKey:"email",dataKey:"Email"},{headerKey:"email_type",dataKey:"Type"},{headerKey:"item_name",dataKey:"Name"},{headerKey:"phone_number",dataKey:"Number"},{headerKey:"address",dataKey:"AddressFull"},{headerKey:"country",dataKey:"Country"},{headerKey:"state",dataKey:"State"},{headerKey:"city",dataKey:"City"},{headerKey:"zip",dataKey:"ZipCode"},{headerKey:"address_recipient",dataKey:"Receiver"},{headerKey:"address_building",dataKey:"Building"},{headerKey:"address_apartment",dataKey:"Door"},{headerKey:"address_floor",dataKey:"Floor"},{headerKey:"address_door_code",dataKey:"DigitCode"},{headerKey:"job_title",dataKey:"JobTitle"},{headerKey:"url",dataKey:"Website"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(d),(y=t,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("name");{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(y).join("\r\n")),(m=r,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("email");if("Type"===t.dataKey)return"PERSO"===r?(0,i.handleSpecialCharacter)("personal"):(0,i.handleSpecialCharacter)("business");if("Name"===t.dataKey){const t=e.EmailName??"";return(0,i.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(m).join("\r\n")),(g=o,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("number");if("Type"===t.dataKey)return(0,i.handleSpecialCharacter)("");if("Name"===t.dataKey){const t=e.PhoneName??"";return(0,i.handleSpecialCharacter)(t)}if("Number"===t.dataKey){const t=s(e);return(0,i.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(g).join("\r\n")),(S=a,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("address");if("Name"===t.dataKey){const t=e.AddressName??"";return(0,i.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(S).join("\r\n")),(p=c,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("company");{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(p).join("\r\n")),(u=l,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,i.handleSpecialCharacter)("website");{const e=`${r}`;return(0,i.handleSpecialCharacter)(e)}})).join(","))))(u).join("\r\n"))]);var u,p,S,g,m,y}},31107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecureNotesExport=void 0;const o=r(33553),a=r(28780);t.getSecureNotesExport=function(e){const t=e.notes,r=[{headerKey:"title",dataKey:"Title"},{headerKey:"note",dataKey:"Content"}];return(0,a.formatDataToCSV)([(0,a.formatHeader)(r),(e=>e.map((e=>r.map((t=>{const r=e[t.dataKey]??"";if("Content"===t.dataKey&&""!==r)return(0,o.handleSpecialCharacter)(r);{const e=`${r}`;return(0,o.handleSpecialCharacter)(e)}})).join(","))).join("\r\n"))(t)])}},33553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSpecialCharacter=void 0,t.handleSpecialCharacter=function(e){if(void 0===e)return"";if(e.match(/[,"\n\r]/g)){return['"',...e.split("").map((e=>'"'===e?'""':e)),'"'].join("")}return e}},28780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatDataToCSV=t.formatHeader=void 0;t.formatHeader=e=>e.map((e=>e.headerKey)).join(","),t.formatDataToCSV=function(e){return e.filter((e=>e.length>0)).join("\r\n")}},61969:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GetPersonalDataExportErrorMessage=void 0;!function(e){e.UNSUPPORTED_DATATYPE_ERROR="Unsupported Data Export Type",e.UNDEFINED_PASSWORD_ERROR="Undefined Password"}(t.GetPersonalDataExportErrorMessage||(t.GetPersonalDataExportErrorMessage={}))},3474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(92598),a=r(47205),i=r(11507);t.config={commands:{saveGeneratedPassword:{handler:a.saveGeneratedPasswordHandler}},queries:{getGeneratedPassword:{selector:o.viewedGeneratedPasswordSelector},getGeneratedPasswordsCount:{selector:o.countAllGeneratedPasswordsSelector},getGeneratedPasswords:{selector:o.viewedQueriedGeneratedPasswordsSelector},getGeneratedPasswordsPage:{selector:o.generatedPasswordsPageSelector},getGeneratedPasswordsPaginationToken:{selector:o.generatedPasswordsPaginationTokenSelector}},liveQueries:{liveGeneratedPasswordsCount:{operator:i.generatedPasswordCount$},liveGeneratedPasswords:{operator:i.generatedPasswords$}}}},25:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43145:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAssociatedCredential=t.associateGeneratedPasswordsToCredential=void 0;const o=r(90073);t.associateGeneratedPasswordsToCredential=function(e,t){return e.filter((e=>!e.AuthId&&e.Domain===(0,o.getDomainForCredential)(t)&&e.Password===t.Password)).map((e=>({...e,AuthId:t.Id})))},t.findAssociatedCredential=function(e,t){if(e?.AuthId)return(t||[]).find((t=>t.Id===e.AuthId))}},94170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneratedPassword=void 0;const o=r(53576),a=r(78320),i=r(53);t.createGeneratedPassword=({Id:e=(0,a.generateItemUuid)(),LastBackupTime:t=0,AuthId:r,Domain:n,GeneratedDate:s=(0,i.getUnixTimestamp)(),Password:c,SpaceId:l,Platform:d})=>({kwType:o.DataModelType.KWGeneratedPassword,AuthId:r,Domain:n,GeneratedDate:s,Id:e,SpaceId:l,Password:c,LastBackupTime:t,Platform:d})},47205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveGeneratedPasswordHandler=void 0;const o=r(44908);t.saveGeneratedPasswordHandler=async function(e,t){const{storeService:r,sessionService:a}=e;return(0,o.saveGeneratedPassword)(r,a,t.password,t.url)}},44908:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePassword=t.saveGeneratedPassword=t.generatePassword=t.fixIncoherentSettings=t.getDefaultPasswordGenerationSettings=t.passwordGeneratorDefaultSettings=t.associateGeneratedPasswordsToCredential=void 0;const o=r(28255),a=r(16516),i=r(85465),n=r(95623),s=r(78320),c=r(53),l=r(48313),d=r(70252),u=r(90503),p=r(94170),S=r(56915);var g=r(43145);function m(e){const r=(0,a.reject)((e=>(0,a.isNil)(e)||(0,a.isEmpty)(e)))({length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars});return y((0,a.merge)(t.passwordGeneratorDefaultSettings,r))}function y(e){return e.digits||e.letters||e.symbols||(e.digits=!0,e.letters=!0,e.symbols=!0),(void 0===e.length||e.length<1)&&(e.length=t.passwordGeneratorDefaultSettings.length),e}function h(e,t){const r=(0,a.isNil)(t)?m(e):y(t);if(!r.digits&&!r.letters&&r.symbols){const o=new Error("Should not generate password from symbols only"),a={length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars},i=`customSettings = ${JSON.stringify(t)}\npersonalSettingsGeneratorDefaults = ${JSON.stringify(a)}`;n.default.error(o),(0,d.sendExceptionLog)({error:o,code:u.ExceptionCriticality.WARNING,precisions:i}),r.digits=!0,r.letters=!0,r.symbols=!0}return(0,i.generate)(r)}function v(e,t,r,o){const a=(0,p.createGeneratedPassword)({Domain:o??"",GeneratedDate:(0,c.getUnixTimestamp)(),Id:(0,s.generateItemUuid)(),Password:r,LastBackupTime:0,Platform:(0,S.platformInfoSelector)(e.getState()).platformName});e.dispatch(l.saveGeneratedPassword(a)),t.getInstance().user.persistPersonalData()}Object.defineProperty(t,"associateGeneratedPasswordsToCredential",{enumerable:!0,get:function(){return g.associateGeneratedPasswordsToCredential}}),t.passwordGeneratorDefaultSettings={length:16,digits:!0,letters:!0,symbols:!0,avoidAmbiguous:!0},t.getDefaultPasswordGenerationSettings=m,t.fixIncoherentSettings=y,t.generatePassword=h,t.saveGeneratedPassword=v,t.generateAndSavePassword=function(e,t,r){if(!e.isAuthenticated())return n.default.log("No session available to generateAndSavePassword"),null;const a=h(e.getPersonalSettings());return o((()=>{v(e,t,a,r)})),a}},11507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswords$=t.generatedPasswordCount$=void 0;const o=r(92598),a=r(55220),i=r(18948),n=r(3343);t.generatedPasswordCount$=()=>(0,i.pipe)((0,n.map)(o.countAllGeneratedPasswordsSelector),(0,n.distinctUntilChanged)()),t.generatedPasswords$=(0,a.getLivePersonalInfo)(o.getLiveGeneratedPasswordsSelector)},91329:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGeneratedPasswordMappers=void 0;t.getGeneratedPasswordMappers=()=>({id:e=>e.Id,domain:e=>e.Domain,generatedDate:e=>e.GeneratedDate})},45853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewGeneratedPasswordsBatch=t.getGeneratedPasswordsFirstToken=t.getGeneratedPasswordsSortToken=t.getGeneratedPasswordsFilterToken=void 0;const o=r(20553),a=r(36407);t.getGeneratedPasswordsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getGeneratedPasswordsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getGeneratedPasswordsFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a);t.viewGeneratedPasswordsBatch=e=>(0,a.listView)(e)},9546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordMatch=t.searchGetters=void 0;const o=r(82234),a=r(64455);t.searchGetters=[(0,o.stringProp)("Domain")],t.generatedPasswordMatch=(0,a.match)(t.searchGetters)},92598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordsQuerySelector=t.generatedPasswordsPaginationTokenSelector=t.generatedPasswordsPageSelector=t.getLiveGeneratedPasswordsSelector=t.viewedQueriedGeneratedPasswordsSelector=t.queryGeneratedPasswordsSelector=t.getGeneratedPasswordMappersSelector=t.generatedPasswordMappersSelector=t.viewedGeneratedPasswordSelector=t.generatedPasswordSelector=t.generatedPasswordsSelector=t.countAllGeneratedPasswordsSelector=void 0;const o=r(16516),a=r(63566),i=r(36407),n=r(24589),s=r(9546),c=r(91329),l=r(45853),d=r(32034),u=r(35893),p=r(18948),S=r(20553),g=r(57989),m=r(97006),y=r(40602),h=r(83659),v=r(49551);t.countAllGeneratedPasswordsSelector=e=>e.userSession.personalData.generatedPasswords.length,t.generatedPasswordsSelector=(0,d.createSelector)((e=>e.userSession.personalData.generatedPasswords),g.quarantinedSpacesSelector,h.unsafeAllCredentialsSelector,y.filterOutQuarantinedItems);t.generatedPasswordSelector=(e,r)=>{const o=(0,t.generatedPasswordsSelector)(e);return(0,v.findDataModelObject)(r,o)};t.viewedGeneratedPasswordSelector=(e,r)=>{const o=(0,t.generatedPasswordSelector)(e,r);return(0,i.itemView)(o)};t.generatedPasswordMappersSelector=e=>(0,c.getGeneratedPasswordMappers)();const f=()=>s.generatedPasswordMatch,A=(0,c.getGeneratedPasswordMappers)();t.getGeneratedPasswordMappersSelector=()=>A,t.queryGeneratedPasswordsSelector=(0,n.getQuerySelector)(t.generatedPasswordsSelector,f,t.generatedPasswordMappersSelector),t.viewedQueriedGeneratedPasswordsSelector=(0,o.compose)((0,a.viewListResults)(i.listView),t.queryGeneratedPasswordsSelector),t.getLiveGeneratedPasswordsSelector=(0,m.makeLiveSelectorGetter)(t.generatedPasswordsSelector,(()=>i.listView),f,t.getGeneratedPasswordMappersSelector);t.generatedPasswordsPageSelector=(e,r)=>{const o=(0,u.parseToken)(r),{sortToken:a,filterToken:i}=o,n={sortToken:a,filterToken:i},s=(0,c.getGeneratedPasswordMappers)(),d=(0,t.generatedPasswordsQuerySelector)(e,n),p=(0,S.generateNextToken)(s,o,d),g=(0,S.generatePrevToken)(s,o,d),m=(0,S.getBatch)(s,o,d),y=(0,u.stringifyToken)(p),h=(0,u.stringifyToken)(g);return{batch:(0,l.viewGeneratedPasswordsBatch)(m),nextToken:y,prevToken:h}};t.generatedPasswordsPaginationTokenSelector=(e,r)=>{const o=(0,l.getGeneratedPasswordsSortToken)(r),a=(0,l.getGeneratedPasswordsFilterToken)(r),i=(0,c.getGeneratedPasswordMappers)(),n={sortToken:o,filterToken:a},s=(0,t.generatedPasswordsQuerySelector)(e,n),d=(0,l.getGeneratedPasswordsFirstToken)(i,n,r,s);return(0,u.stringifyToken)(d)};const P=(0,u.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),p.identity),b=(0,u.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),p.identity);t.generatedPasswordsQuerySelector=(0,d.createSelector)(c.getGeneratedPasswordMappers,f,P,b,t.generatedPasswordsSelector,u.queryData)},36407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=(0,r(16516).defaultTo)("");t.itemView=e=>({domain:o(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id,platform:e.Platform});t.listView=e=>e.map(t.itemView)},64185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyIconUrls=t.computeIconUrls=void 0;t.computeIconUrls=(e,t)=>t.reduce(((t,r)=>{const o=e.find((e=>e&&e.type===r));return t[r]=o?o.url:null,t}),{});t.makeEmptyIconUrls=e=>(0,t.computeIconUrls)([],e)},56814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFormattedDomainsFromUrls=t.decryptIconsDomains=void 0;const o=r(16516),a=r(21178),i=r(46445);t.decryptIconsDomains=(e,t)=>{const r=Array.from(e.keys()),o=new Map,a=t.reduce(((e,t)=>(e[(0,i.computeHashMD5)(t)]=t,e)),{});return r.forEach((t=>{const r=a[t];o.set(r,e.get(t))})),o};t.getFormattedDomainsFromUrls=e=>(0,o.uniq)(e.map((e=>new a.ParsedURL(e).getRootDomain()))).filter((e=>"string"==typeof e&&e.length))},44999:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const o=r(35949),a=r(23381);let i=null;t.setInstance=(e,t,r)=>(i=i||new o.IconsUpdater(t,e,new a.IconsWS(r)),i);t.getInstance=()=>i;t.clearInstance=()=>{i&&i.teardown(),i=null}},35949:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsUpdater=void 0;const o=r(18948),a=r(3343),i=r(28354),n=r(21342),s=r(19736),c=r(51319),l=r(95623),d=r(91892),u=r(16661),p=r(17825),S=r(19979),g=r(70252),m=r(541),y=r(58639),h=r(21726),v=r(41717);var f;!function(e){e.BreachesOperation="breachesOperation",e.CredentialsOperation="credentialsOperation",e.RefreshOperation="refreshOperation"}(f||(f={}));t.IconsUpdater=class{constructor(e,t,r){this.localStorageService=e,this.storeService=t,this.gateway=r,this._operation$=new o.Subject,this.subs=new Set,this.handleRefreshIcons=async()=>{const e=(0,i.v4)(),t=new Promise((t=>{const r=this._operationResults$.subscribe((o=>{o.id===e&&(t(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerRefreshOperation(e),await t},this.handleCredentialUpdates=async e=>{const t=(0,i.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((o=>{o.id===t&&(e(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerCredentialsOperation(t,e),await r},this.handleBreachesUpdates=async e=>{const t=(0,i.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((o=>{o.id===t&&(e(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerBreachesOperation(t,e),await r},this.triggerCredentialsOperation=(e,t,r=v.defaultIconTypes)=>{this._operation$.next({credentialIds:t,id:e,type:f.CredentialsOperation,iconTypes:r})},this.triggerBreachesOperation=(e,t,r=v.defaultIconTypes)=>{this._operation$.next({breachesIds:t,id:e,type:f.BreachesOperation,iconTypes:r})},this.triggerRefreshOperation=(e,t=v.defaultIconTypes)=>{this._operation$.next({id:e,type:f.RefreshOperation,iconTypes:t})},this.handleOperation=async(e,t)=>{const{type:r,id:o}=t,a={id:o,type:r},i=this.localStorageService.getInstance(),n=this.storeService.getState();try{return await e(t),await i.storeIcons((0,d.iconsCacheSelector)(n)),{...a,success:!0}}catch(e){const r=`[Icons Updater] - handle operation: operation ${t.type} failed with ${e}`;l.default.error(r);const o=new Error(r);return(0,g.sendExceptionLog)({error:o}),console.error(o),{...a,success:!1}}},this.onOperation=async e=>{switch(e.type){case f.CredentialsOperation:return this.handleOperation(((e,t)=>async({credentialIds:r,iconTypes:o})=>{const a=e.getState(),i=r.map((e=>(0,s.credentialSelector)(a,e))).filter((e=>!!e)),n=await(0,S.fetchIconsForCredentials)(a,t,i,o);e.dispatch((0,u.iconsUpdated)(n)),(0,h.default)()&&n.length>0&&(0,y.reportDataUpdate)(e)})(this.storeService,this.gateway),e);case f.BreachesOperation:return this.handleOperation(((e,t)=>async({breachesIds:r,iconTypes:o})=>{const a=e.getState(),i=r.map((e=>(0,n.breachSelector)(a,e))).filter((e=>!!e)),s=await(0,S.fetchIconsForBreaches)(a,t,i,o);e.dispatch((0,u.iconsUpdated)(s))})(this.storeService,this.gateway),e);case f.RefreshOperation:return this.handleOperation(((e,t)=>async({iconTypes:r})=>{const o=e.getState(),a=(0,d.iconsCacheSelector)(o);if((0,m.isIconsCacheValid)(a))return;const i=(0,c.credentialsSelector)(o),s=(0,n.breachesSelector)(o),l=await(0,S.fetchIconsForAllItems)(t,i,s,r);e.dispatch((0,u.iconsRefreshed)(l)),(0,h.default)()&&(0,y.reportDataUpdate)(e)})(this.storeService,this.gateway),e);default:return(0,p.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{const e=this._operation$.pipe((0,a.concatMap)(this.onOperation),(0,a.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}teardown(){this.subs.forEach((e=>e.unsubscribe()))}}},541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIconsCacheValid=void 0;const o=r(53),a=86400*(7+Math.random());t.isIconsCacheValid=e=>!(!e||!e.lastUpdateTimeSeconds)&&(0,o.getUnixTimestamp)()-e.lastUpdateTimeSeconds<a},41717:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIconTypes=void 0,t.defaultIconTypes=["46x30@2x","160x106@2x","118x98@2x"]},19979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchIconsForAllItems=t.fetchIconsForCredentials=t.getCredentialsWithWebsiteIcon=t.fetchIconsForBreaches=t.getIconsUrlsForBreaches=t.getIconsUrlsForCredentials=void 0;const o=r(16516),a=r(21178),i=r(56814),n=r(91892),s=r(64185);t.getIconsUrlsForCredentials=e=>e.map((e=>e.Url));t.getIconsUrlsForBreaches=e=>e.reduce(((e,t)=>{const r=t.Content.domains;return r&&0!==r.length?[...e,r[0]]:e}),[]);t.fetchIconsForBreaches=async(e,r,a,s)=>{const c=(0,t.getIconsUrlsForBreaches)(a),l=(0,i.getFormattedDomainsFromUrls)(c),d=(0,i.decryptIconsDomains)((0,n.iconsSelector)(e),l),u=Array.from(d.keys()),p=(0,o.difference)(l,u);return r.getIcons(p,s)};t.getCredentialsWithWebsiteIcon=(e,t,r)=>{const i={backgroundColor:null,mainColor:null,urls:(0,s.makeEmptyIconUrls)(r)};return e.map((e=>{const r=t.get(new a.ParsedURL(e.Url).getRootDomain()),n=(0,o.defaultTo)(i,r);return{...e,domainIcon:n}}))};t.fetchIconsForCredentials=async(e,r,a,s)=>{const c=(0,t.getIconsUrlsForCredentials)(a),l=(0,i.getFormattedDomainsFromUrls)(c),d=(0,i.decryptIconsDomains)((0,n.iconsSelector)(e),l),u=Array.from(d.keys()),p=(0,o.difference)(l,u);return r.getIcons(p,s)};t.fetchIconsForAllItems=async(e,r,o,a)=>{const n=[...(0,t.getIconsUrlsForBreaches)(o),...(0,t.getIconsUrlsForCredentials)(r)],s=(0,i.getFormattedDomainsFromUrls)(n);return e.getIcons(s,a)}},49352:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsUpdatesHook=void 0;const o=r(17825),a=r(44999);t.iconsUpdatesHook=async e=>{const t=(0,a.getInstance)();if(!t)return!1;switch(e.type){case"breachUpdates":return t.handleBreachesUpdates(e.breachesIds);case"credentialUpdates":return t.handleCredentialUpdates(e.credentialIds);case"refresh":return t.handleRefreshIcons();default:return(0,o.assertUnreachable)(e)}}},44816:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFetchedIcons=t.makeIconDataWithDomain=t.getDomainsIconsToBeFetched=t.getDomainIconsToBeFetched=void 0;const o=r(16516),a=r(64185),i=(0,o.defaultTo)(null);t.getDomainIconsToBeFetched=(e,t)=>t.reduce(((t,r)=>[...t,{domain:e,type:r}]),[]);t.getDomainsIconsToBeFetched=(e,r)=>e.reduce(((e,o)=>[...e,...(0,t.getDomainIconsToBeFetched)(o,r)]),[]);t.makeIconDataWithDomain=(e,t)=>{const r=(0,o.head)(e)||{};return{urls:(0,a.computeIconUrls)(e,t),backgroundColor:i(r.backgroundColor),mainColor:i(r.mainColor),domain:i(r.domain)}};t.formatFetchedIcons=(e,r,o)=>{const a=r.length;return[...Array(o)].reduce(((o,i,n)=>{const s=n*a,c=s+a,l=e.slice(s,c);return[...o,(0,t.makeIconDataWithDomain)(l,r)]}),[])}},23381:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsWS=void 0;const o=r(44816),a=r(32607);t.IconsWS=class{constructor(e){this.wsService=e}async getIcons(e,t){if(!e||!e.length)return[];const r=(0,o.getDomainsIconsToBeFetched)(e,t),i=await this.wsService.iconCrawler.getIcons(r);if(!(0,a.isWSResponseSuccess)(i)){const e=`[Icons] getIcons: ${i.message}(statusCode: ${i.code})`;throw new Error(e)}const{content:n}=i;return(0,o.formatFetchedIcons)(n,t,e.length)}}},90451:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=void 0;const o=r(21178),a=r(46445);t.getIcon=e=>t=>{const r=new o.ParsedURL(t).getRootDomain();if(!r)return;const i=(0,a.computeHashMD5)(r);return e.get(i)}},91892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsSelector=t.iconsCacheSelector=void 0;t.iconsCacheSelector=e=>e.userSession.iconsCache;t.iconsSelector=e=>(0,t.iconsCacheSelector)(e).domains},8566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(12362),a=r(86691),i=async()=>{const e=(0,o.getInstance)(),t=(0,a.getInstance)(),r=t.lockTopic("iconsUpdates");await e.add("iconsUpdates",{type:"refresh"}),t.releaseTopic("iconsUpdates",r)};t.setupSubscriptions=async function(e,t){e.syncSuccess.on((async()=>{await i()})),e.syncFailure.on((async()=>{await i()}))}},13648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(9774),a=r(53795),i=r(8302);t.config={commands:{addDriverLicense:{handler:i.addDriverLicenseHandler},editDriverLicense:{handler:i.editDriverLicenseHandler},deleteDriverLicense:{handler:i.deleteDriverLicenseHandler}},queries:{getDriverLicense:{selector:o.viewedDriverLicenseSelector},getDriverLicenses:{selector:o.viewedQueriedDriverLicensesSelector}},liveQueries:{liveDriverLicense:{operator:a.getDriverLicense$},liveDriverLicenses:{operator:a.driverLicenses$}}}},26655:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(78373),t)},60445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDriverLicenseHandler=void 0;const o=r(53576),a=r(72099),i=r(58452),n=({expirationDate:e,idNumber:t,issueDate:r,name:i,state:n})=>({DateOfBirth:"",DeliveryDate:(0,a.viewDateToVaultDate)(r),ExpireDate:(0,a.viewDateToVaultDate)(e),Fullname:i??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWDriverLicence,State:n??"",Sex:""});t.addDriverLicenseHandler=(e,t)=>(0,i.addIdHandler)(e,t,n)},38681:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteDriverLicenseHandler=void 0;const o=r(9979),a=r(9774);t.deleteDriverLicenseHandler=(e,t)=>(0,o.deleteIdHandler)(e,t,a.driverLicenseSelector)},63589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editDriverLicenseHandler=t.handleDriverLicenseFields=void 0;const o=r(9774),a=r(72099),i=r(22388);t.handleDriverLicenseFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,a.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,a.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,State:e.state??t.State,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editDriverLicenseHandler=(e,r)=>(0,i.updateIdHandler)(e,r,t.handleDriverLicenseFields,o.driverLicenseSelector)},8302:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(60445),t),a(r(63589),t),a(r(38681),t)},53795:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDriverLicense$=t.driverLicenses$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(9774);t.driverLicenses$=(0,i.getLivePersonalInfo)(n.getLiveDriverLicensesSelector);t.getDriverLicense$=e=>{const t=(0,n.getViewedDriverLicenseSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},91019:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDriverLicenseMappers=void 0;const o=r(83539),a=r(72099);t.getDriverLicenseMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,a.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},50317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.driverLicenseMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234),i=r(72099);t.searchGetters=[(0,a.stringProp)("Number"),e=>(0,i.identityToName)(e.identity)||e.Fullname],t.driverLicenseMatch=(0,o.match)(t.searchGetters)},9774:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedDriverLicenseSelector=t.viewedDriverLicenseSelector=t.getLiveDriverLicensesSelector=t.viewedQueriedDriverLicensesSelector=t.queryDriverLicensesSelector=t.driverLicenseWithIdentitySelector=t.driverLicensesWithIdentitySelector=t.driverLicenseMappersSelector=t.driverLicenseSelector=t.driverLicensesSelector=void 0;const o=r(16516),a=r(32034),i=r(50317),n=r(53506),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(91019),p=r(28074),S=r(40602),g=r(57989);t.driverLicensesSelector=(0,a.createSelector)((e=>e.userSession.personalData.driverLicenses),g.quarantinedSpacesSelector,S.filterOutQuarantinedItems);t.driverLicenseSelector=(e,r)=>{const o=(0,t.driverLicensesSelector)(e);return(0,d.findDataModelObject)(r,o)};t.driverLicenseMappersSelector=e=>(0,u.getDriverLicenseMappers)(),t.driverLicensesWithIdentitySelector=(0,a.createSelector)([t.driverLicensesSelector,p.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]}))))),t.driverLicenseWithIdentitySelector=(0,a.createSelector)([t.driverLicenseSelector,e=>(0,p.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));const m=()=>i.driverLicenseMatch;t.queryDriverLicensesSelector=(0,s.getQuerySelector)(t.driverLicensesWithIdentitySelector,m,t.driverLicenseMappersSelector),t.viewedQueriedDriverLicensesSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.queryDriverLicensesSelector),t.getLiveDriverLicensesSelector=(0,l.makeLiveSelectorGetter)(t.driverLicensesWithIdentitySelector,(()=>n.listView),m,t.driverLicenseMappersSelector);t.viewedDriverLicenseSelector=(e,r)=>{const o=(0,t.driverLicenseWithIdentitySelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedDriverLicenseSelector=e=>{const r=(0,a.createSelector)(t.driverLicensesSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,p.identitiesSelector,((e,t)=>(0,n.maybeDetailView)({...e,identity:(0,d.findDataModelObject)(e.LinkedIdentity,t)})))}},78373:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},53506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(82043),a=r(72099),i=({DeliveryDate:e,ExpireDate:t,Fullname:r,LocaleFormat:o,Number:i,State:n,CreationDatetime:s,identity:c})=>({country:(0,a.vaultCountryToViewCountry)(o),expirationDate:(0,a.vaultDateToViewDate)(t),idNumber:i??"",issueDate:(0,a.vaultDateToViewDate)(e),name:(0,a.identityToName)(c)||r||"",state:n??"",creationDate:s??0});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},15141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(41092),a=r(53076),i=r(32813);t.config={commands:{addFiscalId:{handler:i.addFiscalIdHandler},editFiscalId:{handler:i.editFiscalIdHandler},deleteFiscalId:{handler:i.deleteFiscalIdHandler}},queries:{getFiscalId:{selector:o.viewedFiscalIdSelector},getFiscalIds:{selector:o.viewedQueriedFiscalIdsSelector}},liveQueries:{liveFiscalId:{operator:a.getFiscalId$},liveFiscalIds:{operator:a.fiscalIds$}}}},26763:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(23582),t)},46033:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addFiscalIdHandler=void 0;const o=r(53576),a=r(58452),i=({idNumber:e,teledeclarantNumber:t})=>({FiscalNumber:e??"",kwType:o.DataModelType.KWFiscalStatement,TeledeclarantNumber:t??""});t.addFiscalIdHandler=(e,t)=>(0,a.addIdHandler)(e,t,i)},98167:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFiscalIdHandler=void 0;const o=r(9979),a=r(41092);t.deleteFiscalIdHandler=(e,t)=>(0,o.deleteIdHandler)(e,t,a.fiscalIdSelector)},9175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editFiscalIdHandler=t.handleFiscalIdFields=void 0;const o=r(41092),a=r(22388);t.handleFiscalIdFields=(e,t)=>({FiscalNumber:e.idNumber??t.FiscalNumber,TeledeclarantNumber:e.teledeclarantNumber??t.TeledeclarantNumber,Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editFiscalIdHandler=(e,r)=>(0,a.updateIdHandler)(e,r,t.handleFiscalIdFields,o.fiscalIdSelector)},32813:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(46033),t),a(r(9175),t),a(r(98167),t)},53076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFiscalId$=t.fiscalIds$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(41092);t.fiscalIds$=(0,i.getLivePersonalInfo)(n.getLiveFiscalIdsSelector);t.getFiscalId$=e=>{const t=(0,n.getViewedFiscalIdSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},42143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFiscalIdMappers=void 0;const o=r(83539);t.getFiscalIdMappers=()=>({spaceId:e=>e.SpaceId,idNumber:e=>e.FiscalNumber,teledeclarantNumber:e=>e.TeledeclarantNumber,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},91341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fiscalIdMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("FiscalNumber"),(0,a.stringProp)("TeledeclarantNumber")],t.fiscalIdMatch=(0,o.match)(t.searchGetters)},41092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedFiscalIdSelector=t.viewedFiscalIdSelector=t.getLiveFiscalIdsSelector=t.viewedQueriedFiscalIdsSelector=t.queryFiscalIdsSelector=t.fiscalIdMappersSelector=t.fiscalIdSelector=t.fiscalIdsSelector=void 0;const o=r(16516),a=r(32034),i=r(91341),n=r(22127),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(42143),p=r(40602),S=r(57989);t.fiscalIdsSelector=(0,a.createSelector)((e=>e.userSession.personalData.fiscalIds),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.fiscalIdSelector=(e,r)=>{const o=(0,t.fiscalIdsSelector)(e);return(0,d.findDataModelObject)(r,o)};t.fiscalIdMappersSelector=e=>(0,u.getFiscalIdMappers)();const g=()=>i.fiscalIdMatch;t.queryFiscalIdsSelector=(0,s.getQuerySelector)(t.fiscalIdsSelector,g,t.fiscalIdMappersSelector),t.viewedQueriedFiscalIdsSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.queryFiscalIdsSelector),t.getLiveFiscalIdsSelector=(0,l.makeLiveSelectorGetter)(t.fiscalIdsSelector,(()=>n.listView),g,t.fiscalIdMappersSelector);t.viewedFiscalIdSelector=(e,r)=>{const o=(0,t.fiscalIdSelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedFiscalIdSelector=e=>{const r=(0,a.createSelector)(t.fiscalIdsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,n.maybeDetailView)}},23582:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},22127:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(82043),a=r(72099),i=({FiscalNumber:e,TeledeclarantNumber:t,LocaleFormat:r,CreationDatetime:o})=>({country:(0,a.vaultCountryToViewCountry)(r),idNumber:e??"",teledeclarantNumber:t??"",creationDate:o??0});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},2282:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(23437),a=r(77849),i=r(17607);t.config={commands:{addIdCard:{handler:i.addIdCardHandler},editIdCard:{handler:i.editIdCardHandler},deleteIdCard:{handler:i.deleteIdCardHandler}},queries:{getIdCard:{selector:o.viewedIdCardSelector},getIdCards:{selector:o.viewedQueriedIdCardsSelector}},liveQueries:{liveIdCard:{operator:a.getIdCard$},liveIdCards:{operator:a.idCards$}}}},59198:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(97367),t)},38052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdCardHandler=void 0;const o=r(53576),a=r(72099),i=r(58452),n=({expirationDate:e,idNumber:t,issueDate:r,name:i})=>({DateOfBirth:"",DeliveryDate:(0,a.viewDateToVaultDate)(r),ExpireDate:(0,a.viewDateToVaultDate)(e),Fullname:i??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWIDCard,Sex:""});t.addIdCardHandler=(e,t)=>(0,i.addIdHandler)(e,t,n)},19922:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteIdCardHandler=void 0;const o=r(9979),a=r(23437);t.deleteIdCardHandler=(e,t)=>(0,o.deleteIdHandler)(e,t,a.idCardSelector)},84260:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editIdCardHandler=t.handleIdCardFields=void 0;const o=r(23437),a=r(72099),i=r(22388);t.handleIdCardFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,a.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,a.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editIdCardHandler=(e,r)=>(0,i.updateIdHandler)(e,r,t.handleIdCardFields,o.idCardSelector)},17607:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(38052),t),a(r(84260),t),a(r(19922),t)},77849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdCard$=t.idCards$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(23437);t.idCards$=(0,i.getLivePersonalInfo)(n.getLiveIdCardsSelector);t.getIdCard$=e=>{const t=(0,n.getViewedIdCardSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},75455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdCardMappers=void 0;const o=r(83539),a=r(72099);t.getIdCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,a.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},27062:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idCardMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234),i=r(72099);t.searchGetters=[(0,a.stringProp)("Number"),e=>(0,i.identityToName)(e.identity)||e.Fullname],t.idCardMatch=(0,o.match)(t.searchGetters)},23437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedIdCardSelector=t.viewedIdCardSelector=t.getLiveIdCardsSelector=t.viewedQueriedIdCardsSelector=t.queryIdCardsSelector=t.idCardMappersSelector=t.idCardWithIdentitySelector=t.idCardsWithIdentitySelector=t.idCardSelector=t.idCardsSelector=void 0;const o=r(16516),a=r(32034),i=r(27062),n=r(64439),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(75455),p=r(28074),S=r(40602),g=r(57989);t.idCardsSelector=(0,a.createSelector)((e=>e.userSession.personalData.idCards),g.quarantinedSpacesSelector,S.filterOutQuarantinedItems);t.idCardSelector=(e,r)=>{const o=(0,t.idCardsSelector)(e);return(0,d.findDataModelObject)(r,o)},t.idCardsWithIdentitySelector=(0,a.createSelector)([t.idCardsSelector,p.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]}))))),t.idCardWithIdentitySelector=(0,a.createSelector)([t.idCardSelector,e=>(0,p.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.idCardMappersSelector=e=>(0,u.getIdCardMappers)();const m=()=>i.idCardMatch;t.queryIdCardsSelector=(0,s.getQuerySelector)(t.idCardsWithIdentitySelector,m,t.idCardMappersSelector),t.viewedQueriedIdCardsSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.queryIdCardsSelector),t.getLiveIdCardsSelector=(0,l.makeLiveSelectorGetter)(t.idCardsWithIdentitySelector,(()=>n.listView),m,t.idCardMappersSelector);t.viewedIdCardSelector=(e,r)=>{const o=(0,t.idCardWithIdentitySelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedIdCardSelector=e=>{const r=(0,a.createSelector)(t.idCardsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,p.identitiesSelector,((e,t)=>(0,n.maybeDetailView)({...e,identity:(0,d.findDataModelObject)(e.LinkedIdentity,t)})))}},97367:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},64439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(82043),a=r(72099),i=({DeliveryDate:e,ExpireDate:t,Fullname:r,LocaleFormat:o,Number:i,CreationDatetime:n,identity:s})=>({country:(0,a.vaultCountryToViewCountry)(o),expirationDate:(0,a.vaultDateToViewDate)(t),idNumber:i??"",issueDate:(0,a.vaultDateToViewDate)(e),name:(0,a.identityToName)(s)||r||"",creationDate:n??0});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},8453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(65401),a=r(56174),i=r(62535);t.config={commands:{addPassport:{handler:i.addPassportHandler},editPassport:{handler:i.editPassportHandler},deletePassport:{handler:i.deletePassportHandler}},queries:{getPassport:{selector:o.viewedPassportSelector},getPassports:{selector:o.viewedQueriedPassportsSelector}},liveQueries:{livePassport:{operator:a.getPassport$},livePassports:{operator:a.passports$}}}},80666:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(97894),t)},57237:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPassportHandler=void 0;const o=r(53576),a=r(72099),i=r(58452),n=({expirationDate:e,idNumber:t,issueDate:r,name:i,deliveryPlace:n})=>({DateOfBirth:"",DeliveryDate:(0,a.viewDateToVaultDate)(r),ExpireDate:(0,a.viewDateToVaultDate)(e),Fullname:i??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWPassport,DeliveryPlace:n??"",Sex:""});t.addPassportHandler=(e,t)=>(0,i.addIdHandler)(e,t,n)},48518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePassportHandler=void 0;const o=r(9979),a=r(65401);t.deletePassportHandler=(e,t)=>(0,o.deleteIdHandler)(e,t,a.passportSelector)},29461:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editPassportHandler=t.handlePassportFields=void 0;const o=r(65401),a=r(72099),i=r(22388);t.handlePassportFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,a.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,a.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,DeliveryPlace:e.deliveryPlace??t.DeliveryPlace,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editPassportHandler=(e,r)=>(0,i.updateIdHandler)(e,r,t.handlePassportFields,o.passportSelector)},62535:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(57237),t),a(r(29461),t),a(r(48518),t)},56174:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPassport$=t.passports$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(65401);t.passports$=(0,i.getLivePersonalInfo)(n.getLivePassportsSelector);t.getPassport$=e=>{const t=(0,n.getViewedPassportSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},94023:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPassportMappers=void 0;const o=r(83539),a=r(72099);t.getPassportMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,a.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},39515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passportMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234),i=r(72099);t.searchGetters=[(0,a.stringProp)("Number"),e=>(0,i.identityToName)(e.identity)||e.Fullname],t.passportMatch=(0,o.match)(t.searchGetters)},65401:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPassportSelector=t.viewedPassportSelector=t.getLivePassportsSelector=t.viewedQueriedPassportsSelector=t.queryPassportsWithIdentitySelector=t.passportMappersSelector=t.passportWithIdentitySelector=t.passportsWithIdentitySelector=t.passportSelector=t.passportsSelector=void 0;const o=r(16516),a=r(32034),i=r(39515),n=r(90810),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(94023),p=r(28074),S=r(40602),g=r(57989);t.passportsSelector=(0,a.createSelector)((e=>e.userSession.personalData.passports),g.quarantinedSpacesSelector,S.filterOutQuarantinedItems);t.passportSelector=(e,r)=>{const o=(0,t.passportsSelector)(e);return(0,d.findDataModelObject)(r,o)},t.passportsWithIdentitySelector=(0,a.createSelector)([t.passportsSelector,p.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]}))))),t.passportWithIdentitySelector=(0,a.createSelector)([t.passportSelector,e=>(0,p.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.passportMappersSelector=e=>(0,u.getPassportMappers)();const m=()=>i.passportMatch;t.queryPassportsWithIdentitySelector=(0,s.getQuerySelector)(t.passportsWithIdentitySelector,m,t.passportMappersSelector),t.viewedQueriedPassportsSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.queryPassportsWithIdentitySelector),t.getLivePassportsSelector=(0,l.makeLiveSelectorGetter)(t.passportsWithIdentitySelector,(()=>n.listView),m,t.passportMappersSelector);t.viewedPassportSelector=(e,r)=>{const o=(0,t.passportWithIdentitySelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedPassportSelector=e=>{const r=(0,a.createSelector)(t.passportsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,p.identitiesSelector,((e,t)=>(0,n.maybeDetailView)({...e,identity:(0,d.findDataModelObject)(e.LinkedIdentity,t)})))}},97894:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},90810:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(82043),a=r(72099),i=({DeliveryDate:e,ExpireDate:t,Fullname:r,LocaleFormat:o,Number:i,DeliveryPlace:n,CreationDatetime:s,identity:c})=>({country:(0,a.vaultCountryToViewCountry)(o),expirationDate:(0,a.vaultDateToViewDate)(t),idNumber:i??"",issueDate:(0,a.vaultDateToViewDate)(e),name:(0,a.identityToName)(c)||r||"",deliveryPlace:n??"",creationDate:s??0});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},57718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(27147),a=r(25346),i=r(27753);t.config={commands:{addSocialSecurityId:{handler:i.addSocialSecurityIdHandler},editSocialSecurityId:{handler:i.editSocialSecurityIdHandler},deleteSocialSecurityId:{handler:i.deleteSocialSecurityIdHandler}},queries:{getSocialSecurityId:{selector:o.viewedSocialSecurityIdSelector},getSocialSecurityIds:{selector:o.viewedQueriedSocialSecurityIdsSelector}},liveQueries:{liveSocialSecurityId:{operator:a.getSocialSecurityId$},liveSocialSecurityIds:{operator:a.socialSecurityIds$}}}},80630:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(72299),t)},6702:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSocialSecurityIdHandler=void 0;const o=r(53576),a=r(58452),i=e=>({DateOfBirth:"",LinkedIdentity:"",SocialSecurityFullname:e.name??"",SocialSecurityNumber:e.idNumber??"",kwType:o.DataModelType.KWSocialSecurityStatement,Sex:""});t.addSocialSecurityIdHandler=(e,t)=>(0,a.addIdHandler)(e,t,i)},50725:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSocialSecurityIdHandler=void 0;const o=r(9979),a=r(27147);t.deleteSocialSecurityIdHandler=(e,t)=>(0,o.deleteIdHandler)(e,t,a.socialSecurityIdSelector)},96163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editSocialSecurityIdHandler=t.handleSocialSecurityIdFields=void 0;const o=r(27147),a=r(22388);t.handleSocialSecurityIdFields=(e,t)=>({SocialSecurityFullname:e.name??t.SocialSecurityFullname,SocialSecurityNumber:e.idNumber??t.SocialSecurityNumber,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editSocialSecurityIdHandler=(e,r)=>(0,a.updateIdHandler)(e,r,t.handleSocialSecurityIdFields,o.socialSecurityIdSelector)},27753:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(6702),t),a(r(96163),t),a(r(50725),t)},25346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSocialSecurityId$=t.socialSecurityIds$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(27147);t.socialSecurityIds$=(0,i.getLivePersonalInfo)(n.getLiveSocialSecurityIdsSelector);t.getSocialSecurityId$=e=>{const t=(0,n.getViewedSocialSecurityIdSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},50147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSocialSecurityIdMappers=void 0;const o=r(83539),a=r(72099);t.getSocialSecurityIdMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,a.identityToName)(e.identity)||e.SocialSecurityFullname,idNumber:e=>e.SocialSecurityNumber,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},29989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.socialSecurityIdMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234),i=r(72099);t.searchGetters=[(0,a.stringProp)("SocialSecurityNumber"),e=>(0,i.identityToName)(e.identity)||e.SocialSecurityFullname],t.socialSecurityIdMatch=(0,o.match)(t.searchGetters)},27147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedSocialSecurityIdSelector=t.viewedSocialSecurityIdSelector=t.getLiveSocialSecurityIdsSelector=t.viewedQueriedSocialSecurityIdsSelector=t.querySocialSecurityIdsSelector=t.socialSecurityIdMappersSelector=t.socialSecurityIdWithIdentitySelector=t.socialSecurityIdsWithIdentitySelector=t.socialSecurityIdSelector=t.socialSecurityIdsSelector=void 0;const o=r(16516),a=r(32034),i=r(29989),n=r(71864),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(50147),p=r(28074),S=r(57989),g=r(40602);t.socialSecurityIdsSelector=(0,a.createSelector)((e=>e.userSession.personalData.socialSecurityIds),S.quarantinedSpacesSelector,g.filterOutQuarantinedItems);t.socialSecurityIdSelector=(e,r)=>{const o=(0,t.socialSecurityIdsSelector)(e);return(0,d.findDataModelObject)(r,o)},t.socialSecurityIdsWithIdentitySelector=(0,a.createSelector)([t.socialSecurityIdsSelector,p.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]}))))),t.socialSecurityIdWithIdentitySelector=(0,a.createSelector)([t.socialSecurityIdSelector,e=>(0,p.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.socialSecurityIdMappersSelector=e=>(0,u.getSocialSecurityIdMappers)();const m=()=>i.socialSecurityIdMatch;t.querySocialSecurityIdsSelector=(0,s.getQuerySelector)(t.socialSecurityIdsWithIdentitySelector,m,t.socialSecurityIdMappersSelector),t.viewedQueriedSocialSecurityIdsSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.querySocialSecurityIdsSelector),t.getLiveSocialSecurityIdsSelector=(0,l.makeLiveSelectorGetter)(t.socialSecurityIdsWithIdentitySelector,(()=>n.listView),m,t.socialSecurityIdMappersSelector);t.viewedSocialSecurityIdSelector=(e,r)=>{const o=(0,t.socialSecurityIdWithIdentitySelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedSocialSecurityIdSelector=e=>{const r=(0,a.createSelector)(t.socialSecurityIdsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,p.identitiesSelector,((e,t)=>(0,n.maybeDetailView)({...e,identity:(0,d.findDataModelObject)(e.LinkedIdentity,t)})))}},72299:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},71864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(82043),a=r(72099),i=e=>({name:(0,a.identityToName)(e.identity)||e.SocialSecurityFullname||"",idNumber:e.SocialSecurityNumber??"",country:(0,a.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:e.CreationDatetime??0});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...i(e)}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,o.dataModelItemView)(e),...i(e)});t.listView=e=>e.map(t.itemView)},58452:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdHandler=void 0;const o=r(92233),a=r(32921),i=r(23136),n=r(48313),s=r(53),c=r(78320),l=r(95623),d=r(70252),u=r(13675),p=r(72099),S=r(79980);t.addIdHandler=async({applicationModulesAccess:e,sessionService:t,storeService:r,eventLoggerService:g},m,y)=>{if(""===m.idNumber)return Promise.resolve({success:!1,error:{code:a.AddIdResultErrorCode.MISSING_ID_NUMBER}});const h=({country:e,spaceId:t})=>{const r=(0,s.getUnixTimestamp)();return{AnonId:(0,c.generateItemUuid)(),CreationDatetime:r,Id:(0,c.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,p.viewCountryToVaultCountry)(e),SpaceId:t,UserModificationDatetime:r}};try{if(!r.isAuthenticated())return Promise.resolve({success:!1,error:{code:a.IdErrorCode.NOT_AUTHENTICATED}});const s=(0,u.sanitizeInputPersonalData)(m),c={...h(v=s),...y(v)};if(!c.SpaceId){const t=await(0,i.getDefaultSpaceId)(e,r);c.SpaceId=t}const l=c.kwType;r.dispatch((0,n.savePersonalDataItem)(c,l)),t.getInstance().user.persistPersonalData();return(0,i.getDebounceSync)(r,t)({immediateCall:!0},o.Trigger.Save),(0,S.logAddVaultItem)(r,g,c),Promise.resolve({success:!0})}catch(e){const t=new Error(`[IDs] - addIdHandler: ${e}`);return(0,d.sendExceptionLog)({error:t}),(0,l.logError)(t),Promise.resolve({success:!1,error:{code:a.IdErrorCode.INTERNAL_ERROR}})}var v}},9979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteIdHandler=void 0;const o=r(92233),a=r(32921),i=r(23136),n=r(45291),s=r(95623),c=r(70252),l=r(79980);t.deleteIdHandler=({sessionService:e,storeService:t,eventLoggerService:r},{id:d},u)=>{const p=t.getState();try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:a.IdErrorCode.NOT_AUTHENTICATED}});const s=u(p,d);if(!s)return Promise.resolve({success:!1,error:{code:a.IdErrorCode.NOT_FOUND}});const c=(0,n.removePersonalItem)(s.kwType,s.Id,null);t.dispatch(c);return(0,i.getDebounceSync)(t,e)({immediateCall:!0},o.Trigger.Save),(0,l.logDeleteVaultItem)(t,r,s),Promise.resolve({success:!0})}catch(e){const t=new Error(`[IDs] - deleteIdHandler: ${e}`);return(0,c.sendExceptionLog)({error:t}),(0,s.logError)(t),Promise.resolve({success:!1,error:{code:a.IdErrorCode.INTERNAL_ERROR}})}}},22388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateIdHandler=void 0;const o=r(92233),a=r(32921),i=r(23136),n=r(48313),s=r(53),c=r(95623),l=r(70252),d=r(13675),u=r(72099),p=r(79980);t.updateIdHandler=({sessionService:e,storeService:t,eventLoggerService:r},S,g,m)=>{if(""===S.idNumber)return Promise.resolve({success:!1,error:{code:a.UpdateIdResultErrorCode.MISSING_ID_NUMBER}});const y=({country:e,spaceId:t},r)=>({SpaceId:t??r.SpaceId,LocaleFormat:void 0===e?r.LocaleFormat:(0,u.viewCountryToVaultCountry)(e)}),h=(e,t)=>({...y(e,t),...g(e,t)});try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:a.IdErrorCode.NOT_AUTHENTICATED}});const c=t.getState(),l=(0,d.sanitizeInputPersonalData)(S),u=m(c,S.id);if(!u)return Promise.resolve({success:!1,error:{code:a.IdErrorCode.NOT_FOUND}});const g={...u,...h(l,u),UserModificationDatetime:(0,s.getUnixTimestamp)()},y=g.kwType;t.dispatch((0,n.savePersonalDataItem)(g,y)),e.getInstance().user.persistPersonalData();(0,i.getDebounceSync)(t,e)({immediateCall:!0},o.Trigger.Save);const v=m(c,S.id);return(0,p.logEditVaultItem)(t,r,g,v),Promise.resolve({success:!0})}catch(e){const t=new Error(`[IDs] - updateIdHandler: ${e}`);return(0,l.sendExceptionLog)({error:t}),(0,c.logError)(t),Promise.resolve({success:!1,error:{code:a.IdErrorCode.INTERNAL_ERROR}})}}},72099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityToName=t.viewCountryToVaultCountry=t.vaultCountryToViewCountry=t.vaultDateToViewDate=t.viewDateToVaultDate=t.epochToDate=t.ZERO_INDEX_BASED_MONTH_OFFSET=void 0;const o=r(53576);t.ZERO_INDEX_BASED_MONTH_OFFSET=1;t.epochToDate=e=>new Date(1e3*e);t.viewDateToVaultDate=e=>null===e?"":(e=>{const r=(0,t.epochToDate)(e);return`${r.getUTCFullYear()}-${r.getUTCMonth()+1}-${r.getUTCDate()}`})(e);t.vaultDateToViewDate=e=>{if(!e)return null;const t=(e=>{if(!e)return 0;const[t,r,o]=e.split(/[-/]/).map((e=>Number.parseInt(e,10))),a=new Date;a.setUTCHours(0,0,0,0);const i=a.setUTCFullYear(t,r-1,o);return Math.floor(i/1e3)})(e);return Number.isNaN(t)?null:t};t.vaultCountryToViewCountry=e=>{const t=o.Country[e];return void 0===t||t===o.Country.NO_TYPE?o.Country.UNIVERSAL:t},t.viewCountryToVaultCountry=t.vaultCountryToViewCountry;t.identityToName=e=>e?[e.FirstName,e.MiddleName,e.LastName,e.LastName2].filter(Boolean).join(" "):""},32921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateIdResultErrorCode=t.AddIdResultErrorCode=t.IdErrorCode=void 0,function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.NOT_AUTHENTICATED="NOT_AUTHENTICATED",e.NOT_FOUND="NOT_FOUND"}(t.IdErrorCode||(t.IdErrorCode={})),function(e){e.MISSING_ID_NUMBER="MISSING_ID_NUMBER"}(t.AddIdResultErrorCode||(t.AddIdResultErrorCode={})),function(e){e.MISSING_ID_NUMBER="MISSING_ID_NUMBER"}(t.UpdateIdResultErrorCode||(t.UpdateIdResultErrorCode={}))},11230:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importApiConfig=void 0;const o=r(56242),a=r(29613),i=r(28927),n=r(76295),s=r(94746);t.importApiConfig={commands:{importPersonalData:{handler:i.importPersonalDataHandler},previewPersonalData:{handler:n.previewPersonalDataHandler},dismissPersonalDataImportNotifications:{handler:s.dismissDataImportHandler}},queries:{getImportPersonalDataStatus:{selector:a.importPersonalDataStateSelector}},liveQueries:{liveImportPersonalDataStatus:{operator:o.importPersonalDataState$}}}},88815:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewPersonalDataErrorType=t.ImportPersonalDataStateType=t.ImportPersonalDataErrorType=t.ImportFormats=void 0,function(e){e.Csv="csv",e.Dash="dash"}(t.ImportFormats||(t.ImportFormats={})),function(e){e.Unavailable="unavailable",e.Unknown="unknown"}(t.ImportPersonalDataErrorType||(t.ImportPersonalDataErrorType={})),function(e){e.Idle="idle",e.Processing="processing",e.Success="success",e.Error="error"}(t.ImportPersonalDataStateType||(t.ImportPersonalDataStateType={})),function(e){e.BadPassword="bad_password",e.Unavailable="unavailable",e.InvalidFormat="invalid",e.Unknown="unknown"}(t.PreviewPersonalDataErrorType||(t.PreviewPersonalDataErrorType={}))},94746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dismissDataImportHandler=t.dismissDataImport=void 0;const o=r(38250),a=r(43691);t.dismissDataImport=async e=>{await e.waitReady(),e.onNewState({status:o.ImportPersonalDataStateType.Idle})};t.dismissDataImportHandler=e=>(0,t.dismissDataImport)((0,a.makeImportService)(e))},28927:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataHandler=t.importPersonalData=void 0;const o=r(38250),a=r(95623),i=r(70252),n=r(43691);t.importPersonalData=async(e,t)=>{try{e.onNewState({status:o.ImportPersonalDataStateType.Processing,name:t.name});const r=t.content;return(async()=>{try{const a=await e.importPersonalDataItems(r);e.onNewState({status:o.ImportPersonalDataStateType.Success,name:t.name,totalCount:a.totalCount,successCount:a.successCount,duplicateCount:a.duplicateCount})}catch(r){const n=new Error(`[import] - importError: ${r}`);(0,i.sendExceptionLog)({error:n}),(0,a.logError)(n),e.onNewState({status:o.ImportPersonalDataStateType.Error,name:t.name})}})(),{success:!0}}catch(r){const n=new Error(`[import] - formatError: ${r}`);return(0,i.sendExceptionLog)({error:n}),(0,a.logError)(n),e.onNewState({status:o.ImportPersonalDataStateType.Error,name:t.name}),{success:!1,error:o.ImportPersonalDataErrorType.Unknown}}};t.importPersonalDataHandler=(e,r)=>(0,t.importPersonalData)((0,n.makeImportService)(e),r)},76295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.previewPersonalDataHandler=t.previewPersonalData=void 0;const o=r(38250),a=r(43691);t.previewPersonalData=async(e,t)=>{if(!e.canDoImport())return{success:!1,error:o.PreviewPersonalDataErrorType.Unavailable};try{return await e.previewPersonalDataArchive(t)}catch(e){return{success:!1,error:o.PreviewPersonalDataErrorType.InvalidFormat}}};t.previewPersonalDataHandler=(e,r)=>{const o=(0,a.makeImportService)(e);return(0,t.previewPersonalData)(o,r)}},56242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataState$=void 0;const o=r(18948),a=r(3343),i=r(29613);t.importPersonalDataState$=()=>(0,o.pipe)((0,a.map)(i.importPersonalDataStateSelector,(0,a.distinctUntilChanged)()))},29613:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isImportPersonalDataAvailableSelector=t.importPersonalDataStateSelector=void 0;const o=r(38250),a=r(62844);t.importPersonalDataStateSelector=e=>e.userSession.importPersonalData.state??{status:o.ImportPersonalDataStateType.Idle};t.isImportPersonalDataAvailableSelector=e=>!(0,a.changeMPinProgressSelector)(e)&&(0,t.importPersonalDataStateSelector)(e).status!==o.ImportPersonalDataStateType.Processing},90537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueVaultItemIdentifier=void 0;const o=r(16516),a={Attachments:!1},i={...a,Title:!0,Email:!0,Login:!0,SecondaryLogin:!0,Password:!0,Strength:!1,Note:!0,Checked:!1,Status:!1,SharedObject:!1,ModificationDatetime:!1,Category:!1,Url:!0,UserSelectedUrl:!1,UseFixedUrl:!1,TrustedUrlGroup:!1,NumberUse:!1,AutoLogin:!1,AutoProtected:!1,SubdomainOnly:!1,Type:!1,Server:!1,Port:!1,Alias:!1,SID:!1,ConnectionOptions:!1,domainIcon:!1,limitedPermissions:!1,OtpSecret:!0,OtpUrl:!0,LinkedServices:!1},n={...a,Title:!0,Category:!1,Type:!1,limitedPermissions:!1,Content:!0,Secured:!1,CreationDate:!1,UpdateDate:!1},s={...a,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0},c={...a,Email:!0,Type:!1,EmailName:!0},l={...a,Type:!1,Number:!0,NumberNational:!0,NumberInternational:!0,PhoneName:!0,PersonalNote:!0},d={...a,Title:!0,FirstName:!0,MiddleName:!0,LastName:!0,LastName2:!0,Pseudo:!1,BirthDate:!0,BirthPlace:!0},u={...a,Counter:!1,CredentialId:!0,ItemName:!0,KeyAlgorithm:!0,Note:!0,PrivateKey:!0,RpId:!0,RpName:!0,UserDisplayName:!0,UserHandle:!0},p={...a,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0,DeliveryPlace:!0},S={...a,PersonalNote:!0,Name:!0,Website:!0},g={...a,Number:!0,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,DeliveryDate:!0,ExpireDate:!0,State:!0},m={...a,PersonalNote:!0,Name:!0,JobTitle:!0},y={...a,PersonalNote:!0,State:!0,AddressName:!0,Receiver:!0,AddressFull:!0,City:!0,ZipCode:!0,Country:!0,StreetNumber:!0,StreetTitle:!0,StreetName:!0,StateNumber:!0,StateLevel2:!0,Building:!0,Stairs:!0,Floor:!0,Door:!0,DigitCode:!0,LinkedPhone:!1},h={...a,Name:!0,CardNumber:!0,CardNumberLastDigits:!0,OwnerName:!0,SecurityCode:!0,ExpireMonth:!0,ExpireYear:!0,StartMonth:!0,StartYear:!0,IssueNumber:!0,Color:!1,Bank:!0,CCNote:!0,Type:!1},v={...a,BankAccountName:!0,BankAccountOwner:!0,BankAccountIBAN:!0,BankAccountBIC:!0,BankAccountBank:!0},f=e=>Object.keys(e).filter((t=>!!e[t])),A={KWAddress:f(y),KWAuthCategory:f({Attachments:!1,CategoryName:!0}),KWAuthentifiant:f(i),KWBankStatement:f(v),KWCollection:f({Attachments:!1,Name:!0,VaultItems:!0}),KWCompany:f(m),KWDataChangeHistory:[],KWDriverLicence:f(g),KWEmail:f(c),KWFiscalStatement:[],KWGeneratedPassword:[],KWIDCard:f(s),KWIdentity:f(d),KWMerchand:[],KWMiscData:[],KWPasskey:f(u),KWPassport:f(p),KWPaymentMean_creditCard:f(h),KWPaymentMean_paypal:[],KWPersonalWebsite:f(S),KWPhone:f(l),KWPurchaseAccount:[],KWPurchaseCategory:[],KWPurchasePaidBasket:[],KWPurchaseTrueArticle:[],KWSecureFileInfo:[],KWSecureNote:f(n),KWSecureNoteCategory:f({Attachments:!1,CategoryName:!0}),KWSecurityBreach:[],KWSettingsManagerApp:[],KWSocialSecurityStatement:[],KWWebSite:[]};t.getUniqueVaultItemIdentifier=e=>((e,t)=>{const r={};return e.forEach((e=>{r[e]=t[e]??""})),(0,o.isEmpty)(r)?"":JSON.stringify(r)})(A[e.kwType],e)},47437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportableItemsFromUserFile=t.getExistingVaultItemUniqueIdentifiers=void 0;const o=r(53576),a=r(13675),i=r(72883),n=r(88205),s=r(49901),c=r(90537),l=r(88655),d=[o.DataModelType.KWAddress,o.DataModelType.KWAuthentifiant,o.DataModelType.KWCompany,o.DataModelType.KWDriverLicence,o.DataModelType.KWEmail,o.DataModelType.KWIDCard,o.DataModelType.KWIdentity,o.DataModelType.KWPassport,o.DataModelType.KWPaymentMean_creditCard,o.DataModelType.KWPersonalWebsite,o.DataModelType.KWPhone,o.DataModelType.KWSecureNote,o.DataModelType.KWSocialSecurityStatement,o.DataModelType.KWWebSite];t.getExistingVaultItemUniqueIdentifiers=e=>{const t=new Set,r=Object.entries(e).filter((([e])=>(0,i.isDataKeyVaultItem)(e))).reduce(((e,[t,r])=>({...e,[t]:r})),{});for(const e of Object.values(r))e.forEach((e=>{if((0,o.isDataModelObject)(e)){const r=(0,c.getUniqueVaultItemIdentifier)(e);r&&t.add(r)}}));return t};const u=(e,t,r)=>{r.length&&t?e.SpaceId=r[0].teamId:e.SpaceId&&(e.SpaceId=r[0]?.teamId??s.PERSONAL_SPACE_ID)},p=async(e,t)=>((0,o.isCredential)(e)?e=await(0,l.prepareCredentialForImport)(e,t):(0,o.isNote)(e)&&(e=(0,l.prepareSecureNoteForImport)(e)),e);t.getImportableItemsFromUserFile=async(e,t,r,i)=>{const{applicationModulesAccess:s,storeService:S}=e,g=await(0,n.makeFeatureFlipsSelectors)(s).featureFlipsSelector(),{spaces:m}=S.getSpaceData(),y=g.onboarding_web_disablepersonalspace_dev??!1,h=[];let v=0,f=0;for(const e of t){d.includes(e.kwType)&&v++;const t=await p((0,a.sanitizeInputPersonalData)((0,l.convertImportable)(e)),i);if(u(t,y,m),(0,o.isCollection)(t)){const e=h.find((e=>(0,o.isCollection)(e)&&e.SpaceId===t.SpaceId&&e.Name===t.Name));if(e){e.VaultItems=[...e.VaultItems,...t.VaultItems];continue}}r.has((0,c.getUniqueVaultItemIdentifier)(t))?f++:h.push(t)}return{itemsToImport:h,importableItemCount:v,duplicateItemCount:f}}},20485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataItems=void 0;const o=r(53576),a=r(92233),i=r(72678),n=r(92310),s=r(78163),c=r(23136),l=r(88655),d=r(47437);t.importPersonalDataItems=async(e,t)=>{const{storeService:r,sessionService:u,localStorageService:p,applicationModulesAccess:S}=e,g=r.getState(),m=(0,c.getDebounceSync)(r,u);let y=0,h=0;const v=(0,d.getExistingVaultItemUniqueIdentifiers)(g.userSession.personalData),f=(0,l.makeCategoryIdMaps)(t,(0,i.personalDataSelector)(g)),{itemsToImport:A,importableItemCount:P,duplicateItemCount:b}=await(0,d.getImportableItemsFromUserFile)(e,t,v,f),w=(0,l.groupByType)(A);for(const[e,t]of w.entries())if((0,l.savePersonalDataItemsForImport)({storeService:r,sessionService:u,localStorageService:p,applicationModulesAccess:S},e,t),e!==o.DataModelType.KWCollection&&(y+=t.length),e===o.DataModelType.KWAuthentifiant&&(0,s.hasVaultAuditLogsFFActivated)(S)){const e=(0,n.currentTeamIdSelector)(g);h=t.filter((t=>t.SpaceId===e)).length,h>=1&&await(0,s.computeAndSendCSVImportActivityLog)(S,{domainUrl:null,importCount:h})}return m({immediateCall:!0},a.Trigger.Save),{successCount:y,totalCount:P,duplicateCount:b}}},88655:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.savePersonalDataItemsForImport=t.groupByType=t.prepareSecureNoteForImport=t.makeCategoryIdMaps=t.prepareCredentialForImport=t.convertImportable=void 0;const o=r(53576),a=r(86392),i=r(48313),n=r(56915),s=r(73566),c=r(85225),l=r(53),d=r(23439),u=r(47975),p=r(78320),S=r(28207),g=r(70252);t.convertImportable=e=>({...e,Id:e.Id?e.Id:(0,p.generateItemUuid)(),AnonId:(0,p.generateItemUuid)(),SpaceId:e.SpaceId??"",LocaleFormat:e.LocaleFormat??o.Country.UNIVERSAL});t.prepareCredentialForImport=async(e,t)=>({...e,Category:t.get(e.Category)??"",Strength:e.Password?await(0,u.evaluatePasswordStrength)(e.Password):0});t.makeCategoryIdMaps=(e,t)=>{const r=new Map;for(const a of e)if((0,o.isCredentialCategory)(a)){const e=(0,d.getCategoryIdByName)(t,a.CategoryName);e&&r.set(a.Id,e)}return r};t.prepareSecureNoteForImport=e=>{const t=(0,l.getUnixTimestamp)();return{...e,CreationDatetime:t,LocaleFormat:o.Country.US,UserModificationDatetime:t,LastBackupTime:0,Title:e.Title??`Untitled - ${t.toLocaleString()}`,Content:e.Content??"",Category:e.Category??"noCategory",Secured:e.Secured??!1,Type:o.NoteTypes.includes(e.Type)?e.Type:"GRAY",Attachments:e.Attachments??[]}};t.groupByType=e=>{const t=new Map;for(const r of e){const e=t.get(r.kwType);e?e.push(r):t.set(r.kwType,[r])}return t};t.savePersonalDataItemsForImport=({storeService:e,sessionService:t,applicationModulesAccess:r},l,d)=>{if(!d.length)return;const u=e.getPersonalData(),p=d.reduce(((t,r)=>{let a=null;return(0,s.isChangeHistoryCandidate)(r)&&(a=(0,s.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName??"",personalData:u,change:(0,c.makeUpdateChange)(r),userLogin:e.getUserLogin(),platformInfo:(0,n.platformInfoSelector)(e.getState())})),{changeHistories:[...t.changeHistories,...a?[a]:[]],credentialIds:[...t.credentialIds,...(0,o.isCredential)(r)?[r.Id]:[]]}}),{changeHistories:[],credentialIds:[]});e.dispatch((0,i.savePersonalDataItems)(d,l,p.changeHistories)),t.getInstance().user.persistPersonalData(),(async(e,t)=>{if(t.length)try{const{commands:r}=e.createClients().vaultItemsCrud;await r.emitTemporaryVaultItemEvent({ids:[...t],eventType:a.EventType.Created}),S.carbonEventHooks.iconsUpdates({type:"credentialUpdates",credentialIds:t})}catch(e){const t=new Error(`Failed to handle health & credential health updates with ${e}`);return void(0,g.sendExceptionLog)({error:t})}})(r,p.credentialIds)}},43691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeImportService=void 0;const o=r(53576),a=r(38250),i=r(56915),n=r(17825),s=r(3343),c=r(56242),l=r(29613),d=r(61655),u=r(20485),p=r(99474),S=r(32814);t.makeImportService=e=>{const{storeService:t}=e;return{previewPersonalDataArchive:e=>(async(e,t)=>{const r=(0,i.platformInfoSelector)(e.getState());switch(t.format){case a.ImportFormats.Csv:{const e=(0,p.getImportablePersonalData)(t.content,o.Country[r.country]);return 0===e.items.length?{success:!1,error:a.PreviewPersonalDataErrorType.InvalidFormat}:{success:!0,data:{items:e.items,headers:e.headers}}}case a.ImportFormats.Dash:{const r=(0,S.parseDashData)(t.content.data);return await(0,S.checkPassword)(e,r,t.password)?{success:!0,data:{items:(await(0,S.getSaveEventsFromDash)(e,r,t.password)).map((e=>({baseDataModel:e,rawData:{}}))),headers:[]}}:{success:!1,error:a.PreviewPersonalDataErrorType.BadPassword}}}(0,n.assertUnreachable)(t)})(t,e),canDoImport:()=>(0,l.isImportPersonalDataAvailableSelector)(t.getState()),importPersonalDataItems:t=>(0,u.importPersonalDataItems)(e,t),onNewState:e=>t.dispatch((0,d.notifyNewImportPersonalDataStateAction)(e)),waitReady:async()=>{await(0,c.importPersonalDataState$)()(t.getState$()).pipe((0,s.first)((e=>e.status!==a.ImportPersonalDataStateType.Processing))).toPromise()}}}},89586:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFieldLevelProcessor=void 0;const o=r(38250),a=r(85803),i=(e,t)=>"title"===e?null:t,n=(e,t)=>{switch(e){case"reprompt":if("0"===t)return null;break;case"name":if("--"===t)return null;break;case"type":return null}return t};t.getFieldLevelProcessor=e=>{switch(e){case o.ImportSource.Safari:return i;case o.ImportSource.Bitwarden:return n;case o.ImportSource.Lastpass:return a.fieldProcessorForLastPass;default:return null}}},62754:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemTypeProcessor=void 0;const o=r(38250),a=r(85803);t.getItemTypeProcessor=e=>e===o.ImportSource.Lastpass?a.itemTypeProcessorForLastPass:null},92522:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCustomKeeperCredentialData=t.getKeeperImportHeaders=void 0;t.getKeeperImportHeaders=e=>{const t=["Folder","Title","Login","Password","Website Address","Notes","Shared Folder"],r=Math.max(0,e-t.length);return r&&t.push(...[...Array(r).keys()].map(((e,t)=>`Custom ${t+1}`))),t};t.parseCustomKeeperCredentialData=(e,t)=>{Object.keys(e).forEach((r=>{const o=e[r];"TFC:Keeper"===o?delete e[r]:"string"==typeof o&&o.startsWith("otpauth://")&&(t.OtpUrl=o,delete e[r])}))}},85803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldProcessorForLastPass=t.itemTypeProcessorForLastPass=t.processAndPushLastPassNote=t.parseLastPassSecureNote=t.LPNoteTypeField=t.LastPassNoteType=t.LAST_PASS_SECURE_NOTE_URL=void 0;const o=r(77672),a=r(53576),i=r(97437),n=r(38959);var s,c;t.LAST_PASS_SECURE_NOTE_URL="http://sn",function(e){e.BankAccountType="Bank Account",e.PaymentCardType="Credit Card"}(t.LastPassNoteType||(t.LastPassNoteType={})),t.LPNoteTypeField={NoteType:"NoteType"},function(e){e.BankName="Bank Name",e.AccountType="Account Type",e.RoutingNumber="Routing Number",e.AccountNumber="Account Number",e.SWIFTCode="SWIFT Code",e.IBANNumber="IBAN Number",e.Pin="Pin",e.BranchAddress="Branch Address",e.BranchPhone="BranchPhone",e.Notes="Notes"}(s||(s={})),function(e){e.NameOnCard="Name on Card",e.Type="Type",e.Number="Number",e.SecurityCode="Security Code",e.StartDate="Start Date",e.ExpirationDate="Expiration Date",e.Notes="Notes",e.Language="Language"}(c||(c={}));t.parseLastPassSecureNote=e=>{const r={};try{switch(e.split("\n").forEach((e=>{const[t,o]=e.split(":");r[t]=o})),r.NoteType){case"Bank Account":return{type:"Bank Account",data:{BankAccountName:r["Bank Name"],BankAccountOwner:"",BankAccountIBAN:r["IBAN Number"]?r["IBAN Number"]:r["Account Number"],BankAccountBIC:r["SWIFT Code"]?r["SWIFT Code"]:r["Routing Number"],BankAccountBank:"",kwType:a.DataModelType.KWBankStatement}};case"Credit Card":{const e=r["Expiration Date"];let i,n;if(e){const[t,r]=e.split(",");i=`${(0,o.getMonth)(new Date(`${t} 1`))+1}`,i=i.length<=2?i:"",n=4!==r.length||isNaN(r)?"":r}const s={CardNumber:r.Number,OwnerName:r["Name on Card"],SecurityCode:r["Security Code"],ExpireMonth:i,ExpireYear:n,CCNote:r.Notes,kwType:a.DataModelType.KWPaymentMean_creditCard};delete r[t.LPNoteTypeField.NoteType],delete r["Expiration Date"],delete r.Language,r["Payment Type"]=r.Type,delete r[t.LPNoteTypeField.NoteType];const c=Object.keys(s),l=Object.values(s);return Object.keys(r).forEach((e=>{(c.includes(e)||l.includes(r[e]))&&delete r[e]})),{type:"Credit Card",data:{...r,...s}}}default:return null}}catch{return null}};t.processAndPushLastPassNote=(e,r,o,a,s)=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){delete e.url;const c=(0,t.parseLastPassSecureNote)(e.extra),l="Bank Account"===c?.type?i.BANK_ACCOUNT_HEADERS:"Credit Card"===c?.type?i.PAYMENT_CARD_HEADERS:i.SECURE_NOTES_HEADERS;switch(Object.keys(c?.data??{}).forEach((e=>{const t=Object.keys(l).find((t=>l[t].has(e.toLocaleLowerCase())));!s.has(e)&&e&&s.set(e,{original:e,matched:t??""})})),c?.type){case"Bank Account":{const t={baseDataModel:(0,n.buildBankAccountObj)(c.data,r,s),rawData:e};return void a.bankAccounts.push(t)}case"Credit Card":{const t={baseDataModel:(0,n.buildPaymentCardObj)(c.data,r,s,o),rawData:e};return void a.paymentCards.push(t)}default:{const t={baseDataModel:(0,n.buildNoteObj)(e,r,s),rawData:e};return void a.notes.push(t)}}}};t.itemTypeProcessorForLastPass=e=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){const r=e.extra.split("\n");let o="";for(let e=0;e<r.length;e++){const[a,i]=r[e]?r[e].split(":"):[];a===t.LPNoteTypeField.NoteType&&(o=i)}switch(o){case"Bank Account":return i.SupportedVaultTypes.BANK_ACCOUNT;case"Credit Card":return i.SupportedVaultTypes.PAYMENT_CARD;default:return i.SupportedVaultTypes.NOTE}}return null};t.fieldProcessorForLastPass=(e,t)=>{switch(e){case"fav":if(!t||t.includes("0"))return null;break;case"grouping":if(!t||t.includes("(none)"))return null}return t}},99474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportablePersonalData=t.parseCSV=void 0;const o=r(21178),a=r(38250),i=r(92522),n=r(85803),s=r(38959),c=r(97437),l=r(10770);function d(e,t,r,o){const a={baseDataModel:(0,s.buildNoteObj)(e,t,r),rawData:e};o.notes.push(a)}function u(e,t,r,o){const a={baseDataModel:(0,s.buildBankAccountObj)(t,e,o),rawData:t};r.bankAccounts.push(a)}function p(e,t,r,o,a){const i={baseDataModel:(0,s.buildPaymentCardObj)(t,e,a,r),rawData:t};o.paymentCards.push(i)}const S="otpauth://totp/?secret=",g=/^otpauth:\/\/.*/;function m(e,t,r,i,n){const c={baseDataModel:(0,s.buildCredentialObj)(e,t,r,i),rawData:e};c.baseDataModel.Category&&(t===a.ImportSource["1Password"]&&(c.baseDataModel.Category=c.baseDataModel.Category.replaceAll(";",",")),c.baseDataModel.Category.split(",").forEach((t=>{const r=n.collections.find((e=>e.baseDataModel.Name===t));if(r)r.baseDataModel.VaultItems.push({Id:c.baseDataModel.Id,Type:c.baseDataModel.kwType});else{const r={Name:t,baseDataModel:(0,l.getNewCollection)({name:t,vaultItems:[],spaceId:""}),rawData:e};n.collections.push(r),r.baseDataModel.VaultItems=[...r.baseDataModel.VaultItems,{Id:c.baseDataModel.Id,Type:c.baseDataModel.kwType}]}}))),c.baseDataModel.OtpUrl&&!g.test(c.baseDataModel.OtpUrl)&&(c.baseDataModel.OtpUrl=S+c.baseDataModel.OtpUrl);const d=new o.ParsedURL(c.baseDataModel.Url);c.baseDataModel.Url&&d.isUrlValid()&&(c.baseDataModel.Url=d.getPIIStrippedURL()),n.credentials.push(c)}const y=(e,t,r,o)=>{const i={credentials:[],notes:[],bankAccounts:[],paymentCards:[],collections:[]},l=new Map;for(let S=0;S<e.length;S++){const g=e[S].reduce(((e,r,o)=>(e[t[o]]=r,e)),{}),y=(0,s.determineBestItemType)(g,r),h=(0,s.getHeadersAndIndexMap)(t,y),v=new Map;if(h.forEach((e=>{(!l.has(e.original)||!l.get(e.original)?.matched&&e.matched)&&l.set(e.original,e),e.matched&&v.set(e.original,e)})),[c.SupportedVaultTypes.BANK_ACCOUNT,c.SupportedVaultTypes.NOTE,c.SupportedVaultTypes.PAYMENT_CARD].includes(y)&&r===a.ImportSource.Lastpass)(0,n.processAndPushLastPassNote)(g,r,o,i,v);else switch(y){case c.SupportedVaultTypes.CREDENTIAL:m(g,r,v,o,i);break;case c.SupportedVaultTypes.PAYMENT_CARD:p(r,g,o,i,v);break;case c.SupportedVaultTypes.BANK_ACCOUNT:u(r,g,i,v);break;case c.SupportedVaultTypes.NOTE:default:d(g,r,v,i)}}return{...i,headers:[...l.values()]}};function h(e,t,r){const o={credentials:[],notes:[],paymentCards:[],bankAccounts:[],headers:[],collections:[]};if(!e)return o;const{csvHead:n,csvRows:c}=function(e,t){const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,o=[[]];let n;for(;n=r.exec(e.trim());)n[1].length&&","!==n[1]&&o.push([]),o[o.length-1].push(void 0!==n[2]?n[2].replace(new RegExp('^"|"$|"(?=,")|(?<=",)"',"gi"),'"'):n[3]);if(t===a.ImportSource.Keeper){const e=o.reduce(((e,t)=>Math.max(e,t.length)),0);o.unshift((0,i.getKeeperImportHeaders)(e))}const[s,...c]=o;return{csvHead:s,csvRows:c}}(e,t),l=n.map((e=>e.toLowerCase()));return c.length&&(0,s.areHeadersValid)(l)?y(c,l,t,r):o}t.parseCSV=h;t.getImportablePersonalData=(e,t)=>{const r=h(e.data,e.importSource,t),{headers:o,...a}=r;return{headers:o,items:Object.values(a).flat()}}},32814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveEventsFromDash=t.getXmlData=t.checkPassword=t.parseDashData=void 0;const o=r(53576),a=r(80469),i=r(53628),n=r(56668),s=r(72365),c=r(61797),l=r(95623),d=r(70252),u=r(78320),p=e=>new RegExp(`-+\\s+${e} BEGIN\\s+-+\n(.+)\n-+\\s+${e} END`);t.parseDashData=e=>{const[t,r]=["Id","Data"].map(p).map((t=>t.exec(e))).map((e=>e?.[1]));return{ids:t?.split(";")??[],encryptedData:r??""}};t.checkPassword=async(e,t,r)=>{const o=(0,s.makeDataEncryptorService)(e);o.setInstance({raw:r},"");try{return(0,n.deflatedUtf8ToUtf16)(await o.getInstance().decrypt(t.encryptedData)),!0}catch(e){const r=`[import] - checkPassword: ${e}, ${t.encryptedData}`,o=new Error(r);(0,d.sendExceptionLog)({error:o}),(0,l.logError)(o)}return!1};t.getXmlData=async(e,t,r)=>{const o=(0,s.makeDataEncryptorService)(e);o.setInstance({raw:r},"");const a=await o.getInstance().decrypt(t.encryptedData),i=(0,n.deflatedUtf8ToUtf16)(a),l=await(0,c.parseDashlaneXml)(i);return Array.isArray(l)?l:[l]};t.getSaveEventsFromDash=async(e,r,n)=>{const s={},c=(await(0,t.getXmlData)(e,r,n)).map((e=>(0,i.fixPersonalDataItemFromExternalSource)((0,a.fixKwType)(e)))).map((e=>{const t=(0,u.generateItemUuid)();return s[e.Id]=t,{...e,Id:t}}));return c.forEach((e=>{(0,o.isCollection)(e)&&e.VaultItems.forEach((e=>{e.Id=s[e.Id]??e.Id}))})),c}},97437:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAPPINGS=t.TYPE_HEADERS=t.HEADER_MAPPINGS=t.BANK_ACCOUNT_HEADERS=t.PAYMENT_CARD_HEADERS=t.CREDENTIAL_HEADERS=t.SECURE_NOTES_HEADERS=t.SupportedVaultTypes=void 0,function(e){e.CREDENTIAL="credentials",e.NOTE="notes",e.PAYMENT_CARD="paymentCards",e.BANK_ACCOUNT="bankAccounts",e.COLLECTION="collections"}(r=t.SupportedVaultTypes||(t.SupportedVaultTypes={})),t.SECURE_NOTES_HEADERS={Title:new Set(["title","name"]),Content:new Set(["note","notes","comments","extra","content"])},t.CREDENTIAL_HEADERS={Title:new Set(["title","name","account","site name"]),Login:new Set(["username","login","login_username","login name","user name"]),Url:new Set(["url","website","domain","login_url","login url","login_uri","web site","website address"]),Email:new Set(["email"]),Password:new Set(["password","login_password"]),OtpUrl:new Set(["first one-time password","login_otp","login_totp","otp","otpauth","otpurl","otpsecret","totp"]),Note:new Set(["note","notes","comments","extra"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.PAYMENT_CARD_HEADERS={CardNumber:new Set(["number","cardnumber","cc_number"]),CCNote:new Set(["notes","ccnote","note"]),OwnerName:new Set(["name on card","ownername","account_name"]),SecurityCode:new Set(["security code","securitycode","code"]),ExpireMonth:new Set(["exp_month","expiremonth","expiration_month"]),ExpireYear:new Set(["exp_year","expireyear","expiration_year"]),Name:new Set(["name"])},t.BANK_ACCOUNT_HEADERS={BankAccountName:new Set(["bank name","bankaccountname","account_name"]),BankAccountIBAN:new Set(["iban number","account number","account_number","bankaccountiban"]),BankAccountBIC:new Set(["swift code","routing number","routing_number","bankaccountbic"]),BankAccountOwner:new Set(["account_holder"]),BankAccountBank:new Set(["issuing_bank"]),LocaleFormat:new Set(["country"])},t.HEADER_MAPPINGS={[r.CREDENTIAL]:t.CREDENTIAL_HEADERS,[r.NOTE]:t.SECURE_NOTES_HEADERS,[r.PAYMENT_CARD]:t.PAYMENT_CARD_HEADERS,[r.BANK_ACCOUNT]:t.BANK_ACCOUNT_HEADERS,[r.COLLECTION]:{}},t.TYPE_HEADERS=new Set(["type","item type"]),t.TYPE_MAPPINGS={[r.NOTE]:["securenote","note","secure note"],[r.CREDENTIAL]:["password","login","credential"],[r.BANK_ACCOUNT]:["bankaccount","bank"],[r.PAYMENT_CARD]:["paymentcard","payment_card","creditcard","debitcard"],[r.COLLECTION]:[]}},38959:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areHeadersValid=t.determineBestItemType=t.getHeadersAndIndexMap=t.buildCredentialObj=t.buildBankAccountObj=t.buildPaymentCardObj=t.buildNoteObj=t.reduceVaultObj=t.constructBankAccount=t.constructPaymentCard=t.constructSecureNote=t.constructCredentialContent=t.formatCredentialData=t.buildNoteContent=void 0;const o=r(53576),a=r(21178),i=r(38250),n=r(9763),s=r(23439),c=r(35834),l=r(49293),d=r(8639),u=r(97437),p=r(62754),S=r(89586),g=r(92522),m=(e,t)=>{for(const r in e)t.includes(r)||delete e[r]};t.buildNoteContent=(e,t,r,a,i)=>{let n="";if((0,o.isCredential)(e))n=e.Note??"";else if((0,o.isNote)(e))e.Note&&(e.Content=e.Note,delete e.Note),n=e.Content;else{if(!(0,o.isPaymentCard)(e))return;n=e.CCNote}const s=!!n;let c=!1;const l={...e,...r};for(const e in l)if(!a.includes(e)&&!t.get(e)?.matched&&l[e]){if(i?i(e.toLocaleLowerCase(),l[e]):l[e]){n+=`${s&&!c?"\n\n\n":"\n"}${e}: ${l[e]}`,c=!0}}n=n.trim(),(0,o.isCredential)(e)?e.Note=n:(0,o.isNote)(e)?e.Content=n:(0,o.isPaymentCard)(e)&&(e.CCNote=n)};t.formatCredentialData=e=>{let t=e.Url?.trim()??"";const r=e.Url?.split(",")??[""];if(r.length>1&&new a.ParsedURL(r[0]).isUrlValid()&&r.slice(1).some((e=>new a.ParsedURL(e).isUrlValid()))){const[r,...i]=e.Url?.split(",")??[];t=r.trim(),e.LinkedServices={associated_domains:[]},i.forEach((t=>{const r=new a.ParsedURL(t.trim());r.isUrlValid()&&e.LinkedServices?.associated_domains.push({domain:r.getPIIStrippedURL(),source:o.LinkedWebsiteSource.Manual})}))}const i=new a.ParsedURL(t);e.Url=i.isUrlValid()?t:"";const n=new a.ParsedURL(e.Title?.trim());e.Title&&!n.isUrlValid()||(e.Title=i.getRootDomain()??"")};t.constructCredentialContent=(e,t,r)=>({Title:"",Email:"",Login:"",Password:"",Note:"",...e,...(0,n.createBaseCredentialModel)(t),...(0,s.getUrlFields)(e.Url??"",!0),SpaceId:r??"",SubdomainOnly:!1,SecondaryLogin:"",Category:"",AutoLogin:!0,AutoProtected:!1,Strength:0});t.constructSecureNote=(e,t)=>(0,l.noteFormatter)({content:e.Content||"",title:e.Title||"",category:"",secured:!1,type:o.NoteTypes[0],spaceId:t||""});t.constructPaymentCard=(e,t)=>(0,c.getNewPaymentCard)({ownerName:e.OwnerName??"",cardName:e.Name??"",cardNumber:e.CardNumber??"",securityCode:e.SecurityCode??"",expireMonth:e.ExpireMonth??"",expireYear:e.ExpireYear??"",...e,spaceId:t});t.constructBankAccount=(e,t,r)=>(0,d.getNewBankAccount)({name:e.BankAccountName??"",owner:e.BankAccountOwner??"",IBAN:e.BankAccountIBAN??"",BIC:e.BankAccountBIC??"",bank:e.BankAccountBank??"",country:t,...e,spaceId:r??""});t.reduceVaultObj=(e,t,r,o,a)=>Object.entries(e).reduce(((e,[t,a])=>{const i=o.get(t)?.matched;return o.has(t)&&i&&(e[i]=r?r(t,"string"==typeof a?a:""):a),e}),t({},a));t.buildNoteObj=(e,r,o)=>{const a=Object.keys({Title:"",Content:"",Category:"",Secured:"",Type:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDate:"",UpdateDate:"",limitedPermissions:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),i=(0,S.getFieldLevelProcessor)(r),n=(0,t.reduceVaultObj)(e,t.constructSecureNote,i,o);return(0,t.buildNoteContent)(n,o,e,a,i),m(n,a),n};t.buildPaymentCardObj=(e,r,o,a)=>{const i=Object.keys({Name:"",CardNumber:"",CardNumberLastDigits:"",OwnerName:"",SecurityCode:"",ExpireMonth:"",ExpireYear:"",StartMonth:"",StartYear:"",IssueNumber:"",Color:"",Bank:"",CCNote:"",Type:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),n=(0,S.getFieldLevelProcessor)(r),s=(0,t.reduceVaultObj)(e,t.constructPaymentCard,n,o,a);return(0,t.buildNoteContent)(s,o,e,i,n),m(s,i),s};t.buildBankAccountObj=(e,r,o)=>{const a=Object.keys({BankAccountName:"",BankAccountOwner:"",BankAccountIBAN:"",BankAccountBIC:"",BankAccountBank:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),i=(0,S.getFieldLevelProcessor)(r),n=(0,t.reduceVaultObj)(e,t.constructBankAccount,i,o);return m(n,a),n};t.buildCredentialObj=(e,r,o,a)=>{const n=Object.keys({Title:"",Email:"",Login:"",SecondaryLogin:"",Password:"",Strength:"",Category:"",Url:"",UseFixedUrl:"",TrustedUrlGroup:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",LastUse:"",Note:"",SubdomainOnly:"",AutoLogin:"",AutoProtected:"",OtpSecret:"",UserSelectedUrl:"",Checked:"",Status:"",SharedObject:"",ModificationDatetime:"",NumberUse:"",Type:"",Server:"",Port:"",Alias:"",SID:"",ConnectionOptions:"",domainIcon:"",limitedPermissions:"",LinkedServices:"",UserModificationDatetime:"",Attachments:"",OtpUrl:""}),s=(0,S.getFieldLevelProcessor)(r),c=(0,t.reduceVaultObj)(e,t.constructCredentialContent,s,o,a);if(r===i.ImportSource.Keeper)(0,g.parseCustomKeeperCredentialData)(e,c);return(0,t.buildNoteContent)(c,o,e,n,s),m(c,n),(0,t.formatCredentialData)(c),c};t.getHeadersAndIndexMap=(e,t)=>{const r=((e,t)=>{const r=Object.keys(t),o={};return e.forEach(((e,a)=>{const i=r.find((r=>t[r].has(e)));o[i??e]={supported:!!i,index:a}})),o})(e,u.HEADER_MAPPINGS[t]),o=Object.entries(r).reduce(((e,[t,r])=>({...e,[r.index]:r.supported?t:""})),{});return e.map(((e,t)=>({original:e,matched:o[t]??""})))};t.determineBestItemType=(e,t)=>{let r=null;const o=(0,p.getItemTypeProcessor)(t);if(o){r=o(e)}if(!r){for(const t in e)if(u.TYPE_HEADERS.has(t)&&(r=Object.keys(u.TYPE_MAPPINGS).find((r=>u.TYPE_MAPPINGS[r]?.includes(e[t].toLocaleLowerCase()))),r))break;if(!r){const t=Object.keys(e).map((e=>e.toLocaleLowerCase())),o={};Object.entries(u.HEADER_MAPPINGS).forEach((([r,a])=>{Object.values(a).forEach((a=>{o[r]=(o[r]||0)+[...a].filter((r=>t.includes(r)&&e[r])).length}))}));r=Object.keys(o).reduce(((e,t)=>o[e]>o[t]?e:t))}}return r||u.SupportedVaultTypes.NOTE};t.areHeadersValid=e=>{if(!e.length)return!1;const t=Object.values(u.HEADER_MAPPINGS);return Object.values(t).reduce(((e,t)=>[...e,...Object.values(t).map((e=>Array.from(e)))]),[]).flat().some((t=>e.includes(t)))}},61655:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifyNewImportPersonalDataStateAction=t.NOTIFY_NEW_PERSONAL_DATA_STATE=void 0,t.NOTIFY_NEW_PERSONAL_DATA_STATE="NOTIFY_NEW_PERSONAL_DATA_STATE";t.notifyNewImportPersonalDataStateAction=e=>({type:t.NOTIFY_NEW_PERSONAL_DATA_STATE,newState:e})},36784:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportDataStateReducer=void 0;const o=r(38250),a=r(61655);t.ImportDataStateReducer=(e,t)=>t.type===a.NOTIFY_NEW_PERSONAL_DATA_STATE?{state:t.newState}:e??{state:{status:o.ImportPersonalDataStateType.Idle}}},15171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateLinkedWebsitesHandler=t.areStringListsEquivalent=void 0;const o=r(53576),a=r(95623),i=r(70252),n=r(19736),s=r(88779),c=r(16298),l=r(6205),d=e=>[...new Set(e)].filter(Boolean);t.areStringListsEquivalent=(e,t)=>e.length===t.length&&e.sort().join("")===t.sort().join("");const u=(e,t,r)=>{var a;return[...(e.LinkedServices?.associated_domains??[]).filter((e=>r.includes(e.domain))),...(a=t,r.filter((e=>!a.includes(e))).map((e=>({domain:e,source:o.LinkedWebsiteSource.Manual}))))]};t.updateLinkedWebsitesHandler=async function(e,r){const{storeService:o,sessionService:p,eventLoggerService:S,applicationModulesAccess:g}=e,m=o.getState(),y=(0,n.credentialSelector)(m,r.credentialId),h=(0,l.getUserAddedLinkedWebsiteDomains)(y),v=d(r.updatedLinkedWebsitesDomainList);if((0,t.areStringListsEquivalent)(h,v))return{success:!0};const f=0===v.length?[]:u(y,h,v),A={...y.LinkedServices,associated_domains:f},P={id:r.credentialId,update:{linkedServices:A}};try{return await(0,s.updateCredential)({storeService:o,sessionService:p,eventLoggerService:S,applicationModulesAccess:g},P),{success:!0}}catch(e){const t=new Error(`[LinkedWebsites] - updateLinkedWebsitesHandler: ${e}`);return(0,a.logError)(t),(0,i.sendExceptionLog)({error:t}),{success:!1,error:c.UpdateLinkedWebsitesError.CredentialUpdateError}}}},6205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAddedLinkedWebsitesRootDomains=t.getUserAddedLinkedWebsiteDomains=t.getDashlaneDefinedLinkedWebsites=t.populateDashlaneDefinedLinkedWebsitesIndex=t.reduceLinkedDomainsLists=t.fromObjectToArray=void 0;const o=r(57282),a=r(29181),i=r(21405),n=r(21178);function s(e){const t=[];return Object.keys(e).forEach((r=>{t.push([r].concat(e[r]))})),t}t.fromObjectToArray=s;const c=(e,t)=>{const r=[],o=[];e.forEach((e=>{return a=t,e.some((e=>a.includes(e)))?r.push(e):o.push(e);var a}));const a=r.concat([t]).flat();return o.concat([a])};function l(e){const t={};return e.forEach((e=>{e.forEach((r=>{t[r]=e}))})),t}t.reduceLinkedDomainsLists=(e,t,r)=>e.concat(t,r).reduce(c,[]),t.populateDashlaneDefinedLinkedWebsitesIndex=l;const d=l((0,t.reduceLinkedDomainsLists)(o,s(i),s(a)).map((e=>[...new Set(e)])));t.getDashlaneDefinedLinkedWebsites=function(e){const t=new n.ParsedURL(e).getRootDomain();return t?d[t]||[t]:[]};t.getUserAddedLinkedWebsiteDomains=e=>(e.LinkedServices?.associated_domains??[]).map((e=>e.domain)).filter(Boolean)??[];t.getUserAddedLinkedWebsitesRootDomains=e=>(0,t.getUserAddedLinkedWebsiteDomains)(e).map((e=>new n.ParsedURL(e).getRootDomain()))},16298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateLinkedWebsitesError=void 0,function(e){e.CredentialUpdateError="credentialUpdateError"}(t.UpdateLinkedWebsitesError||(t.UpdateLinkedWebsitesError={}))},81911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(18665),a=r(85569),i=r(37215);t.config={commands:{addPasskey:{handler:i.addPasskeyHandler},updatePasskey:{handler:i.updatePasskeyHandler},deletePasskey:{handler:i.deletePasskeyHandler}},queries:{getPasskey:{selector:o.viewedPasskeySelector},getPasskeys:{selector:o.viewedQueriedPasskeysSelector},getPasskeysForDomain:{selector:o.viewedQueriedPasskeysForDomainSelector}},liveQueries:{livePasskey:{operator:a.getPasskey$},livePasskeys:{operator:a.passkeys$}}}},70863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPasskeyHandler=t.getNewPasskey=void 0;const o=r(92233),a=r(53576),i=r(23136),n=r(48313),s=r(53),c=r(78320),l=r(70252),d=r(13675);function u(e){const t=(0,s.getUnixTimestamp)();return{kwType:"KWPasskey",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:a.Country.UNIVERSAL,AnonId:(0,c.generateItemUuid)(),SpaceId:"",CreationDatetime:t,UserModificationDatetime:t,Counter:0,CredentialId:e.credentialId,ItemName:e.itemName,KeyAlgorithm:e.keyAlgorithm,Note:e.note,PrivateKey:e.privateKey,RpId:e.rpId,RpName:e.rpName,UserDisplayName:e.userDisplayName,UserHandle:e.userHandle}}t.getNewPasskey=u,t.addPasskeyHandler=async function(e,t){try{await async function({applicationModulesAccess:e,storeService:t,sessionService:r},o){if(!t.isAuthenticated())throw new Error("No session available to savePasskey");const a=u((0,d.sanitizeInputPersonalData)(o));if(!a.SpaceId){const r=await(0,i.getDefaultSpaceId)(e,t);a.SpaceId=r}t.dispatch((0,n.savePersonalDataItem)(a,a.kwType)),r.getInstance().user.persistPersonalData()}(e,t);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}},20308:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePasskeyHandler=void 0;const o=r(92233),a=r(18665),i=r(93301),n=r(23136),s=r(45291),c=r(70252),l=({storeService:e},t)=>{const r=e.getState();try{if(!e.isAuthenticated())return{success:!1,error:{code:i.DeletePasskeyErrorCode.NOT_AUTHORIZED}};const o=(0,a.passkeySelector)(r,t);if(!o)return{success:!1,error:{code:i.DeletePasskeyErrorCode.NOT_FOUND}};const n=(0,s.removePersonalItem)(o.kwType,o.Id,null);return e.dispatch(n),{success:!0}}catch(e){const t=new Error(`[Passkeys] - deletePasskey: ${e}`);return(0,c.sendExceptionLog)({error:t}),{success:!1,error:{code:i.DeletePasskeyErrorCode.INTERNAL_ERROR}}}};t.deletePasskeyHandler=function(e,{id:t}){const r=l(e,t);if(r.success){(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save)}return Promise.resolve(r)}},37215:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(70863),t),a(r(89979),t),a(r(20308),t)},89979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePasskeyHandler=t.getUpdatedPasskey=t.getPasskeyModifiedProperties=void 0;const o=r(92233),a=r(18665),i=r(23136),n=r(48313),s=r(53),c=r(70252),l=r(13675);function d(e,r){const o=(0,a.passkeySelector)(e,r.id);if(!o)throw new Error("[updatePasskey]: unable to find passkey to update.");return{...o,...(0,t.getPasskeyModifiedProperties)(r,o)}}t.getPasskeyModifiedProperties=(e,t)=>{const r=(0,s.getUnixTimestamp)();return{Counter:e.counter??t.Counter,Note:e.note??t.Note,SpaceId:e.spaceId??t.SpaceId,ItemName:e.itemName??t.ItemName,LastUse:r}},t.getUpdatedPasskey=d,t.updatePasskeyHandler=function(e,t){try{const r=function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to updatePasskey");const o=d(e.getState(),(0,l.sanitizeInputPersonalData)(r));return e.dispatch((0,n.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}(e,t);if(!r.success)return Promise.resolve(r);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,c.sendExceptionLog)({error:e}),Promise.resolve({success:!1})}}},85569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskey$=t.passkeys$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(18665);t.passkeys$=(0,i.getLivePersonalInfo)(n.getLivePasskeysSelector);t.getPasskey$=e=>{const t=(0,n.getViewedPasskeySelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},62900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskeyMappers=void 0;const o=r(83539);t.getPasskeyMappers=()=>({id:e=>e.Id,itemName:e=>e.ItemName,lastUse:o.lastUseMapper,rpId:e=>e.RpId,spaceId:e=>e.SpaceId,userDisplayName:e=>e.UserDisplayName})},96664:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("RpId"),(0,a.stringProp)("RpName"),(0,a.stringProp)("CredentialId")],t.passkeyMatch=(0,o.match)(t.searchGetters)},18665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedPasskeysForDomainSelector=t.queryPasskeysByDomainSelector=t.getPasskeysByFullDomainSelector=t.getViewedPasskeySelector=t.viewedPasskeySelector=t.getLivePasskeysSelector=t.viewedQueriedPasskeysSelector=t.queryPasskeysSelector=t.passkeyMappersSelector=t.passkeySelector=t.passkeysSelector=void 0;const o=r(16516),a=r(21178),i=r(96664),n=r(40200),s=r(24589),c=r(63566),l=r(97006),d=r(49551),u=r(32034),p=r(62900),S=e=>e.userSession.personalData.passkeys;t.passkeysSelector=S;t.passkeySelector=(e,t)=>{const r=S(e);return(0,d.findDataModelObject)(t,r)};t.passkeyMappersSelector=e=>(0,p.getPasskeyMappers)();const g=()=>i.passkeyMatch;t.queryPasskeysSelector=(0,s.getQuerySelector)(t.passkeysSelector,g,t.passkeyMappersSelector),t.viewedQueriedPasskeysSelector=(0,o.compose)((0,c.viewListResults)(n.listView),t.queryPasskeysSelector),t.getLivePasskeysSelector=(0,l.makeLiveSelectorGetter)(t.passkeysSelector,(()=>n.listView),g,t.passkeyMappersSelector);t.viewedPasskeySelector=(e,r)=>{const o=(0,t.passkeySelector)(e,r);return(0,n.detailView)(o)};t.getViewedPasskeySelector=e=>{const r=(0,u.createSelector)(t.passkeysSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,n.detailView)};t.getPasskeysByFullDomainSelector=e=>(0,u.createSelector)(t.passkeysSelector,(t=>((e,t)=>e.filter((e=>{const r=new a.ParsedURL(e.RpId).getHostname(),o=new a.ParsedURL(t).getHostname();return o===r||o.endsWith(`.${r}`)})))(t,e)));t.queryPasskeysByDomainSelector=e=>(0,s.getQuerySelector)((0,t.getPasskeysByFullDomainSelector)(e),g,t.passkeyMappersSelector);t.viewedQueriedPasskeysForDomainSelector=(e,r)=>{const o=(0,t.queryPasskeysByDomainSelector)(r.domain)(e,r);return(0,c.viewListResults)(n.listView)(o)}},93301:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeletePasskeyErrorCode=void 0,function(e){e[e.NOT_AUTHORIZED=0]="NOT_AUTHORIZED",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.INTERNAL_ERROR=2]="INTERNAL_ERROR"}(t.DeletePasskeyErrorCode||(t.DeletePasskeyErrorCode={}))},40200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailView=void 0;const o=r(82043),a=e=>({credentialId:e.CredentialId,counter:e.Counter,itemName:e.ItemName,keyAlgorithm:e.KeyAlgorithm,note:e.Note,privateKey:e.PrivateKey,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle});t.detailView=e=>({...(0,o.dataModelDetailView)(e),...a(e)});t.itemView=e=>({...(0,o.dataModelItemView)(e),...a(e)});t.listView=e=>e.map(t.itemView)},68728:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(83449),a=r(47205),i=r(58695);t.config={commands:{saveGeneratedPassword:{handler:a.saveGeneratedPasswordHandler}},queries:{getPasswordHistory:{selector:o.viewedQueriedPasswordHistorySelector},getPasswordHistoryPage:{selector:o.passwordHistoryPageSelector},getPasswordHistoryPaginationToken:{selector:o.passwordHistoryPaginationTokenSelector},getHasPasswordHistory:{selector:o.hasPasswordHistorySelector}},liveQueries:{livePasswordHistory:{operator:i.passwordHistory$},livePasswordHistoryBatch:{operator:i.passwordHistoryBatch$}}}},58695:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryBatch$=t.passwordHistory$=void 0;const o=r(18948),a=r(3343),i=r(83449),n=r(55220),s=r(35893),c=r(33627);t.passwordHistory$=(0,n.getLivePersonalInfo)(i.getLivePasswordHistorySelector);t.passwordHistoryBatch$=e=>{const t=(0,s.parseToken)(e),r=(0,i.getViewedPasswordHistoryBatchSelector)(t);return(0,o.pipe)((0,a.map)(r),(0,a.distinctUntilChanged)(c.sameBatch))}},87644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryMappers=void 0;t.getPasswordHistoryMappers=()=>({primaryInfo:e=>e.primaryInfo,timestamp:e=>e.timestamp,type:e=>e.type,id:e=>e.id,credentialId:e=>"credentialId"in e&&e.credentialId||""})},25294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryBatch=t.viewPasswordHistoryBatch=t.getPasswordHistoryFirstToken=t.getPasswordHistorySortToken=t.getPasswordHistoryFilterToken=void 0;const o=r(20553),a=r(2104),i=r(16516),n=r(83687),s=r(90451);t.getPasswordHistoryFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getPasswordHistorySortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getPasswordHistoryFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a);t.viewPasswordHistoryBatch=(e,t,r,o)=>{const i=(0,n.getSharingStatusItem)(t,r),c=(0,s.getIcon)(o);return(0,a.listView)(i,c,e)},t.getPasswordHistoryBatch=(0,i.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},36859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryItemMatch=t.searchGettersForGeneratedPassword=t.searchGettersForCredential=void 0;const o=r(82234),a=r(95175),i=r(64455),n=r(6205);t.searchGettersForCredential=[(0,o.stringProp)("primaryInfo"),(0,o.stringProp)("domain"),(0,o.stringProp)("email"),(0,o.stringProp)("login"),(0,o.stringProp)("secondaryLogin"),e=>(0,n.getDashlaneDefinedLinkedWebsites)(e.domain).join(" ")],t.searchGettersForGeneratedPassword=[(0,o.stringProp)("primaryInfo")];t.passwordHistoryItemMatch=(e,r)=>r.type===a.PasswordHistoryItemType.Credential?(0,i.match)(t.searchGettersForCredential)(e,r):(0,i.match)(t.searchGettersForGeneratedPassword)(e,r)},83449:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPasswordHistoryBatchSelector=t.passwordHistoryQuerySelector=t.passwordHistoryPaginationTokenSelector=t.passwordHistoryPageSelector=t.getLivePasswordHistorySelector=t.viewedQueriedPasswordHistorySelector=t.passwordHistoryListViewSelector=t.getPasswordHistoryMappersSelector=t.passwordHistoryMappersSelector=t.hasPasswordHistorySelector=t.passwordHistorySelector=void 0;const o=r(21178),a=r(32034),i=r(18948),n=r(24589),s=r(92598),c=r(35385),l=r(51319),d=r(36859),u=r(95175),p=r(63566),S=r(25294),g=r(87644),m=r(97006),y=r(35893),h=r(20553),v=r(80993),f=r(91210),A=r(91892),P=e=>"ChangedProperties"in e&&e.ChangedProperties.some((e=>"password"===e.toLowerCase())),b=(0,a.createSelector)(l.credentialsSelector,(e=>e.reduce(((e,t)=>e.set(t.Id,t)),new Map)));t.passwordHistorySelector=(0,a.createSelector)(s.generatedPasswordsSelector,c.credentialsHistoriesSelector,b,f.limitedSharingItemsSelector,((e,t,r,a)=>{const i=e.filter((e=>!e.AuthId)).map((e=>({type:u.PasswordHistoryItemType.Generated,primaryInfo:e.Domain??"",secondaryInfo:"",domain:e.Domain,password:e.Password,timestamp:e.GeneratedDate,id:e.Id,isProtected:!1}))),n=t.reduce(((e,t)=>{if(a[t.ObjectId]||!t.hasOwnProperty("ChangeSets"))return e;const i=r.get(t.ObjectId);if(!i)return e;const n=i?.Title,s=i?.Url,c=i?.Email,l=i?.Login,d=i?.AutoProtected||!1,p=t.ChangeSets.reduce(((e,t)=>{if(!P(t)||(void 0===(r=t.CurrentData).Email&&void 0===r.Login||void 0===r.Url||void 0===r.Password))return e;var r;const a=new o.ParsedURL(s).getRootDomain(),p={type:u.PasswordHistoryItemType.Credential,primaryInfo:(n||a)??"",secondaryInfo:(c||l)??"",domain:s||t.CurrentData.Url,password:t.CurrentData.Password,timestamp:t.ModificationDate,id:t.Id,credentialId:i?.Id,isProtected:d,spaceId:i.SpaceId,email:i?.Email??"",login:i?.Login??"",secondaryLogin:i?.SecondaryLogin??""};return e.concat(p)}),[]);return e.concat(p)}),[]);return i.concat(n)}));t.hasPasswordHistorySelector=(e,t)=>{const r=(0,f.limitedSharingItemsSelector)(e);return(0,c.credentialsHistoriesSelector)(e).some((e=>{return e.ObjectId===t&&!((o=e.ObjectId)in r&&r[o])&&e.ChangeSets.filter(P).length>0;var o}))};t.passwordHistoryMappersSelector=e=>(0,g.getPasswordHistoryMappers)();const w=(0,g.getPasswordHistoryMappers)();t.getPasswordHistoryMappersSelector=()=>w;const T=()=>d.passwordHistoryItemMatch,_=(0,n.getQuerySelector)(t.passwordHistorySelector,T,t.passwordHistoryMappersSelector);t.passwordHistoryListViewSelector=(0,a.createSelector)(v.sortedSharedItemIdsSelector,f.limitedSharingItemsSelector,A.iconsSelector,t.passwordHistorySelector,((e,t,r)=>o=>(0,S.viewPasswordHistoryBatch)(o,e,t,r)));t.viewedQueriedPasswordHistorySelector=(e,r)=>{const o=_(e,r),a=(0,t.passwordHistoryListViewSelector)(e);return(0,p.viewListResults)(a)(o)},t.getLivePasswordHistorySelector=(0,m.makeLiveSelectorGetter)(t.passwordHistorySelector,t.passwordHistoryListViewSelector,T,t.getPasswordHistoryMappersSelector);t.passwordHistoryPageSelector=(e,r)=>{const o=(0,y.parseToken)(r),{sortToken:a,filterToken:i}=o,n=(0,g.getPasswordHistoryMappers)(),s=(0,t.passwordHistoryQuerySelector)(e,{sortToken:a,filterToken:i}),c=(0,t.passwordHistoryListViewSelector)(e),l=(0,h.generateNextToken)(n,o,s),d=(0,h.generatePrevToken)(n,o,s),u=(0,h.getBatch)(n,o,s),p=(0,y.stringifyToken)(l),S=(0,y.stringifyToken)(d);return{batch:c(u),nextToken:p,prevToken:S}};t.passwordHistoryPaginationTokenSelector=(e,r)=>{const o=(0,S.getPasswordHistorySortToken)(r),a=(0,S.getPasswordHistoryFilterToken)(r),i=(0,g.getPasswordHistoryMappers)(),n={sortToken:o,filterToken:a},s=(0,t.passwordHistoryQuerySelector)(e,n),c=(0,S.getPasswordHistoryFirstToken)(i,n,r,s);return(0,y.stringifyToken)(c)};const I=(0,a.createSelector)(t.passwordHistorySelector,g.getPasswordHistoryMappers),E=(0,y.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),i.identity),C=(0,y.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),i.identity);t.passwordHistoryQuerySelector=(0,a.createSelector)(g.getPasswordHistoryMappers,T,E,C,t.passwordHistorySelector,y.queryData);t.getViewedPasswordHistoryBatchSelector=e=>{const{sortToken:r,filterToken:o}=e,i=(0,S.getPasswordHistoryBatch)(e),n=(0,a.createSelector)((e=>(0,t.passwordHistoryQuerySelector)(e,{filterToken:o,sortToken:r})),I,i),s=(0,y.optimizeBatchSelector)(n);return(0,a.createSelector)(s,v.sortedSharedItemIdsSelector,f.limitedSharingItemsSelector,A.iconsSelector,S.viewPasswordHistoryBatch)}},95175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordHistoryItemType=void 0,function(e){e.Credential="credential",e.Generated="generated"}(t.PasswordHistoryItemType||(t.PasswordHistoryItemType={}))},2104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=void 0;const o=r(95175);t.listView=(e,t,r)=>r.map((r=>r.type===o.PasswordHistoryItemType.Credential?{type:o.PasswordHistoryItemType.Credential,id:r.id,primaryInfo:r.primaryInfo,secondaryInfo:r.secondaryInfo,password:r.password,timestamp:r.timestamp,credentialId:r.credentialId,icons:t(r.domain),sharingStatus:e(r.credentialId),isProtected:r.isProtected,spaceId:r.spaceId,domain:r.domain}:{type:o.PasswordHistoryItemType.Generated,id:r.id,primaryInfo:r.primaryInfo,password:r.password,timestamp:r.timestamp}))},17025:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(58235),a=r(7408),i=r(48121);t.config={commands:{addPaymentCard:{handler:i.addPaymentCardHandler},deletePaymentCard:{handler:i.deletePaymentCardHandler},updatePaymentCard:{handler:i.updatePaymentCardHandler}},queries:{getPaymentCard:{selector:o.viewedPaymentCardSelector},getPaymentCards:{selector:o.viewedQueriedPaymentCardsSelector}},liveQueries:{livePaymentCard:{operator:a.getPaymentCard$},livePaymentCards:{operator:a.paymentCards$}}}},42262:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(9092),t)},19738:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPaymentCardHandler=t.getNewPaymentCard=void 0;const o=r(92233),a=r(53576),i=r(23136),n=r(42316),s=r(48313),c=r(53),l=r(78320),d=r(70252),u=r(13675),p=r(9092),S=r(79980);function g(e){e=(0,u.sanitizeInputPersonalData)(e);const t=(0,c.getUnixTimestamp)(),r=(0,n.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");if(!r&&!e.securityCode)throw new n.RequestError("[addPaymentCard]: refusing to add a payment card without card number or security code.",p.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return{kwType:"KWPaymentMean_creditCard",AnonId:(0,l.generateItemUuid)(),Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,n.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,n.defaultToFallbackColor)(e.color),ExpireMonth:(0,n.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,n.defaultToEmptyString)(e.expireYear),Id:(0,l.generateItemUuid)(),IssueNumber:"",Name:(0,n.defaultToEmptyString)(e.name),OwnerName:(0,n.defaultToEmptyString)(e.ownerName),CCNote:(0,n.defaultToEmptyString)(e.personalNote),LocaleFormat:a.Country.US,SecurityCode:(0,n.defaultToEmptyString)(e.securityCode),SpaceId:(0,n.defaultToEmptyString)(e.spaceId),StartYear:"",StartMonth:"",Type:(0,n.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}t.getNewPaymentCard=g;t.addPaymentCardHandler=async(e,t)=>{try{await(async({applicationModulesAccess:e,storeService:t,sessionService:r,eventLoggerService:o},a)=>{if(!t.isAuthenticated())throw new Error("No session available to addPaymentCard");const n=g(a);if(!n.SpaceId){const r=await(0,i.getDefaultSpaceId)(e,t);n.SpaceId=r}(0,S.logAddVaultItem)(t,o,n),t.dispatch((0,s.savePersonalDataItem)(n,n.kwType)),r.getInstance().user.persistPersonalData()})(e,t);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof n.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},37028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePaymentCardHandler=void 0;const o=r(92233),a=r(23136),i=r(58235),n=r(9092),s=r(70252),c=r(45291),l=r(79980),d=({storeService:e,eventLoggerService:t},r)=>{const o=e.getState();try{if(!e.isAuthenticated())return{success:!1,error:{code:n.DeletePaymentCardErrorCode.NOT_AUTHORIZED}};const a=(0,i.paymentCardSelector)(o,r);if(!a)return{success:!1,error:{code:n.DeletePaymentCardErrorCode.NOT_FOUND}};const s=(0,c.removePersonalItem)(a.kwType,a.Id,null);return e.dispatch(s),(0,l.logDeleteVaultItem)(e,t,a),{success:!0}}catch(e){const t=new Error(`[PaymentCards] - deletePaymentCard: ${e}`);return(0,s.sendExceptionLog)({error:t}),{success:!1,error:{code:n.DeletePaymentCardErrorCode.INTERNAL_ERROR}}}};t.deletePaymentCardHandler=function(e,{id:t}){const r=d(e,t);if(r.success){(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save)}return Promise.resolve(r)}},48121:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(19738),t),a(r(37028),t),a(r(65468),t)},65468:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePaymentCardHandler=t.getUpdatedPaymentCard=void 0;const o=r(92233),a=r(58235),i=r(23136),n=r(42316),s=r(48313),c=r(53),l=r(70252),d=r(13675),u=r(9092),p=r(79980);function S(e,t){if(!e)throw new n.RequestError("[updatePaymentCard]: unable to find payment card to update.",u.PaymentCardSaveResultErrorCode.NOT_FOUND);t=(0,d.sanitizeInputPersonalData)(t);const r=(0,n.defaultToEmptyString)(t.cardNumber??e.CardNumber).replace(/ /g,""),o=(0,c.getUnixTimestamp)(),a={CardNumber:r,CardNumberLastDigits:(0,n.getLastDigitsFromCardNumber)(r),Color:t.color??e.Color,ExpireMonth:t.expireMonth??e.ExpireMonth,ExpireYear:t.expireYear??e.ExpireYear,Name:t.name??e.Name,OwnerName:t.ownerName??e.OwnerName,SecurityCode:t.securityCode??e.SecurityCode,SpaceId:t.spaceId??e.SpaceId,Type:(0,n.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:o,CCNote:t.personalNote??e.CCNote},i={...e,...a};if(!r&&!i.SecurityCode)throw new n.RequestError("[updatePaymentCard]: refusing to add a payment card without card number or security code.",u.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return i}t.getUpdatedPaymentCard=S,t.updatePaymentCardHandler=function(e,t){try{!function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())throw new Error("No session available to updatePaymentCard");const i=(0,a.paymentCardSelector)(e.getState(),o.id),n=S(i,o);(0,p.logEditVaultItem)(e,r,n,i),e.dispatch((0,s.savePersonalDataItem)(n,n.kwType)),t.getInstance().user.persistPersonalData()}(e,t);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,l.sendExceptionLog)({error:e}),e instanceof n.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},42316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestError=t.getPaymentTypeFromCardNumber=t.getLastDigitsFromCardNumber=t.defaultColor=t.defaultToFallbackColor=t.defaultToEmptyString=void 0;const o=r(16516),a=r(53576);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToFallbackColor=(0,o.defaultTo)(a.PaymentCardColor.BLUE_1),t.defaultColor="BLUE_1",t.getLastDigitsFromCardNumber=function(e){const r=(0,t.defaultToEmptyString)(e).trim();return r.length>=4?r.slice(-4):""},t.getPaymentTypeFromCardNumber=function(e){if(!e)return a.PaymentCardType.PAYMENT_TYPE_VISA;const t=(e,t)=>t.some((t=>e.startsWith(t)));return e.startsWith("4")?a.PaymentCardType.PAYMENT_TYPE_VISA:t(e,["34","37"])?a.PaymentCardType.PAYMENT_TYPE_AMEX:t(e,["50","51","52","53","54","55"])?a.PaymentCardType.PAYMENT_TYPE_MASTERCARD:t(e,["6011","65"])?a.PaymentCardType.PAYMENT_TYPE_DISCOVER:t(e,["300","301","302","303","304","305","36","38"])?a.PaymentCardType.PAYMENT_TYPE_DINERSCLUB:t(e,["2123","2131","1800","3"])?a.PaymentCardType.PAYMENT_TYPE_JCB:a.PaymentCardType.PAYMENT_TYPE_MASTERCARD};class i extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=i},35834:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedPaymentCard=t.getNewPaymentCard=t.savePaymentCard=void 0;const o=r(16516),a=r(53576),i=r(95623),n=r(45291),s=r(78320),c=r(53),l=r(49551),d=r(42316),u=r(79980);function p(e){i.default.log("[Data] Creating new Payment Card");const t=(0,c.getUnixTimestamp)(),r=(0,d.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");return{kwType:"KWPaymentMean_creditCard",AnonId:(0,s.generateItemUuid)(),Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,d.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,o.defaultTo)(a.PaymentCardColor.BLUE_1,e.color),ExpireMonth:(0,d.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,d.defaultToEmptyString)(e.expireYear),Id:(0,s.generateItemUuid)(),IssueNumber:"",Name:(0,o.defaultTo)("Card",e.cardName),OwnerName:(0,d.defaultToEmptyString)(e.ownerName),CCNote:(0,d.defaultToEmptyString)(e.personalNote),LocaleFormat:a.Country.US,SecurityCode:(0,d.defaultToEmptyString)(e.securityCode),SpaceId:e.spaceId||"",StartYear:"",StartMonth:"",Type:(0,d.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}function S(e,t){const r=(0,l.findDataModelObject)(t.id,e);if(!r)return void i.default.log("Client asks to update an unknown Payment Card");i.default.log(`[Data] Updating existing Payment Card ${t.id}`);const a=(0,c.getUnixTimestamp)(),n=(0,d.defaultToEmptyString)(t.cardNumber).replace(/ /g,""),s={CardNumber:n,CardNumberLastDigits:(0,d.getLastDigitsFromCardNumber)(n),Color:t.color?t.color:r.Color,ExpireMonth:(0,d.defaultToEmptyString)(t.expireMonth),ExpireYear:(0,d.defaultToEmptyString)(t.expireYear),Name:(0,o.defaultTo)("Card",t.cardName),OwnerName:(0,d.defaultToEmptyString)(t.ownerName),SecurityCode:(0,d.defaultToEmptyString)(t.securityCode),Type:(0,d.getPaymentTypeFromCardNumber)(t.cardNumber),UserModificationDatetime:a,CCNote:(0,d.defaultToEmptyString)(t.personalNote)};return{...r,...s}}t.savePaymentCard=function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())return void i.default.log("No session available to savePaymentCard");const a=e.getPersonalData(),s=o.id?S(a.paymentCards,o):p(o);if(o.id){const t=(0,l.findDataModelObject)(s.Id,a.paymentCards);(0,u.logEditVaultItem)(e,r,s,t)}else(0,u.logAddVaultItem)(e,r,s);e.dispatch((0,n.savePaymentCard)(s)),t.getInstance().user.persistPersonalData()},t.getNewPaymentCard=p,t.getUpdatedPaymentCard=S},7408:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCard$=t.paymentCards$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(58235);t.paymentCards$=(0,i.getLivePersonalInfo)(n.getLivePaymentCardsSelector);t.getPaymentCard$=e=>{const t=(0,n.getViewedPaymentCardSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},91663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCardMappers=void 0;const o=r(83539);t.getPaymentCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>e.Name,lastUse:o.lastUseMapper,id:e=>e.Id})},38701:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paymentCardMatch=t.searchGetters=void 0;const o=r(82234),a=r(64455);t.searchGetters=[(0,o.stringProp)("Name"),(0,o.stringProp)("OwnerName")],t.paymentCardMatch=(0,a.match)(t.searchGetters)},58235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPaymentCardSelector=t.viewedPaymentCardSelector=t.getLivePaymentCardsSelector=t.viewedQueriedPaymentCardsSelector=t.queryPaymentCardsSelector=t.paymentCardMappersSelector=t.paymentCardSelector=t.paymentCardsSelector=void 0;const o=r(16516),a=r(38701),i=r(8818),n=r(24589),s=r(63566),c=r(97006),l=r(49551),d=r(32034),u=r(91663),p=r(40602),S=r(57989);t.paymentCardsSelector=(0,d.createSelector)((e=>e.userSession.personalData.paymentCards),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.paymentCardSelector=(e,r)=>{const o=(0,t.paymentCardsSelector)(e);return(0,l.findDataModelObject)(r,o)};t.paymentCardMappersSelector=e=>(0,u.getPaymentCardMappers)();const g=()=>a.paymentCardMatch;t.queryPaymentCardsSelector=(0,n.getQuerySelector)(t.paymentCardsSelector,g,t.paymentCardMappersSelector),t.viewedQueriedPaymentCardsSelector=(0,o.compose)((0,s.viewListResults)(i.listView),t.queryPaymentCardsSelector),t.getLivePaymentCardsSelector=(0,c.makeLiveSelectorGetter)(t.paymentCardsSelector,(()=>i.listView),g,t.paymentCardMappersSelector);t.viewedPaymentCardSelector=(e,r)=>{const o=(0,t.paymentCardSelector)(e,r);return(0,i.maybeDetailView)(o)};t.getViewedPaymentCardSelector=e=>{const r=(0,d.createSelector)(t.paymentCardsSelector,(t=>(0,l.findDataModelObject)(e,t)));return(0,d.createSelector)(r,i.maybeDetailView)}},9092:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeletePaymentCardErrorCode=t.PaymentCardSaveResultErrorCode=void 0,function(e){e.EMPTY_CARD_NUMBER_AND_SECURITY_CODE="EMPTY_CARD_NUMBER_AND_SECURITY_CODE",e.NOT_FOUND="NOT_FOUND"}(t.PaymentCardSaveResultErrorCode||(t.PaymentCardSaveResultErrorCode={})),function(e){e.NOT_AUTHORIZED="NOT_AUTHORIZED",e.NOT_FOUND="NOT_FOUND",e.INTERNAL_ERROR="INTERNAL_ERROR"}(t.DeletePaymentCardErrorCode||(t.DeletePaymentCardErrorCode={}))},8818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=r(42316),n=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),bank:n(e.Bank),cardNumber:n(e.CardNumber),cardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||i.defaultColor,expireMonth:n(e.ExpireMonth),expireYear:n(e.ExpireYear),issueNumber:n(e.IssueNumber),name:n(e.Name),ownerName:n(e.OwnerName),personalNote:n(e.CCNote),securityCode:n(e.SecurityCode),startMonth:n(e.StartMonth),startYear:n(e.StartYear),type:e.Type}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),cardNumber:n(e.CardNumber),cardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||i.defaultColor,expireMonth:n(e.ExpireMonth),expireYear:n(e.ExpireYear),name:n(e.Name),ownerName:n(e.OwnerName),personalNote:n(e.CCNote),type:e.Type});t.listView=e=>e.map(t.itemView)},79980:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logDeleteVaultItem=t.logAddVaultItem=t.logEditVaultItem=void 0;const o=r(92233),a=r(53576),i=r(21178),n=r(49901),s=r(53966),c=r(10770),l=r(53626),d=(e,t,r,d,u,p,S)=>{const g=e.getState(),m=(0,l.collectionsSelector)(g),y=d.SpaceId===n.PERSONAL_SPACE_ID?o.Space.Personal:o.Space.Professional,h=void 0!==p?p.map((e=>(0,s.getHermesFieldFromProperty)(d,e))).filter((e=>e)):void 0,v=s.dataModelTypeToItemType[d.kwType],f=(0,c.getCollectionNamesContainingVaultItemId)(d.Id,m).length;if(t.logEvent(new o.UserUpdateVaultItemEvent({action:r,itemId:d.Id,itemType:v,fieldsEdited:h,space:y,collectionCount:f,multiSelectId:S??void 0,updateCredentialOrigin:u})),d.kwType===a.DataModelType.KWAuthentifiant){const e=d,a=new i.ParsedURL(e.Url).getRootDomain(),n="string"==typeof a?a:"";(0,o.hashDomain)(n).then((e=>{t.logEvent(new o.AnonymousUpdateCredentialEvent({action:r,domain:{id:e,type:o.DomainType.Web},fieldList:h,space:y}))}))}};t.logEditVaultItem=(e,t,r,a,i)=>{const n=(0,s.getUpdatedProperties)(r,a);d(e,t,o.Action.Edit,r,i,n)};t.logAddVaultItem=(e,t,r,a)=>d(e,t,o.Action.Add,r,a);t.logDeleteVaultItem=(e,t,r,a,i)=>d(e,t,o.Action.Delete,r,a,void 0,i)},53966:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedProperties=t.getHermesFieldFromProperty=t.dataModelTypeToItemType=void 0;const o=r(92233),a=r(53576);t.dataModelTypeToItemType={[a.DataModelType.KWAuthentifiant]:o.ItemType.Credential,[a.DataModelType.KWSecureNote]:o.ItemType.SecureNote,[a.DataModelType.KWIdentity]:o.ItemType.Identity,[a.DataModelType.KWEmail]:o.ItemType.Email,[a.DataModelType.KWPhone]:o.ItemType.Phone,[a.DataModelType.KWAddress]:o.ItemType.Address,[a.DataModelType.KWCompany]:o.ItemType.Company,[a.DataModelType.KWPersonalWebsite]:o.ItemType.Website,[a.DataModelType.KWPaymentMean_creditCard]:o.ItemType.CreditCard,[a.DataModelType.KWBankStatement]:o.ItemType.BankStatement,[a.DataModelType.KWIDCard]:o.ItemType.IdCard,[a.DataModelType.KWSocialSecurityStatement]:o.ItemType.SocialSecurity,[a.DataModelType.KWDriverLicence]:o.ItemType.DriverLicence,[a.DataModelType.KWPassport]:o.ItemType.Passport,[a.DataModelType.KWFiscalStatement]:o.ItemType.FiscalStatement};const i={Title:o.Field.Title,FirstName:o.Field.FirstName,MiddleName:o.Field.MiddleName,LastName:o.Field.LastName,BirthDate:o.Field.BirthDate,BirthPlace:o.Field.BirthPlace,Pseudo:o.Field.Pseudo,SpaceId:o.Field.Space},n={Email:o.Field.Email,Type:o.Field.Type,EmailName:o.Field.EmailName,SpaceId:o.Field.Space},s={Number:o.Field.Number,PhoneName:o.Field.PhoneName,Type:o.Field.Type,SpaceId:o.Field.Space},c={StreetNumber:o.Field.StreetNumber,StreetName:o.Field.StreetName,StreetTitle:o.Field.StreetTitle,City:o.Field.City,State:o.Field.State,StateLevel2:o.Field.StateLevel2,StateNumber:o.Field.StateNumber,ZipCode:o.Field.ZipCode,Country:o.Field.Country,AddressName:o.Field.AddressName,Receiver:o.Field.Receiver,Building:o.Field.Building,Floor:o.Field.Floor,Door:o.Field.Door,LinkedPhone:o.Field.LinkedPhone,PersonalNote:o.Field.Note,SpaceId:o.Field.Space},l={Name:o.Field.Name,JobTitle:o.Field.JobTitle,SpaceId:o.Field.Space},d={Website:o.Field.Website,Name:o.Field.Name,SpaceId:o.Field.Space},u={Name:o.Field.Name,OwnerName:o.Field.OwnerName,CardNumber:o.Field.CardNumber,SecurityCode:o.Field.SecurityCode,ExpireMonth:o.Field.ExpireDate,ExpireYear:o.Field.ExpireDate,Color:o.Field.Color,SpaceId:o.Field.Space},p={BankAccountName:o.Field.Name,BankAccountOwner:o.Field.Owner,BankAccountBIC:o.Field.Bic,BankAccountIBAN:o.Field.Iban,BankAccountBank:o.Field.Bank,SpaceId:o.Field.Space},S={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,ExpireDate:o.Field.ExpireDate,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},g={SocialSecurityFullname:o.Field.SocialSecurityFullname,SocialSecurityNumber:o.Field.SocialSecurityNumber,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},m={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,ExpireDate:o.Field.ExpireDate,State:o.Field.State,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},y={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,DeliveryPlace:o.Field.DeliveryPlace,ExpireDate:o.Field.ExpireDate,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},h={FiscalNumber:o.Field.FiscalNumber,TeledeclarantNumber:o.Field.TeledeclarantNumber,SpaceId:o.Field.Space};t.getHermesFieldFromProperty=(e,t)=>{switch(e.kwType){case a.DataModelType.KWAuthentifiant:return((e,t)=>{switch(t){case"Email":return o.Field.Email;case"Login":return o.Field.Login;case"SecondaryLogin":return o.Field.SecondaryLogin;case"Password":return o.Field.Password;case"AutoLogin":return e.AutoLogin?o.Field.AutoLoginOn:o.Field.AutoLoginOff;case"AutoProtected":return e.AutoProtected?o.Field.MpProtectedOn:o.Field.MpProtectedOff;case"Url":return o.Field.Website;case"Category":return o.Field.Category;case"Note":return o.Field.Note;case"SubdomainOnly":return e.SubdomainOnly?o.Field.SubdomainOnlyOn:o.Field.SubdomainOnlyOff;case"Title":return o.Field.Title;case"SpaceId":return o.Field.Space}})(e,t);case a.DataModelType.KWSecureNote:return((e,t)=>{switch(t){case"Title":return o.Field.Title;case"Content":return o.Field.Content;case"Category":return o.Field.Category;case"SpaceId":return o.Field.Space;case"Secured":return e.Secured?o.Field.MpProtectedOn:o.Field.MpProtectedOff}})(e,t);case a.DataModelType.KWIdentity:return i[t];case a.DataModelType.KWEmail:return n[t];case a.DataModelType.KWPhone:return s[t];case a.DataModelType.KWAddress:return c[t];case a.DataModelType.KWCompany:return l[t];case a.DataModelType.KWPersonalWebsite:return d[t];case a.DataModelType.KWPaymentMean_creditCard:return u[t];case a.DataModelType.KWBankStatement:return p[t];case a.DataModelType.KWIDCard:return S[t];case a.DataModelType.KWSocialSecurityStatement:return g[t];case a.DataModelType.KWDriverLicence:return m[t];case a.DataModelType.KWPassport:return y[t];case a.DataModelType.KWFiscalStatement:return h[t]}};t.getUpdatedProperties=(e,t)=>Object.getOwnPropertyNames(e).filter((r=>{const o=void 0!==e[r],a=e[r]!==t[r];return o&&a}))},83539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lastUseMapper=void 0;t.lastUseMapper=e=>e.LastUse||-1},50886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePersonalDataUsageMetadata=t.addPersonalDataItem=t.makePersonalDataItem=void 0;const o=r(53576),a=r(86392),i=r(84977),n=r(87496),s=r(73566),c=r(85225),l=r(23136),d=r(70252),u=r(90503),p=r(53),S=r(95623),g=r(48313),m=r(9951),y=r(49766),h=r(29565),v=r(91494),f=r(39732),A=r(49723),P=r(72079),b=r(88542),w=r(48931),T=r(12362),_=r(86691),I=r(13675),E=r(56915),C=r(79980),D=r(49551),O=r(78163),M={[o.DataModelType.KWAddress]:{create:A.makeNewAddress,update:A.makeUpdatedAddress},[o.DataModelType.KWAuthentifiant]:{beforeChange:b.beforeCredentialChange,create:b.makeNewCredential,update:b.makeUpdatedCredential,notifySharersOnUpdate:b.notifySharersCredentialUpdated,afterSave:b.afterCredentialSaved},[o.DataModelType.KWBankStatement]:{create:w.makeNewBankAccount,update:w.makeUpdatedBankAccount},[o.DataModelType.KWCompany]:{create:m.makeNewCompany,update:m.makeUpdatedCompany},[o.DataModelType.KWEmail]:{create:y.makeNewEmail,update:y.makeUpdatedEmail},[o.DataModelType.KWIdentity]:{create:v.makeNewIdentity,update:v.makeUpdatedIdentity},[o.DataModelType.KWPersonalWebsite]:{create:h.makeNewPersonalWebsite,update:h.makeUpdatedPersonalWebsite},[o.DataModelType.KWPhone]:{create:f.makeNewPhone,update:f.makeUpdatedPhone},[o.DataModelType.KWSecureNote]:{create:P.makeNewNote,update:P.makeUpdatedNote,notifySharersOnUpdate:P.notifySharersNoteUpdated}};async function N(e,t,r){t.content||(S.default.error(`[Data] PersonalInfoItem: ${t.kwType}, has no content`),d.sendExceptionLog({message:`[makePersonalDataItem] No content found for PersonalDataItem of kwType: ${t.kwType}`,code:u.ExceptionCriticality.WARNING}),t={...t,content:{}});let o=null;if(t.content.id){const e=(0,l.getCurrentItems)(t.kwType,r);o=(0,D.findDataModelObject)(t.content.id,e)}const a=M[t.kwType];if(!a)return S.default.error(`[Data] Could not make PersonalDataItem of kwType: ${t.kwType}`),null;let i;return t=function(e){return{...e,content:(0,I.sanitizeInputPersonalData)(e.content)}}(t),a.beforeChange&&(t=a.beforeChange(t,r)),o?(i=await a.update(t,o),a.notifySharersOnUpdate&&await a.notifySharersOnUpdate(e,o,i)):i=await a.create(t),i}t.makePersonalDataItem=N,t.addPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:n},d){if(!e.isAuthenticated())return S.default.log("No session available to addPersonalDataItem"),{success:!1,itemId:""};const u=e.getPersonalData(),p=await N(e,d,u);if(!p.SpaceId){const t=await(0,l.getDefaultSpaceId)(n,e);p.SpaceId=t}if(!p)return{success:!1,itemId:""};const m=Boolean(d?.content.id);let y=null;const h=(0,T.getInstance)(),v=(0,_.getInstance)();if(m){const t=i.default[p.kwType],o=(0,D.findDataModelObject)(p.Id,u[t]);(0,C.logEditVaultItem)(e,r,p,o)}else(0,C.logAddVaultItem)(e,r,p);const f=(0,E.platformInfoSelector)(e.getState()),A=(0,s.isChangeHistoryCandidate)(p)&&m?(0,s.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:u,change:(0,c.makeUpdateChange)(p),userLogin:e.getUserLogin(),platformInfo:f}):null;if(e.dispatch((0,g.savePersonalDataItem)(p,p.kwType,A)),(0,o.isCredential)(p)){y=v.lockTopic("iconsUpdates");const t={credentialIds:[p.Id],type:"credentialUpdates"};await h.add("iconsUpdates",t),"************"===p?.Password&&(0,S.logWarn)({message:"Saving credentials using a placeholder",tag:"Credentials"});const{commands:r}=n.createClients().vaultItemsCrud;await r.emitTemporaryVaultItemEvent({ids:[p.Id],eventType:m?a.EventType.Updated:a.EventType.Created}),(0,O.shouldSendCreateOrModifiedCredentialActivityLog)(e,n,p,d.origin)&&(d.content.id?.length?await(0,O.computeAndSendModifiedCredentialActivityLog)(n,{domainUrl:d.content.url}):await(0,O.computeAndSendCreatedCredentialActivityLog)(n,{domainUrl:d.content.url}))}return M[d.kwType]?.afterSave&&M[d.kwType].afterSave(e,p),y&&v.releaseTopic("iconsUpdates",y),t.getInstance().user.persistPersonalData(),{success:!0,itemId:p.Id}},t.updatePersonalDataUsageMetadata=function(e,t,r,a){const s=i.default[a],c=(0,n.cleanUrlForPersonalData)(r),l=e.getPersonalData()[s],m=Array.isArray(l)?(0,D.findDataModelObject)(t,l):null;if(!m)return void d.sendExceptionLog({message:`[PersonalData] - updatePersonalDataUsageMetadata: No ${s} found for provided ID to update usage metadata`,code:u.ExceptionCriticality.WARNING});S.default.log(`[Data] Updating ${s} ${t} usage metadata`);const y={...m,LastUse:(0,p.getUnixTimestamp)()};if((0,o.isCredential)(y)){const{NumberUse:e,TrustedUrlGroup:t}=y;y.NumberUse=("number"==typeof e?e:0)+1,y.TrustedUrlGroup=(0,n.getUpdatedTrustedUrlList)(t,c)}e.dispatch((0,g.savePersonalDataItem)(y,a))}},13675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeInputPersonalData=void 0;const o=r(16516),a=e=>"string"==typeof e?e.replace(new RegExp("([^\t\n\r -퟿-�𐀀-􏿿])","gu"),""):e;t.sanitizeInputPersonalData=e=>(0,o.mapObjIndexed)(a,e)},72678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalDataSelector=t.personalDataItemsOfTypeSelector=void 0;const o=r(84977);t.personalDataItemsOfTypeSelector=(e,t)=>e.userSession&&e.userSession.personalData&&t.reduce(((t,r)=>t.concat(e.userSession.personalData[o.default[r]])),[]);t.personalDataSelector=e=>e.userSession&&e.userSession.personalData},49551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterDataModelObjects=t.findDataModelObject=void 0;const o=r(16516),a=r(84977);t.findDataModelObject=(e,t)=>{const r=(e||"").toUpperCase();return(t||[]).find((e=>!!e?.Id&&r===e.Id?.toUpperCase()))};t.filterDataModelObjects=(e,t,r)=>{const i=(0,o.unnest)((0,o.values)((0,o.omit)(r,(0,o.pick)(a.PERSONAL_DATA_COLLECTIONS_KEYS,e)))),n=(0,o.map)(o.toUpper,t),s=(0,o.propSatisfies)((e=>(0,o.contains)((e||"").toUpperCase(),n)),"Id");return(0,o.filter)(s,i)}},36351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(99281),a=r(11127);t.config={commands:{},queries:{getAddress:{selector:o.viewedAddressSelector},getAddresses:{selector:o.viewedQueriedAddressesSelector}},liveQueries:{liveAddress:{operator:a.getAddress$},liveAddresses:{operator:a.addresses$}}}},33230:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(1570),t)},49723:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAddressSpecificProps=t.makeNewAddress=t.makeUpdatedAddress=void 0;const o=r(16516),a=r(53576),i=r(78163),n=r(10360),s=r(53),c=r(95623);function l(e,t){const r=(0,o.defaultTo)(""),i=t.content,s=(0,n.getLocaleFormat)(e,t);return{AddressFull:r(i.addressFull),AddressName:i.addressName||r(i.addressFull),Building:r(i.building),City:r(i.city),Country:a.Country[s].toLocaleLowerCase(),DigitCode:r(i.digitCode),Door:r(i.door),Floor:r(i.floor),LinkedPhone:r(i.linkedPhone),PersonalNote:r(i.personalNote),Receiver:r(i.receiver),Stairs:r(i.stairs),State:(0,n.getValidState)(s,i.state),StateLevel2:r(i.stateLevel2),StateNumber:r(i.stateNumber),StreetName:r(i.streetName),StreetNumber:r(i.streetNumber),StreetTitle:r(i.streetTitle),ZipCode:r(i.zipCode)}}t.makeUpdatedAddress=async function(e,t){return c.default.log(`[Data] Updating existing Address with id: ${t.Id}`),{...t,...(0,i.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,s.getUnixTimestamp)()}),...l(t,e)}},t.makeNewAddress=async function(e){return c.default.log("[Data] Adding new Address"),{...(0,i.makeNewPersonalDataItemBase)(e),...l(null,e)}},t.makeAddressSpecificProps=l},11127:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAddress$=t.addresses$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(99281);t.addresses$=(0,i.getLivePersonalInfo)(n.getLiveAddressesSelector);t.getAddress$=e=>{const t=(0,n.getViewedAddressSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},83295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAddressMappers=void 0;const o=r(83539);t.getAddressMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},3179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addressMatch=t.searchGetters=void 0;const o=r(82234),a=r(64455);t.searchGetters=[(0,o.stringProp)("AddressFull"),(0,o.stringProp)("AddressName"),(0,o.stringProp)("City"),(0,o.stringProp)("Receiver"),(0,o.stringProp)("StreetNumber"),(0,o.stringProp)("ZipCode")],t.addressMatch=(0,a.match)(t.searchGetters)},99281:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedAddressSelector=t.viewedAddressSelector=t.getLiveAddressesSelector=t.viewedQueriedAddressesSelector=t.queryAddressesSelector=t.addressMappersSelector=t.addressSelector=t.addressesSelector=void 0;const o=r(16516),a=r(3179),i=r(83295),n=r(84523),s=r(63566),c=r(24589),l=r(97006),d=r(49551),u=r(32034),p=r(40602),S=r(57989);t.addressesSelector=(0,u.createSelector)((e=>e.userSession.personalData.addresses),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.addressSelector=(e,r)=>{const o=(0,t.addressesSelector)(e);return(0,d.findDataModelObject)(r,o)};t.addressMappersSelector=e=>(0,i.getAddressMappers)();const g=()=>a.addressMatch;t.queryAddressesSelector=(0,c.getQuerySelector)(t.addressesSelector,g,t.addressMappersSelector),t.viewedQueriedAddressesSelector=(0,o.compose)((0,s.viewListResults)(n.listView),t.queryAddressesSelector),t.getLiveAddressesSelector=(0,l.makeLiveSelectorGetter)(t.addressesSelector,(()=>n.listView),g,t.addressMappersSelector);t.viewedAddressSelector=(e,r)=>{const o=(0,t.addressSelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedAddressSelector=e=>{const r=(0,u.createSelector)(t.addressesSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,n.maybeDetailView)}},1570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84523:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),addressFull:i(e.AddressFull),addressName:i(e.AddressName),building:i(e.Building),city:i(e.City),country:i(e.Country),digitCode:i(e.DigitCode),door:i(e.Door),floor:i(e.Floor),linkedPhone:i(e.LinkedPhone),personalNote:i(e.PersonalNote),receiver:i(e.Receiver),stairs:i(e.Stairs),state:i(e.State),stateLevel2:i(e.StateLevel2),stateNumber:i(e.StateNumber),streetName:i(e.StreetName),streetNumber:i(e.StreetNumber),streetTitle:i(e.StreetTitle),zipCode:i(e.ZipCode)}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),addressName:i(e.AddressName),addressFull:i(e.AddressFull),city:i(e.City),streetNumber:i(e.StreetNumber),zipCode:i(e.ZipCode)});t.listView=e=>e.map(t.itemView)},34130:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(33230),t),a(r(77418),t),a(r(57755),t),a(r(75690),t),a(r(91317),t),a(r(90609),t)},72580:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(80624),a=r(81071);t.config={commands:{},queries:{getCompany:{selector:o.viewedCompanySelector},getCompanies:{selector:o.viewedQueriedCompaniesSelector}},liveQueries:{liveCompanies:{operator:a.companies$},liveCompany:{operator:a.getCompany$}}}},77418:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(79662),t)},9951:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompanySpecificProps=t.makeNewCompany=t.makeUpdatedCompany=void 0;const o=r(16516),a=r(78163),i=r(53),n=r(95623);function s(e){const t=(0,o.defaultTo)("");return{JobTitle:t(e.content.jobTitle),Name:t(e.content.name),PersonalNote:t(e.content.personalNote)}}t.makeUpdatedCompany=async function(e,t){return n.default.log(`[Data] Updating existing Company with id: ${t.Id}`),{...t,...(0,a.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,i.getUnixTimestamp)()}),...s(e)}},t.makeNewCompany=async function(e){return{...(0,a.makeNewPersonalDataItemBase)(e),...s(e)}},t.makeCompanySpecificProps=s},81071:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCompany$=t.companies$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(80624);t.companies$=(0,i.getLivePersonalInfo)(n.getLiveCompaniesSelector);t.getCompany$=e=>{const t=(0,n.getViewedCompanySelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},6628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCompanyMappers=void 0;const o=r(83539);t.getCompanyMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},76475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.companyMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("JobTitle"),(0,a.stringProp)("Name")],t.companyMatch=(0,o.match)(t.searchGetters)},80624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCompanySelector=t.viewedCompanySelector=t.getLiveCompaniesSelector=t.viewedQueriedCompaniesSelector=t.queryCompaniesSelector=t.companyMappersSelector=t.companySelector=t.companiesSelector=void 0;const o=r(16516),a=r(76475),i=r(2849),n=r(6628),s=r(63566),c=r(24589),l=r(97006),d=r(49551),u=r(32034),p=r(40602),S=r(57989);t.companiesSelector=(0,u.createSelector)((e=>e.userSession.personalData.companies),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.companySelector=(e,r)=>{const o=(0,t.companiesSelector)(e);return(0,d.findDataModelObject)(r,o)};t.companyMappersSelector=e=>(0,n.getCompanyMappers)();const g=()=>a.companyMatch;t.queryCompaniesSelector=(0,c.getQuerySelector)(t.companiesSelector,g,t.companyMappersSelector),t.viewedQueriedCompaniesSelector=(0,o.compose)((0,s.viewListResults)(i.listView),t.queryCompaniesSelector),t.getLiveCompaniesSelector=(0,l.makeLiveSelectorGetter)(t.companiesSelector,(()=>i.listView),g,t.companyMappersSelector);t.viewedCompanySelector=(e,r)=>{const o=(0,t.companySelector)(e,r);return(0,i.maybeDetailView)(o)};t.getViewedCompanySelector=e=>{const r=(0,u.createSelector)(t.companiesSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,i.maybeDetailView)}},79662:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),name:i(e.Name),jobTitle:i(e.JobTitle),personalNote:i(e.PersonalNote)}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),name:i(e.Name),jobTitle:i(e.JobTitle)});t.listView=e=>e.map(t.itemView)},64489:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(26147),a=r(99020);t.config={commands:{},queries:{getEmail:{selector:o.viewedEmailSelector},getEmails:{selector:o.viewedQueriedEmailsSelector}},liveQueries:{liveEmail:{operator:a.getEmail$},liveEmails:{operator:a.emails$}}}},57755:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(87681),t)},49766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmailSpecificProps=t.makeNewEmail=t.makeUpdatedEmail=void 0;const o=r(16516),a=r(78163),i=r(53),n=r(95623);function s(e){const t=(0,o.defaultTo)("");return{Email:t(e.content.email),EmailName:t(e.content.emailName),Type:e.content.type||"PERSO"}}t.makeUpdatedEmail=async function(e,t){return n.default.log(`[Data] Updating existing Email with id: ${t.Id}`),{...t,...(0,a.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,i.getUnixTimestamp)()}),...s(e)}},t.makeNewEmail=async function(e){return n.default.log("[Data] Adding new Email"),{...(0,a.makeNewPersonalDataItemBase)(e),...s(e)}},t.makeEmailSpecificProps=s},99020:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmail$=t.emails$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(26147);t.emails$=(0,i.getLivePersonalInfo)(n.getLiveEmailsSelector);t.getEmail$=e=>{const t=(0,n.getViewedEmailSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},16384:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailMappers=void 0;const o=r(83539);t.getEmailMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},61808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emailMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("Email"),(0,a.stringProp)("EmailName")],t.emailMatch=(0,o.match)(t.searchGetters)},26147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedEmailSelector=t.viewedEmailSelector=t.getLiveEmailsSelector=t.viewedQueriedEmailsSelector=t.queryEmailsSelector=t.emailMappersSelector=t.emailSelector=t.emailsSelector=t.countAllEmailsSelector=void 0;const o=r(16516),a=r(61808),i=r(16384),n=r(82864),s=r(63566),c=r(24589),l=r(97006),d=r(49551),u=r(32034),p=r(57989),S=r(40602);t.countAllEmailsSelector=e=>e.userSession.personalData.emails.length,t.emailsSelector=(0,u.createSelector)((e=>e.userSession.personalData.emails),p.quarantinedSpacesSelector,S.filterOutQuarantinedItems);t.emailSelector=(e,r)=>{const o=(0,t.emailsSelector)(e);return(0,d.findDataModelObject)(r,o)};t.emailMappersSelector=e=>(0,i.getEmailMappers)();const g=()=>a.emailMatch;t.queryEmailsSelector=(0,c.getQuerySelector)(t.emailsSelector,g,t.emailMappersSelector),t.viewedQueriedEmailsSelector=(0,o.compose)((0,s.viewListResults)(n.listView),t.queryEmailsSelector),t.getLiveEmailsSelector=(0,l.makeLiveSelectorGetter)(t.emailsSelector,(()=>n.listView),g,t.emailMappersSelector);t.viewedEmailSelector=(e,r)=>{const o=(0,t.emailSelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedEmailSelector=e=>{const r=(0,u.createSelector)(t.emailsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,n.maybeDetailView)}},87681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},82864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),email:i(e.Email),name:i(e.EmailName),type:e.Type||"NO_TYPE"}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),email:i(e.Email),name:i(e.EmailName),type:e.Type||"NO_TYPE"});t.listView=e=>e.map(t.itemView)},95633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(28074),a=r(50329);t.config={commands:{},queries:{getIdentities:{selector:o.viewedQueriedIdentitiesSelector},getIdentitiesCount:{selector:o.identitiesCountSelector},getIdentity:{selector:o.viewedIdentitySelector}},liveQueries:{liveIdentities:{operator:a.identities$},liveIdentitiesCount:{operator:a.identitiesCount$},liveIdentity:{operator:a.getIdentity$}}}},75690:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(10768),t)},91494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeIdentitySpecificProps=t.makeNewIdentity=t.makeUpdatedIdentity=void 0;const o=r(16516),a=r(78163),i=r(95623),n=r(53);function s(e){const t=(0,o.defaultTo)("");return{FirstName:t(e.content.firstName),MiddleName:t(e.content.middleName),LastName:t(e.content.lastName),LastName2:t(e.content.lastName2),Pseudo:t(e.content.pseudo),BirthDate:t(e.content.birthDate),BirthPlace:t(e.content.birthPlace),Title:t(e.content.title)}}t.makeUpdatedIdentity=async function(e,t){return i.Debugger.log(`[Data] Updating existing Identity with id: ${t.Id}`),{...t,...(0,a.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,n.getUnixTimestamp)()}),...s(e)}},t.makeNewIdentity=async function(e){return i.Debugger.log("[Data] Adding new Identity"),{...(0,a.makeNewPersonalDataItemBase)(e),...s(e)}},t.makeIdentitySpecificProps=s},50329:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentity$=t.identitiesCount$=t.identities$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(28074);t.identities$=(0,i.getLivePersonalInfo)(n.getLiveIdentitiesSelector);t.identitiesCount$=()=>(0,o.pipe)((0,a.map)(n.identitiesCountSelector),(0,a.distinctUntilChanged)());t.getIdentity$=e=>{const t=(0,n.getViewedIdentitySelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},15044:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityMappers=void 0;const o=r(83539);t.getIdentityMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},86052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("BirthDate"),(0,a.stringProp)("BirthPlace"),(0,a.stringProp)("FirstName"),(0,a.stringProp)("LastName"),(0,a.stringProp)("LastName2"),(0,a.stringProp)("MiddleName"),(0,a.stringProp)("Pseudo")],t.identityMatch=(0,o.match)(t.searchGetters)},28074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedIdentitySelector=t.viewedIdentitySelector=t.getLiveIdentitiesSelector=t.identitiesCountSelector=t.viewedQueriedIdentitiesSelector=t.queryIdentitiesSelector=t.identityMappersSelector=t.identitySelector=t.identitiesByIdSelector=t.identitiesSelector=void 0;const o=r(16516),a=r(86052),i=r(76652),n=r(63566),s=r(24589),c=r(97006),l=r(49551),d=r(32034),u=r(15044),p=r(40602),S=r(57989);t.identitiesSelector=(0,d.createSelector)((e=>e.userSession.personalData.identities),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems),t.identitiesByIdSelector=(0,d.createSelector)(t.identitiesSelector,(e=>e.reduce(((e,t)=>(e[t.Id]=t,e)),{})));t.identitySelector=(e,r)=>{const o=(0,t.identitiesSelector)(e);return(0,l.findDataModelObject)(r,o)};t.identityMappersSelector=e=>(0,u.getIdentityMappers)();const g=()=>a.identityMatch;t.queryIdentitiesSelector=(0,s.getQuerySelector)(t.identitiesSelector,g,t.identityMappersSelector),t.viewedQueriedIdentitiesSelector=(0,o.compose)((0,n.viewListResults)(i.listView),t.queryIdentitiesSelector);t.identitiesCountSelector=e=>e.userSession.personalData.identities?.length??0,t.getLiveIdentitiesSelector=(0,c.makeLiveSelectorGetter)(t.identitiesSelector,(()=>i.listView),g,t.identityMappersSelector);t.viewedIdentitySelector=(e,r)=>{const o=(0,t.identitySelector)(e,r);return(0,i.maybeDetailView)(o)};t.getViewedIdentitySelector=e=>{const r=(0,d.createSelector)(t.identitiesSelector,(t=>(0,l.findDataModelObject)(e,t)));return(0,d.createSelector)(r,i.maybeDetailView)}},10768:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),birthDate:i(e.BirthDate),birthPlace:i(e.BirthPlace),firstName:i(e.FirstName),lastName2:i(e.LastName2),lastName:i(e.LastName),middleName:i(e.MiddleName),pseudo:i(e.Pseudo),title:e.Title}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),birthDate:i(e.BirthDate),birthPlace:i(e.BirthPlace),firstName:i(e.FirstName),lastName2:i(e.LastName2),lastName:i(e.LastName),middleName:i(e.MiddleName),pseudo:i(e.Pseudo),title:e.Title});t.listView=e=>e.map(t.itemView)},6210:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(81473),a=r(96055);t.config={commands:{},queries:{getPersonalWebsite:{selector:o.viewedPersonalWebsiteSelector},getPersonalWebsites:{selector:o.viewedQueriedPersonalWebsitesSelector}},liveQueries:{livePersonalWebsite:{operator:a.getPersonalWebsite$},livePersonalWebsites:{operator:a.personalWebsites$}}}},91317:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(44482),t)},29565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makePersonalWebsiteSpecificProps=t.makeNewPersonalWebsite=t.makeUpdatedPersonalWebsite=void 0;const o=r(16516),a=r(78163),i=r(53),n=r(95623);function s(e){const t=(0,o.defaultTo)("");return{Website:t(e.content.website),Name:t(e.content.name)}}t.makeUpdatedPersonalWebsite=async function(e,t){return n.default.log(`[Data] Updating existing PersonalWebsite with id: ${t.Id}`),{...t,...(0,a.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,i.getUnixTimestamp)()}),...s(e)}},t.makeNewPersonalWebsite=async function(e){return n.default.log("[Data] Adding new PersonalWebsite"),{...(0,a.makeNewPersonalDataItemBase)(e),...s(e)}},t.makePersonalWebsiteSpecificProps=s},96055:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalWebsite$=t.personalWebsites$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(81473);t.personalWebsites$=(0,i.getLivePersonalInfo)(n.getLivePersonalWebsitesSelector);t.getPersonalWebsite$=e=>{const t=(0,n.getViewedPersonalWebsiteSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},93315:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalWebsiteMappers=void 0;const o=r(83539);t.getPersonalWebsiteMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},86963:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalWebsiteMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("Name"),(0,a.stringProp)("Website")],t.personalWebsiteMatch=(0,o.match)(t.searchGetters)},81473:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPersonalWebsiteSelector=t.viewedPersonalWebsiteSelector=t.getLivePersonalWebsitesSelector=t.viewedQueriedPersonalWebsitesSelector=t.queryPersonalWebsitesSelector=t.personalWebsiteMappersSelector=t.personalWebsiteSelector=t.personalWebsitesSelector=void 0;const o=r(16516),a=r(32034),i=r(86963),n=r(70024),s=r(63566),c=r(24589),l=r(97006),d=r(49551),u=r(93315),p=r(40602),S=r(57989);t.personalWebsitesSelector=(0,a.createSelector)((e=>e.userSession.personalData.personalWebsites),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.personalWebsiteSelector=(e,r)=>{const o=(0,t.personalWebsitesSelector)(e);return(0,d.findDataModelObject)(r,o)};t.personalWebsiteMappersSelector=e=>(0,u.getPersonalWebsiteMappers)();const g=()=>i.personalWebsiteMatch;t.queryPersonalWebsitesSelector=(0,c.getQuerySelector)(t.personalWebsitesSelector,g,t.personalWebsiteMappersSelector),t.viewedQueriedPersonalWebsitesSelector=(0,o.compose)((0,s.viewListResults)(n.listView),t.queryPersonalWebsitesSelector),t.getLivePersonalWebsitesSelector=(0,l.makeLiveSelectorGetter)(t.personalWebsitesSelector,(()=>n.listView),g,t.personalWebsiteMappersSelector);t.viewedPersonalWebsiteSelector=(e,r)=>{const o=(0,t.personalWebsiteSelector)(e,r);return(0,n.maybeDetailView)(o)};t.getViewedPersonalWebsiteSelector=e=>{const r=(0,a.createSelector)(t.personalWebsitesSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(r,n.maybeDetailView)}},44482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},70024:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,a.dataModelDetailView)(e),name:i(e.Name),personalNote:i(e.PersonalNote),website:i(e.Website)}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),name:i(e.Name),website:i(e.Website)});t.listView=e=>e.map(t.itemView)},14037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(82439),a=r(21264);t.config={commands:{},queries:{getPhone:{selector:o.viewedPhoneSelector},getPhones:{selector:o.viewedQueriedPhonesSelector}},liveQueries:{livePhone:{operator:a.getPhone$},livePhones:{operator:a.phones$}}}},90609:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(98013),t)},39732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePhoneNumbers=t.makePhoneSpecificProps=t.makeNewPhone=t.makeUpdatedPhone=void 0;const o=r(16516),a=r(33321),i=r(53576),n=r(78163),s=r(86056),c=r(10360),l=r(53),d=r(28445),u=r(95623);function p(e){const t=(0,o.defaultTo)(""),{Number:r,NumberInternational:a,NumberNational:n}=S(e);return{Number:r,NumberInternational:a,NumberNational:n,PersonalNote:t(e.content.personalNote),PhoneName:e.content.phoneName||n,Type:i.PhoneType[e.content.type]||i.PhoneType.PHONE_TYPE_ANY}}function S(e){const{localeFormat:t,number:r}=e.content;if(!r)return{Number:"",NumberInternational:"",NumberNational:""};const o=(0,c.isProposedLocaleLocalized)(t)&&i.Country[t]||i.Country[(0,s.getPlatformInfo)().country]||i.Country.US;if(!(o?(0,a.isValidNumber)(r,o):(0,a.isValidNumber)(r)))return{Number:(0,d.removeNonDigitCharacters)(r),NumberInternational:r,NumberNational:r};const n=(0,a.formatNumber)({country:o,phone:r},"National"),l=(0,a.formatNumber)({country:o,phone:r},"International");return{Number:(0,d.removeNonDigitCharacters)(r),NumberInternational:l,NumberNational:n}}t.makeUpdatedPhone=async function(e,t){return u.default.log(`[Data] Updating existing Phone with id: ${t.Id}`),{...t,...(0,n.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,l.getUnixTimestamp)()}),...p(e)}},t.makeNewPhone=async function(e){return u.default.log("[Data] Adding new Phone"),{...(0,n.makeNewPersonalDataItemBase)(e),...p(e)}},t.makePhoneSpecificProps=p,t.parsePhoneNumbers=S},21264:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPhone$=t.phones$=void 0;const o=r(18948),a=r(3343),i=r(55220),n=r(82439);t.phones$=(0,i.getLivePersonalInfo)(n.getLivePhonesSelector);t.getPhone$=e=>{const t=(0,n.getViewedPhoneSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())}},90076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneMappers=void 0;const o=r(83539);t.getPhoneMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},41648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.phoneMatch=t.searchGetters=void 0;const o=r(64455),a=r(82234);t.searchGetters=[(0,a.stringProp)("Number"),(0,a.stringProp)("PhoneName")],t.phoneMatch=(0,o.match)(t.searchGetters)},82439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPhoneSelector=t.viewedPhoneSelector=t.getLivePhonesSelector=t.viewedQueriedPhonesSelector=t.queryPhonesSelector=t.phoneMappersSelector=t.phoneSelector=t.phonesSelector=void 0;const o=r(16516),a=r(41648),i=r(83566),n=r(90076),s=r(63566),c=r(24589),l=r(97006),d=r(49551),u=r(32034),p=r(40602),S=r(57989);t.phonesSelector=(0,u.createSelector)((e=>e.userSession.personalData.phones),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.phoneSelector=(e,r)=>{const o=(0,t.phonesSelector)(e);return(0,d.findDataModelObject)(r,o)};t.phoneMappersSelector=e=>(0,n.getPhoneMappers)();const g=()=>a.phoneMatch;t.queryPhonesSelector=(0,c.getQuerySelector)(t.phonesSelector,g,t.phoneMappersSelector),t.viewedQueriedPhonesSelector=(0,o.compose)((0,s.viewListResults)(i.listView),t.queryPhonesSelector),t.getLivePhonesSelector=(0,l.makeLiveSelectorGetter)(t.phonesSelector,(()=>i.listView),g,t.phoneMappersSelector);t.viewedPhoneSelector=(e,r)=>{const o=(0,t.phoneSelector)(e,r);return(0,i.maybeDetailView)(o)};t.getViewedPhoneSelector=e=>{const r=(0,u.createSelector)(t.phonesSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,i.maybeDetailView)}},98013:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(16516),a=r(82043),i=(0,o.defaultTo)(""),n=e=>i(e.NumberInternational||e.NumberNational||e.Number);t.detailView=e=>({...(0,a.dataModelDetailView)(e),displayNumber:n(e),name:i(e.PhoneName),number:i(e.Number),numberInternational:i(e.NumberNational),numberNational:i(e.NumberNational),personalNote:i(e.PersonalNote),type:e.Type}),t.maybeDetailView=(0,a.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,a.dataModelItemView)(e),displayNumber:n(e),name:i(e.PhoneName),numberInternational:i(e.NumberNational),number:i(e.Number),type:e.Type});t.listView=e=>e.map(t.itemView)},55220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLivePersonalInfo=void 0;const o=r(18948),a=r(3343),i=r(35893),n=r(33627);t.getLivePersonalInfo=e=>t=>{const r=(0,i.parseToken)(t),s=e(r);return(0,o.pipe)((0,a.map)(s),(0,a.distinctUntilChanged)(((e,t)=>(0,n.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount)))}},64455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.match=void 0;const o=r(97601);t.match=e=>(t,r)=>"string"==typeof t&&0!==t.length&&e.some((e=>{const a=e(r)||"";return(0,o.normalizeString)(a).includes(t)}))},82234:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stringProp=void 0;const o=r(16516);t.stringProp=e=>(0,o.prop)(e)},63566:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewListResults=void 0;t.viewListResults=e=>({items:t,matchingCount:r})=>({items:e(t),matchingCount:r})},80529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(24465),a=r(89642),i=r(37403),n=r(90489),s=r(81043),c=r(49006),l=r(27416),d=r(32818),u=r(9124),p=r(40409);t.config={commands:{downloadSecureFile:{handler:n.downloadSecureFileHandler},deleteSecureFile:{handler:c.deleteSecureFileHandler},addSecureFile:{handler:o.addSecureFileHandler},validateSecureFile:{handler:d.validateSecureFileHandler},commitSecureFile:{handler:s.commitSecureFileHandler},initSecureFilesStorageInfo:{handler:i.initSecureFilesStorageInfoHandler},chunkTransferDone:{handler:u.chunkTransferDoneHandler},clearSecureFilesState:{handler:p.clearSecureFileStateHandler}},queries:{getSecureFilesInfoList:{selector:a.secureFileInfoSelector},getSecureFilesQuota:{selector:a.secureFilesQuotaSelector},getFileDownloadProgress:{selector:a.secureFileDownloadSelector},getFileUploadProgress:{selector:a.secureFileUploadSelector}},liveQueries:{liveFileDownloadProgress:{operator:l.getFileDownloadProgress$},liveFileUploadProgress:{operator:l.getFileUploadProgress$},liveSecureFilesQuota:{operator:l.secureFilesQuota$}}}},60802:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(86562),t)},24465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureFileHandler=t.createSecureFile=void 0;const o=r(28354),a=r(90622),i=r(16593),n=r(86562),s=r(69530),c=r(46445),l=r(65675),d=r(16038),u=r(55623),p=r(27993),S=r(20810),g=r(89642),m=r(99994),y={success:!1,error:{code:n.SecureFileResultErrorCode.SERVER_ERROR}},h=Math.pow(1024,2)/2,v=1e3,f=e=>{switch(e){case n.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED:return n.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED;case n.SecureFileResultErrorCode.QUOTA_EXCEEDED:return n.SecureFileResultErrorCode.QUOTA_EXCEEDED;default:return n.SecureFileResultErrorCode.SERVER_ERROR}},A=e=>"getAdditionalInfo"in e?{success:!1,error:{code:f(e.getAdditionalInfo().webServiceSubMessage)}}:y,P=(e,t,r,a,i,n)=>{const s=`{${(0,o.v4)()}}`,c=Math.floor(Date.now()/1e3);return{kwType:"KWSecureFileInfo",Id:s,LastBackupTime:0,CryptoKey:(0,d.bufferToBase64)(t),DownloadKey:"",Filename:a,LocalSize:e.byteLength,RemoteSize:r.byteLength,Type:i,CreationDatetime:c,UserModificationDatetime:c,Owner:n}};async function b(e,t,r,o){try{const{cryptoConfig:a}=(0,l.parsePayload)("$1$noderivation$aes256$cbchmac$16$"),i=(0,u.getRandomValues)(32),n=await(0,c.hashAndSplitKey)(i),S=(0,p.generateIV)(),g=await(0,s.encryptAES256)({key:n.aes,iv:S,clearData:e}),m={salt:null,iv:S,hash:await(0,s.signHashHmacSHA256)({key:n.hmac,data:(0,d.concatBuffers)(S,g)}),cipheredContent:g,cryptoConfig:a},y=(0,l.convertDashlaneSecureDataFlexibleToTransportableData)(m);return{success:!0,secureFileDataBuffer:y,secureFileInfo:P(e,i,y,t,r,o)}}catch(e){return{success:!1}}}t.createSecureFile=b,t.addSecureFileHandler=async function({wsService:e,storeService:t},r){const o=(0,i.userIdSelector)(t.getState());if(!(0,m.validateSecureFile)(r.fileName,r.fileType))return{success:!1,error:{code:n.SecureFileResultErrorCode.INVALID_FILE_TYPE}};let s;t.dispatch((0,S.secureFileStartUploadAction)(r.serializedContent.length)),t.dispatch((0,S.secureFileStartCipheringAction)());try{const e=JSON.parse(r.serializedContent);s=new Uint8Array(e).buffer}catch(e){return{success:!1,error:{code:n.SecureFileResultErrorCode.INTERNAL_ERROR}}}const{secureFileDataBuffer:c,secureFileInfo:l}=await b(s,r.fileName,r.fileType,o);if((0,g.secureFilesQuotaSelector)(t.getState()).remaining<c.byteLength)return{success:!1,error:{code:n.SecureFileResultErrorCode.QUOTA_EXCEEDED}};const d=setInterval((()=>{t.dispatch((0,S.secureFileUploadChunkAction)(h))}),v);let u=null;try{u=await e.secureFile.getUploadLink({contentLength:l.RemoteSize,secureFileInfoId:l.Id,login:o,uki:(0,a.ukiSelector)(t.getState())})}catch(e){return clearInterval(d),t.dispatch((0,S.secureFileUploadErrorAction)()),A(e)}return 200===u.code?(l.DownloadKey=u.content.key,await async function(e,t){try{const r=t.content.url,o=new FormData;for(const e of Object.keys(t.content.fields))o.append(e,t.content.fields[e]);return o.append("key",`${t.content.key}`),o.append("acl",`${t.content.acl}`),o.append("file",new Blob([e])),204===(await fetch(r,{method:"POST",body:o})).status}catch(e){return!1}}(c,u)?(t.dispatch((0,S.secureFileSetStorageInfoAction)(u.content.quota)),clearInterval(d),t.dispatch((0,S.secureFileUploadDoneAction)()),t.dispatch((0,S.secureFileUploadClearAction)()),{success:!0,secureFileInfo:l}):(clearInterval(d),y)):(clearInterval(d),t.dispatch((0,S.secureFileUploadErrorAction)()),y)}},9124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chunkTransferDoneHandler=void 0;const o=r(20810);t.chunkTransferDoneHandler=async function({storeService:e},t){return e.dispatch((0,o.secureFileChunkReadyAction)(t)),Promise.resolve()}},40409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearSecureFileStateHandler=void 0;const o=r(20810);t.clearSecureFileStateHandler=async function({storeService:e},t){return e.dispatch((0,o.secureFileClearAction)(t)),Promise.resolve()}},81043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commitSecureFileHandler=void 0;const o=r(90622),a=r(16593),i=r(48313);t.commitSecureFileHandler=async function({wsService:e,sessionService:t,storeService:r},{secureFileInfo:n}){if(200!==(await e.secureFile.commit({key:n.DownloadKey,secureFileInfoId:n.Id,login:(0,a.userIdSelector)(r.getState()),uki:(0,o.ukiSelector)(r.getState())})).code)return{success:!1};try{return r.dispatch((0,i.savePersonalDataItem)(n,n.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}catch(e){return{success:!1}}}},49006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSecureFileHandler=void 0;const o=r(53576),a=r(90622),i=r(76496),n=r(16593),s=r(86562),c=r(20810);t.deleteSecureFileHandler=async(e,t)=>{const{storeService:r,wsService:l,eventLoggerService:d}=e,u=r.getState(),p=(0,n.userIdSelector)(u),S=(0,a.ukiSelector)(u),g=await(0,i.deletePersonalDataItem)({storeService:r,wsService:l,eventLoggerService:d},t.id);if(!g.success&&g.reason!==o.RemovePersonalDataItemFailureReason.NOT_FOUND)return{success:!1,error:{code:s.SecureFileResultErrorCode.INTERNAL_ERROR}};let m=null;try{m=await l.secureFile.delete({login:p,uki:S,secureFileInfoId:t.id})}catch(e){return{success:!1,error:{code:s.SecureFileResultErrorCode.SERVER_ERROR}}}return g.reason===o.RemovePersonalDataItemFailureReason.NOT_FOUND?{success:!1,error:{code:s.SecureFileResultErrorCode.FILE_NOT_FOUND}}:200!==m.code?{success:!1,error:{code:s.SecureFileResultErrorCode.SERVER_ERROR}}:(r.dispatch((0,c.secureFileSetStorageInfoAction)(m.content.quota)),{success:!0})}},90489:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadSecureFileHandler=void 0;const o=r(86562),a=r(16516),i=r(20810),n=r(22349),s=r(37104),c=r(71422),l={success:!1,error:{code:o.SecureFileResultErrorCode.INTERNAL_ERROR}},d=15*Math.pow(1024,2);t.downloadSecureFileHandler=async(e,t)=>{const r=await(0,c.getDownloadLink)(e,t);if(!r)return l;const o=await(0,s.downloadFileFromStorage)(e,r,t);if(!o.success)return e.storeService.dispatch((0,i.secureFileDownloadErrorAction)(t.downloadKey)),l;e.storeService.dispatch((0,i.secureFileStartDecipheringAction)(t.downloadKey));const u=await(0,n.decipherSecureFileContent)(o.chunks,t.cryptoKey);if(null===u)return e.storeService.dispatch((0,i.secureFileDownloadErrorAction)(t.downloadKey)),l;const p=new Uint8Array(u),S=JSON.stringify(Array.from(p)),g=S.length>d?(0,a.splitEvery)(d,S):[S];return e.storeService.dispatch((0,i.secureFileChunkReadyAction)(t.downloadKey,g)),{success:!0}}},37403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSecureFilesStorageInfoHandler=void 0;const o=r(28354),a=r(90622),i=r(16593),n=r(86562),s=r(20810);t.initSecureFilesStorageInfoHandler=async function({wsService:e,storeService:t}){const r=(0,i.userIdSelector)(t.getState());let c=null;try{c=await e.secureFile.getUploadLink({contentLength:0,secureFileInfoId:(0,o.v4)(),login:r,uki:(0,a.ukiSelector)(t.getState())})}catch(e){return{success:!1,error:{code:n.SecureFileResultErrorCode.SERVER_ERROR}}}return 200===c.code?(t.dispatch((0,s.secureFileSetStorageInfoAction)(c.content.quota)),{success:!0}):(t.dispatch((0,s.secureFileSetStorageInfoAction)(null)),{success:!1})}},32818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFileHandler=void 0;const o=r(38250),a=r(99994);t.validateSecureFileHandler=async function(e,t){return(0,a.validateSecureFile)(t.fileName,t.fileType)?{success:!0}:{success:!1,error:{code:o.SecureFileResultErrorCode.INVALID_FILE_TYPE}}}},27416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFilesQuota$=t.getFileUploadProgress$=t.getFileDownloadProgress$=void 0;const o=r(18948),a=r(3343),i=r(89642);t.getFileDownloadProgress$=e=>{const t=(0,i.getSecureFileDownloadSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())};t.getFileUploadProgress$=()=>(0,o.pipe)((0,a.map)(i.secureFileUploadSelector),(0,a.distinctUntilChanged)());t.secureFilesQuota$=()=>(0,o.pipe)((0,a.map)(i.secureFilesQuotaSelector),(0,a.distinctUntilChanged)())},89642:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFilesQuotaSelector=t.getSecureFileDownloadSelector=t.secureFileUploadSelector=t.secureFileDownloadSelector=t.secureFileInfoSelector=void 0;const o=r(38250),a=r(16516);t.secureFileInfoSelector=e=>e.userSession.personalData.secureFileInfo;t.secureFileDownloadSelector=(e,t)=>{const r=e.userSession.secureFileStorageState.downloads[t];if(!r)return null;const i=r?.status===o.FileDownloadStatus.ChunkReady?{chunk:r.chunks[r.currentChunkIndex]}:{};return{...(0,a.omit)(["chunks","currentChunkIndex"],r),...i}};t.secureFileUploadSelector=e=>e.userSession.secureFileStorageState.upload;t.getSecureFileDownloadSelector=e=>r=>(0,t.secureFileDownloadSelector)(r,e);t.secureFilesQuotaSelector=e=>e.userSession.secureFileStorageState.quota},22349:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherSecureFileContent=void 0;const o=r(16038),a=r(46445),i=r(69530),n=r(65675);t.decipherSecureFileContent=async(e,t)=>{const r=(0,n.parseCipheredData)(e),s=r.cryptoConfig;if(!(0,n.isDashlaneSecureDataFlexible)(r)||!(0,n.isNoDerivation)(s.derivation))return null;const c=await(0,a.hashAndSplitKey)((0,o.base64ToBuffer)(t)),l=await(0,i.signHashHmacSHA256)({key:c.hmac,data:(0,o.concatBuffers)(r.iv,r.cipheredContent)});if((0,o.bufferToBase64)(l)!==(0,o.bufferToBase64)(r.hash))return null;return await(0,i.decryptAES256)({key:c.aes,iv:r.iv,encryptedData:r.cipheredContent})}},37104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadFileFromStorage=void 0;const o=r(20810);t.downloadFileFromStorage=async(e,t,r)=>{try{const a=await fetch(t);if(!a.ok)return{success:!1};const i=a.body.getReader(),n=[],s=a.headers.get("Content-Length");e.storeService.dispatch((0,o.secureFileStartDownloadAction)(r.downloadKey,Number.parseInt(s,10)));let c=0,l=!0,d=0;for(;l;){const{done:t,value:a}=await i.read();l=!t,l&&(n.push(new Uint8Array(a)),c+=a.length,d+=a.length,d>1e5&&(e.storeService.dispatch((0,o.secureFileDownloadChunkAction)(r.downloadKey,d)),d=0))}let u=0;const p=new Uint8Array(c);return n.forEach((e=>{p.set(e,u),u+=e.length})),{success:!0,chunks:p}}catch(e){return{success:!1}}}},71422:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDownloadLink=void 0;const o=r(90622),a=r(95623),i=r(16593),n=r(20810);t.getDownloadLink=async(e,t)=>{const{storeService:r,wsService:s}=e,c=r.getState(),l=(0,i.userIdSelector)(c),d=(0,o.ukiSelector)(c);let u=null;try{u=await s.secureFile.getDownloadLink({login:l,uki:d,key:t.downloadKey})}catch(r){return(0,a.logDebug)({tag:["SecureFile"],message:"Error while getting S3 download link",details:{error:r}}),e.storeService.dispatch((0,n.secureFileDownloadErrorAction)(t.downloadKey)),null}return 200!==u.code?(e.storeService.dispatch((0,n.secureFileDownloadErrorAction)(t.downloadKey)),null):u.content.url}},99994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFile=void 0;const o=r(98337);t.validateSecureFile=(e,t)=>{const r=e.split(".").pop().toLowerCase();return((e,t)=>"rar"===e&&!t)(r,t)||(e=>(0,o.getSecureDocumentsAllowedMimeTypes)().includes(e))(t)&&(e=>(0,o.getSecureDocumentsAllowedExtensions)().includes(`.${e}`))(r)}},86562:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileUploadStatus=t.FileDownloadStatus=t.SecureFileResultErrorCode=void 0,function(e){e.MAX_CONTENT_LENGTH_EXCEEDED="MAX_CONTENT_LENGTH_EXCEEDED",e.QUOTA_EXCEEDED="QUOTA_EXCEEDED",e.INVALID_FILE_TYPE="INVALID_FILE_TYPE",e.INTERNAL_ERROR="INTERNAL_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.FILE_NOT_FOUND="FILE_NOT_FOUND"}(t.SecureFileResultErrorCode||(t.SecureFileResultErrorCode={})),function(e){e.Initial="Initial",e.Downloading="Downloading",e.Deciphering="Deciphering",e.Error="Error",e.ChunkReady="ChunkReady",e.ChunkDownloaded="ChunkDownloaded",e.TransferComplete="TransferComplete"}(t.FileDownloadStatus||(t.FileDownloadStatus={})),function(e){e.None="None",e.Initial="Initial",e.Uploading="Uploading",e.Ciphering="Ciphering",e.Done="Done",e.Error="Error"}(t.FileUploadStatus||(t.FileUploadStatus={}))},74172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(94187);t.config={commands:{setupDefaultNoteCategories:{handler:o.setupDefaultNoteCategoriesHandler}},queries:{},liveQueries:{}}},94187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupDefaultNoteCategoriesHandler=void 0;const o=r(92233),a=r(54565),i=r(23136);t.setupDefaultNoteCategoriesHandler=async function(e,t){try{const{storeService:r,sessionService:n}=e;if(!r.isAuthenticated())return{success:!1};const s=r.getPersonalData().noteCategories;if(!s||0===s.length){t.categories.forEach((e=>{(0,a.saveNoteCategory)(r,{name:e})})),n.getInstance().user.persistPersonalData();(0,i.getDebounceSync)(r,n)({immediateCall:!0},o.Trigger.Save)}return{success:!0}}catch(e){return{success:!1}}}},54565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveNoteCategory=t.getUpdatedNoteCategory=t.getNewNoteCategory=void 0;const o=r(45291),a=r(95623),i=r(78320),n=r(49551);function s(e){return{kwType:"KWSecureNoteCategory",Id:(0,i.generateItemUuid)(),CategoryName:e.trim(),LastBackupTime:0}}function c(e,t){const r=(0,n.findDataModelObject)(t.id,e);if(!r)throw new Error("UI asks to update an unknown Note Category");return{...r,CategoryName:t.name.trim()}}t.getNewNoteCategory=s,t.getUpdatedNoteCategory=c,t.saveNoteCategory=function(e,t){if(!e.isAuthenticated())return void(0,a.logError)({message:"No session available to save note category"});const r=e.getPersonalData().noteCategories;if(!function(e,t){return"string"==typeof t&&""!==t.trim()&&!e.some((e=>e.CategoryName===t))}(r,t.name))return void(0,a.logError)({message:"Category name is invalid"});const i=t.id?c(r,t):s(t.name);return e.dispatch((0,o.saveNoteCategory)(i)),i}},80818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(81438),a=r(49293),i=r(77749);t.config={commands:{addSecureNote:{handler:a.addSecureNoteHandler},updateSecureNote:{handler:a.updateSecureNoteHandler},deleteSecureNote:{handler:a.deleteSecureNoteHandler}},queries:{getNote:{selector:o.viewedNoteSelector},getNoteCategories:{selector:o.viewedNoteCategoriesSelector},getNotes:{selector:o.viewedQueriedNotesSelector},getNotesCount:{selector:o.notesCountSelector},getNotesPage:{selector:o.notesPageSelector},getNotesPaginationToken:{selector:o.notesPaginationTokenSelector}},liveQueries:{liveNote:{operator:i.getNote$},liveNotes:{operator:i.notes$},liveNotesBatch:{operator:i.notesBatch$},liveNotesCount:{operator:i.notesCount$}}}},76707:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(13151),t)},46083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedNotes=void 0;const o=r(89489),a=r(37275);t.handleLimitedSharedNotes=function(e,t,r){const i=(0,a.getSharingDataWithCollections)(t),n=(0,o.getLimitedSharedItemIds)(t,i.collections,i.itemGroups,r);return e.map((e=>({...e,...n[e.Id]?{limitedPermissions:!0}:{}})))}},67859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureNoteHandler=t.noteFormatter=void 0;const o=r(92233),a=r(53576),i=r(23136),n=r(71141),s=r(48313),c=r(53),l=r(78320),d=r(70252),u=r(13675),p=r(79980),S=r(73566),g=r(85225),m=r(56915);t.noteFormatter=e=>{const t=(0,u.sanitizeInputPersonalData)(e),r=(0,c.getUnixTimestamp)();return{kwType:"KWSecureNote",AnonId:(0,l.generateItemUuid)(),CreationDatetime:r,Id:(0,l.generateItemUuid)(),LocaleFormat:a.Country.US,SpaceId:t.spaceId||"",UserModificationDatetime:r,LastBackupTime:0,Title:t.title||"Untitled note",Content:t.content||"",Category:t.category||"noCategory",Secured:t.secured||!1,Type:t.type||"GRAY",Attachments:t.attachments||[]}};t.addSecureNoteHandler=async(e,r)=>{try{await(async({applicationModulesAccess:e,storeService:r,sessionService:o,eventLoggerService:a},n)=>{const c=r.getPersonalData(),l=(0,t.noteFormatter)(n);if(!l.SpaceId){const t=await(0,i.getDefaultSpaceId)(e,r);l.SpaceId=t}(0,p.logAddVaultItem)(r,a,l);const d=(0,S.getUpdatedItemChangeHistory)({deviceName:r.getLocalSettings().deviceName,personalData:c,change:(0,g.makeUpdateChange)(l),userLogin:r.getUserLogin(),platformInfo:(0,m.platformInfoSelector)(r.getState())});r.dispatch((0,s.savePersonalDataItem)(l,l.kwType,d)),o.getInstance().user.persistPersonalData()})(e,r);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof n.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},5948:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSecureNoteHandler=void 0;const o=r(92233),a=r(23136),i=r(81438),n=r(13151),s=r(70252),c=r(45291),l=r(79980),d=r(36513),u=r(90622),p=r(36884),S=r(58107),g=r(71646),m=r(63698),y=r(45157),h=r(16593),v=r(52102),f=async({storeService:e,eventLoggerService:t,wsService:r},o)=>{const a=e.getState();try{let s=null;const f=(0,i.noteSelector)(a,o);if(!f)return{success:!1,error:{code:n.DeleteSecureNoteErrorCode.NOT_FOUND}};const A=await(0,d.makeCryptoService)(),P=(0,h.userLoginSelector)(a),b=(0,u.ukiSelector)(e.getState()),{makeRefuseItemGroupEvent:w}=(0,p.makeItemGroupService)(r,A),{Id:T}=f,{userGroups:_,itemGroups:I}=(0,v.sharingDataSelector)(a),E=(0,g.findItemItemGroup)(T,I);if(E){const e=(0,S.isUserLastAdmin)(E,P),t=(0,S.doesUserReceiveItemGroupViaGroup)(E,_,P);if(!(!e&&!t))return{success:!1,error:{code:e?n.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN:n.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM}};try{const{groupId:e,revision:t}=E,{refuseItemGroup:r}=(0,m.makeItemGroupWS)(),o=await w(e,t,null);await r(P,b,o)}catch(e){return{success:!1,error:{code:n.DeleteSecureNoteErrorCode.LEAVE_SHARING_FAILED}}}}s=(0,y.getRemoveChangeHistory)(e,f);const C=(0,c.removePersonalItem)(f.kwType,f.Id,s);return e.dispatch(C),(0,l.logDeleteVaultItem)(e,t,f),{success:!0}}catch(e){const t=new Error(`[SecureNotes] - deleteSecureNote: ${e}`);return(0,s.sendExceptionLog)({error:t}),{success:!1,error:{code:n.DeleteSecureNoteErrorCode.INTERNAL_ERROR}}}};t.deleteSecureNoteHandler=async function(e,{id:t}){const r=await f(e,t);if(r.success){(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save)}return Promise.resolve(r)}},49293:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(67859),t),a(r(71407),t),a(r(5948),t)},71407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateSecureNoteHandler=t.getUpdatedSecureNote=void 0;const o=r(92233),a=r(81438),i=r(23136),n=r(71141),s=r(48313),c=r(53),l=r(70252),d=r(13675),u=r(13151),p=r(79980),S=r(72079),g=r(73566),m=r(85225),y=r(56915),h=r(84511);function v(e,t){if(!e)throw new n.RequestError("[updateSecureNote]: unable to find secure note to update.",u.SecureNoteSaveResultErrorCode.NOT_FOUND);const r=(0,d.sanitizeInputPersonalData)(t),o=(0,c.getUnixTimestamp)(),a={Title:r.title??e.Title,Content:r.content??e.Content,Category:r.category??e.Category,Secured:r.secured??e.Secured,Type:r.type??e.Type,SpaceId:r.spaceId??e.SpaceId,UserModificationDatetime:o,Attachments:r.attachments??e.Attachments};return{...e,...a}}t.getUpdatedSecureNote=v,t.updateSecureNoteHandler=async function(e,t){try{!function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())throw new Error("No session available to updateSecureNote");const i=e.getPersonalData(),n=(0,a.noteSelector)(e.getState(),o.id),c=v(n,o);(0,S.notifySharersNoteUpdated)(e,n,c),(0,p.logEditVaultItem)(e,r,c,n);const l=(0,g.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:i,change:(0,m.makeUpdateChange)(c),userLogin:e.getUserLogin(),platformInfo:(0,y.platformInfoSelector)(e.getState())});e.dispatch((0,s.savePersonalDataItem)(c,c.kwType,l)),t.getInstance().user.persistPersonalData()}(e,t);const r=e.storeService.getState();if((0,h.isSharedSelector)(r,t.id))await e.sessionService.getInstance().user.attemptSync(o.Trigger.SettingsChange);else{(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save)}return Promise.resolve({success:!0})}catch(e){return(0,l.sendExceptionLog)({error:e}),e instanceof n.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},71141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatedAt=t.createdAt=t.getCategory=t.RequestError=void 0;const o=r(16516);class a extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=a,t.getCategory=(0,o.curry)(((e,t)=>e.find((e=>e.Id===t))));t.createdAt=e=>(0,o.isNil)(e.CreationDatetime)?(0,o.isNil)(e.CreationDate)?0:e.CreationDate:e.CreationDatetime;t.updatedAt=e=>(0,o.isNil)(e.UserModificationDatetime)?(0,o.isNil)(e.UpdateDate)?0:e.UpdateDate:e.UserModificationDatetime},72079:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersNoteUpdated=t.makeNoteSpecificProps=t.makeNewNote=t.makeUpdatedNote=t.sharedFields=void 0;const o=r(16516),a=r(53),i=r(70252),n=r(78163);function s(e,t){const r=t?t.CreationDate:(0,a.getUnixTimestamp)(),o=t?e.content!==t.Content?(0,a.getUnixTimestamp)():t.UpdateDate:r;return{Title:e.title||"Untitled note",Content:e.content||"",Category:e.category||"noCategory",Secured:e.secured||!1,Type:e.type||"GRAY",CreationDate:r,UpdateDate:o}}t.sharedFields=["Title","Content"],t.makeUpdatedNote=async function(e,t){return{...t,...(0,n.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,a.getUnixTimestamp)()}),...s(e.content,t)}},t.makeNewNote=async function(e){return{...(0,n.makeNewPersonalDataItemBase)(e),...s(e.content)}},t.makeNoteSpecificProps=s,t.notifySharersNoteUpdated=async function(e,r,a){!(0,o.equals)((0,o.pick)(t.sharedFields,r),(0,o.pick)(t.sharedFields,a))&&await(0,n.notifySharersOnUpdate)(e,a).catch((e=>{const t=new Error(`[Sharing] - notifySharersNoteUpdated: ${e}`);(0,i.sendExceptionLog)({error:t})}))}},77749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notes$=t.notesCount$=t.getNote$=t.notesBatch$=void 0;const o=r(18948),a=r(3343),i=r(81438),n=r(35893),s=r(55220),c=r(33627);t.notesBatch$=e=>{const t=(0,n.parseToken)(e),r=(0,i.getViewedNotesBatchSelector)(t);return(0,o.pipe)((0,a.map)(r),(0,a.distinctUntilChanged)(c.sameBatch))};t.getNote$=e=>{const t=(0,i.getViewedNoteSelector)(e);return(0,o.pipe)((0,a.map)(t),(0,a.distinctUntilChanged)())};t.notesCount$=e=>{const t=(0,n.parseToken)(e);return(0,o.pipe)((0,a.map)((e=>(0,i.notesCountSelector)(e,t))),(0,a.distinctUntilChanged)())},t.notes$=(0,s.getLivePersonalInfo)(i.getLiveNotesSelector)},3113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteMappers=void 0;const o=r(16516),a=r(71141),i=r(83539),n=r(71646),s=(0,o.curry)(((e,t)=>{const r=t.Category,o=(e||[]).find((e=>e.Id===r));return o&&o.CategoryName?o.CategoryName:"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"})),c=e=>!!e.Attachments&&e.Attachments.length>0,l=(0,o.curry)(((e,t)=>!!e[t.Id]));t.getNoteMappers=(e,t,r)=>({category:s(e),groupIds:e=>(0,n.getItemUserGroupIds)(r,e.Id),sharingUserIds:e=>(0,n.getItemUserIds)(r,e.Id),createdAt:a.createdAt,hasAttachments:c,id:e=>e.Id,isLimited:l(t),lastUse:i.lastUseMapper,spaceId:e=>e.SpaceId,title:e=>e.Title,updatedAt:a.updatedAt})},93534:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNotesBatch=t.viewNotesBatch=t.getNotesFirstToken=t.getNotesSortToken=t.getNotesFilterToken=void 0;const o=r(16516),a=r(20553),i=r(80010),n=r(83687),s=r(71141);t.getNotesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getNotesSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getNotesFirstToken=(e,t,r,o)=>(0,a.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewNotesBatch=(e,t,r,o)=>{const a=(0,n.getSharingStatusItem)(t,r),c=(0,s.getCategory)(o);return(0,i.listView)(a,c,e)},t.getNotesBatch=(0,o.curry)(((e,t,r)=>(0,a.getBatch)(r,e,t)))},55498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noteMatch=t.searchGetters=t.limitedSearchGetters=void 0;const o=r(64455),a=r(82234);t.limitedSearchGetters=[(0,a.stringProp)("Title")],t.searchGetters=[...t.limitedSearchGetters,(0,a.stringProp)("Content")];t.noteMatch=(e,r)=>{const a=r.Secured?t.limitedSearchGetters:t.searchGetters;return(0,o.match)(a)(e,r)}},81438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesCountSelector=t.viewedQueriedNotesSelector=t.queryNotesSelector=t.getViewedNoteSelector=t.getLiveNotesSelector=t.getViewedNotesBatchSelector=t.notesQuerySelector=t.fieldMappersSelector=t.viewedNoteCategoriesSelector=t.notesPaginationTokenSelector=t.notesPageSelector=t.viewedNoteSelector=t.noteSelector=t.noteCategoriesSelector=void 0;const o=r(16516),a=r(32034),i=r(93534),n=r(3113),s=r(23875),c=r(20553),l=r(35893),d=r(91210),u=r(80993),p=r(49551),S=r(55498),g=r(24589),m=r(63566),y=r(52102),h=r(16593),v=r(97006),f=r(26703),A=r(75705),P=r(89698);t.noteCategoriesSelector=e=>e.userSession.personalData.noteCategories;t.noteSelector=(e,t)=>{const r=(0,A.notesSelector)(e);return(0,p.findDataModelObject)(t,r)};t.viewedNoteSelector=(e,r)=>{const o=(0,t.noteSelector)(e,r);if(!o)return;const a=(0,t.noteCategoriesSelector)(e),i=(0,y.sharingDataSelector)(e),n=(0,h.userIdSelector)(e),c=(0,d.limitedSharingItemsSelector)(e);return(0,s.viewNote)(o,i,n,c,a)};t.notesPageSelector=(e,r)=>{const o=(0,l.parseToken)(r),{sortToken:a,filterToken:i}=o,n={sortToken:a,filterToken:i},s=(0,t.fieldMappersSelector)(e),d=(0,t.notesQuerySelector)(e,n),u=_(e),p=(0,c.generateNextToken)(s,o,d),S=(0,c.generatePrevToken)(s,o,d),g=(0,c.getBatch)(s,o,d),m=(0,l.stringifyToken)(p),y=(0,l.stringifyToken)(S);return{batch:u(g),nextToken:m,prevToken:y}};t.notesPaginationTokenSelector=(e,r)=>{const o=(0,i.getNotesSortToken)(r),a=(0,i.getNotesFilterToken)(r),n=(0,t.fieldMappersSelector)(e),s={sortToken:o,filterToken:a},c=(0,t.notesQuerySelector)(e,s),d=(0,i.getNotesFirstToken)(n,s,r,c);return(0,l.stringifyToken)(d)},t.viewedNoteCategoriesSelector=(0,a.createSelector)(t.noteCategoriesSelector,(e=>({items:(0,f.listView)(e),matchingCount:e.length}))),t.fieldMappersSelector=(0,a.createSelector)(t.noteCategoriesSelector,d.limitedSharingItemsSelector,P.acceptedItemGroupsSelector,n.getNoteMappers);const b=(0,l.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity),w=(0,l.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity),T=()=>S.noteMatch;t.notesQuerySelector=(0,a.createSelector)(t.fieldMappersSelector,T,b,w,A.notesSelector,l.queryData);t.getViewedNotesBatchSelector=e=>{const{sortToken:r,filterToken:o}=e,n={sortToken:r,filterToken:o},s=(0,i.getNotesBatch)(e),c=(0,a.createSelector)((e=>(0,t.notesQuerySelector)(e,n)),t.fieldMappersSelector,s),p=(0,l.optimizeBatchSelector)(c);return(0,a.createSelector)(p,u.sortedSharedItemIdsSelector,d.limitedSharingItemsSelector,t.noteCategoriesSelector,i.viewNotesBatch)};const _=e=>{const r=(0,u.sortedSharedItemIdsSelector)(e),o=(0,d.limitedSharingItemsSelector)(e),a=(0,t.noteCategoriesSelector)(e);return e=>(0,i.viewNotesBatch)(e,r,o,a)};t.getLiveNotesSelector=(0,v.makeLiveSelectorGetter)(A.notesSelector,_,T,t.fieldMappersSelector);t.getViewedNoteSelector=e=>{const r=(0,a.createSelector)(A.notesSelector,(t=>(0,p.findDataModelObject)(e,t)));return(0,a.createSelector)(r,y.sharingDataSelector,h.userIdSelector,d.limitedSharingItemsSelector,t.noteCategoriesSelector,s.viewNote)},t.queryNotesSelector=(0,g.getQuerySelector)(A.notesSelector,T,t.fieldMappersSelector);t.viewedQueriedNotesSelector=(e,r)=>{const o=(0,t.queryNotesSelector)(e,r),a=_(e);return(0,m.viewListResults)(a)(o)},t.notesCountSelector=(0,a.createSelector)(t.fieldMappersSelector,T,w,A.notesSelector,((e,t,r,o)=>(0,l.filterData)(e,t,r,o).length))},75705:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesSelector=void 0;const o=r(32034),a=r(40602),i=r(57989);t.notesSelector=(0,o.createSelector)((e=>e.userSession.personalData.notes),i.quarantinedSpacesSelector,a.filterOutQuarantinedItems)},13151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteSecureNoteErrorCode=t.SecureNoteSaveResultErrorCode=void 0,function(e){e.NOT_FOUND="NOT_FOUND"}(t.SecureNoteSaveResultErrorCode||(t.SecureNoteSaveResultErrorCode={})),function(e){e.NOT_FOUND="NOT_FOUND",e.INTERNAL_ERROR="INTERNAL_ERROR",e.LEAVE_SHARING_FAILED="LEAVE_SHARING_FAILED",e.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN="LEAVE_SHARING_FORBIDDEN_LAST_ADMIN",e.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM="LEAVE_SHARING_FORBIDDEN_GROUP_ITEM"}(t.DeleteSecureNoteErrorCode||(t.DeleteSecureNoteErrorCode={}))},23875:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewNote=void 0;const o=r(83687),a=r(71141),i=r(83881);t.viewNote=function(e,t,r,n,s){if(!e)return;const c=(0,o.getSharingStatusDetail)(n,t,r),l=(0,a.getCategory)(s);return(0,i.detailView)(c,l,e)}},26703:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const o=(0,r(16516).defaultTo)("");t.detailView=e=>{if(e)return{id:e.Id,categoryName:o(e.CategoryName)}};t.listView=e=>e.map(t.detailView)},83881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const o=r(16516),a=r(82043),i=r(26703),n=r(71141),s=(0,o.defaultTo)("");t.detailView=(0,o.curry)(((e,t,r)=>{const c=t(r.Category);return{...(0,a.dataModelDetailView)(r),category:(0,i.detailView)(c),color:r.Type,content:s(r.Content),createdAt:(0,n.createdAt)(r),secured:(0,o.defaultTo)(!1,r.Secured),sharingStatus:e(r.Id),title:s(r.Title),updatedAt:(0,n.updatedAt)(r)}}))},80010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=r(16516),a=r(82043),i=r(26703),n=r(71141),s=(0,o.defaultTo)("");t.itemView=(0,o.curry)(((e,t,r)=>{const o=t(r.Category),c=r.Secured?"*******":(e=>{if(e.length>30)return e.slice(0,27)+"…"})(s(r.Content));return{...(0,a.dataModelItemView)(r),abbrContent:c,category:(0,i.detailView)(o),color:r.Type,createdAt:(0,n.createdAt)(r),secured:r.Secured||!1,sharingStatus:e(r.Id),title:s(r.Title),updatedAt:(0,n.updatedAt)(r)}}));t.listView=(e,r,o)=>{const a=(0,t.itemView)(e,r);return o.map(a)}},60309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(43767),a=r(16593),i=r(64717),n=r(17250);t.config={commands:{updateProtectPasswordsSetting:{handler:n.updateProtectPasswordsSettingHandler},toggleDashlane:{handler:n.toggleDashlaneHandler},updateAutofillSettings:{handler:n.updateAutofillSettingsHandler}},queries:{getAnonymousUserId:{selector:o.anonymousUserIdSelector},getIsUrlBanished:{selector:o.getIsUrlBanishedSelector},arePasswordsProtected:{selector:a.protectPasswordsSettingSelector}},liveQueries:{liveArePasswordsProtected:{operator:i.protectPasswordsSetting$}}}},17250:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAutofillSettingsHandler=t.toggleDashlaneHandler=t.updateProtectPasswordsSettingHandler=void 0;const o=r(92233),a=r(70252),i=r(90503),n=r(23136),s=r(29954),c=r(86903),l=r(68857);t.updateProtectPasswordsSettingHandler=(e,t)=>{try{const r={ProtectPasswords:t};return(0,s.updatePersonalSettings)(e.storeService,e.sessionService,r),(0,c.sendUserSettingsLog)(e),Promise.resolve()}catch(e){const t=new Error(`updateProtectPasswordsSettingHandler: ${e}`);(0,a.sendExceptionLog)({error:t,code:i.ExceptionCriticality.WARNING})}};t.toggleDashlaneHandler=({sessionService:e,storeService:t},r)=>{const a=(0,n.getDebounceSync)(t,e),i=t.getPersonalSettings(),c=(0,l.toggleDashlaneOnSiteToPersonalSettingsPartial)(i,r);(0,s.updatePersonalSettings)(t,e,c),a({immediateCall:!0},o.Trigger.SettingsChange)};t.updateAutofillSettingsHandler=({sessionService:e,storeService:t},r)=>{const a=(0,n.getDebounceSync)(t,e);(0,s.updatePersonalSettings)(t,e,{AutofillSettings:r.AutofillSettings}),a({immediateCall:!0},o.Trigger.SettingsChange)}},64717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectPasswordsSetting$=void 0;const o=r(18948),a=r(3343),i=r(16593);t.protectPasswordsSetting$=()=>(0,o.pipe)((0,a.map)(i.protectPasswordsSettingSelector),(0,a.distinctUntilChanged)())},91315:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(80518),t)},68857:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleDashlaneOnSiteToPersonalSettingsPartial=void 0;const o=r(16516),a=r(21178);t.toggleDashlaneOnSiteToPersonalSettingsPartial=function(e,t){const r=new a.ParsedURL(t.url).getRootDomain();let i=e.AutofillSettings;return i={...i,disabledDomains:t.autofill?(0,o.without)([r],e.AutofillSettings.disabledDomains):(0,o.uniq)(e.AutofillSettings.disabledDomains.concat(r))},{AutofillSettings:i}}},29954:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pickUpdatedPersonalSettings=t.isSaveCredentialDisabledOnDomain=t.signalSaveCredentialDisabled=t.updatePersonalSettings=void 0;const o=r(21178),a=r(95623),i=r(16516),n=r(27517);t.updatePersonalSettings=function(e,r,o){if(!e.isAuthenticated())return void a.default.log("No session available to updatePersonalSettings");const i=(0,t.pickUpdatedPersonalSettings)(e.getPersonalSettings(),o);e.dispatch((0,n.editPersonalSettings)(i)),r.getInstance().user.persistPersonalSettings()},t.signalSaveCredentialDisabled=function(e,t,r){if(!e.isAuthenticated())return void a.default.log("No session available, in theory this should not be called");const o=Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[];o.indexOf(r.fullDomain)>0||(e.dispatch((0,n.editPersonalSettings)({BanishedUrlsList:[...o,r.fullDomain]})),t.getInstance().user.persistPersonalSettings())},t.isSaveCredentialDisabledOnDomain=function(e,t){return e.isAuthenticated()?(Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[]).map((e=>new o.ParsedURL(e))).some((e=>e.getHostname()===t.fullDomain)):(a.default.log("No session available, save credential is enabled by default"),!1)};t.pickUpdatedPersonalSettings=(e,t)=>{const r=(0,i.pick)(Object.keys(t))(e),o=(0,i.unapply)(i.identity);return(0,i.mergeAll)((0,i.difference)(o(t),o(r)))}},43767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIsUrlBanishedSelector=t.banishedUrlsListSelector=t.securedDataAutofillCreditcardSelector=t.anonymousUserIdSelector=void 0;const o=r(21178),a=r(16593);t.anonymousUserIdSelector=e=>e.userSession.personalSettings.AnonymousUserId;t.securedDataAutofillCreditcardSelector=e=>{const t=e.userSession.personalSettings.SecuredDataAutofillCreditcard;return"boolean"!=typeof t||t};t.banishedUrlsListSelector=e=>(0,a.personalSettingsSelector)(e).BanishedUrlsList??[];t.getIsUrlBanishedSelector=(e,r)=>{const a=new o.ParsedURL(r).getHostname();return(0,t.banishedUrlsListSelector)(e).map((e=>new o.ParsedURL(e).getHostname())).some((e=>e===a))}},80518:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AutofillOptions=t.AnalysisDisabledStatus=void 0,function(e){e.ANALYSIS_ENABLED="ANALYSIS_ENABLED",e.ANALYSIS_DISABLED_BY_USER="ANALYSIS_DISABLED_BY_USER",e.ANALYSIS_DISABLED_BY_B2B_ADMIN="ANALYSIS_DISABLED_BY_B2B_ADMIN",e.ANALYSIS_DISABLED_BY_KILLSWITCH="ANALYSIS_DISABLED_BY_KILLSWITCH",e.ANALYSIS_DISABLED_BY_2FA_ENFORCEMENT="ANALYSIS_DISABLED_BY_2FA_ENFORCEMENT"}(t.AnalysisDisabledStatus||(t.AnalysisDisabledStatus={})),function(e){e.ANALYSIS_ENABLED_ON_ALL_FORMS="ANALYSIS_ENABLED_ON_ALL_FORMS",e.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS="ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS"}(t.AutofillOptions||(t.AutofillOptions={}))},68979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TeamDomainsMatchResult=void 0;r(84977);!function(e){e[e.SomeFieldsMatch=0]="SomeFieldsMatch",e[e.NoFieldMatch=1]="NoFieldMatch"}(t.TeamDomainsMatchResult||(t.TeamDomainsMatchResult={}))},11700:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isItemToForceCategorize=t.isItemForceCategorizable=t.pickBestTeamSpaceForForcedCategorization=t.ForceCategorizableKWTypes=t.isTeamSpaceAfterGracePeriod=t.isTeamSpaceQuarantined=void 0;const o=r(16516),a=r(53576),i=r(68979),n=r(87496),s=r(43145),c=r(6205),l=(e,t)=>(t||[]).some((t=>{if("string"!=typeof t)return!1;const r=t.toLowerCase();return(e||[]).some((e=>"string"==typeof e&&e.toLowerCase().includes(r)))})),d=e=>[e.Login,e.SecondaryLogin,e.Email,(0,n.getBestUrl)(e),...(0,c.getUserAddedLinkedWebsiteDomains)(e)],u=(e,t)=>{const r=[e.Domain],o=(0,s.findAssociatedCredential)(e,t);return[...r,...o?d(o):[]]},p={[a.DataModelType.KWAuthentifiant]:d,[a.DataModelType.KWGeneratedPassword]:u,[a.DataModelType.KWEmail]:e=>[e.Email]};function S(e){const t=p[e.kwType];return t?t(e):[]}t.isTeamSpaceQuarantined=e=>"revoked"===e.status;t.isTeamSpaceAfterGracePeriod=e=>(0,t.isTeamSpaceQuarantined)(e)&&Boolean(e.shouldDelete),t.ForceCategorizableKWTypes=[a.DataModelType.KWAuthentifiant,a.DataModelType.KWEmail,a.DataModelType.KWGeneratedPassword];t.pickBestTeamSpaceForForcedCategorization=(e,r,n)=>{const s=r.SpaceId,c=(0,a.isGeneratedPassword)(r)?u(r,n):S(r),d=e.reduce(((e,t)=>{const r=l(c,t.info.teamDomains);return{...e,[t.teamId]:r}}),{}),p=e.filter((e=>d[e.teamId]||(0,t.isTeamSpaceQuarantined)(e)&&e.teamId===s)),[g,m]=(0,o.partition)(t.isTeamSpaceQuarantined,p),[y,h]=(0,o.partition)(t.isTeamSpaceAfterGracePeriod,g),[v,f]=(0,o.partition)((e=>t=>e.SpaceId===t.teamId)(r),m),A=[...y,...h,...v,...f];if(0===A.length)return null;const P=A[0];return P.teamId!==r.SpaceId||(0,t.isTeamSpaceQuarantined)(P)?{teamSpace:P,domainsMatchResult:d[P.teamId]?i.TeamDomainsMatchResult.SomeFieldsMatch:i.TeamDomainsMatchResult.NoFieldMatch}:null},t.isItemForceCategorizable=function(e){return e.kwType in p};t.isItemToForceCategorize=(e,t)=>{if(!t?.info)return!1;const{forcedDomainsEnabled:r,teamDomains:o}=t.info;if(!r)return!1;const a=S(e);return l(a,o)}},57989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.quarantinedSpacesSelector=t.forceCategorizableItemsSelector=t.spacesWithForcedCategorizationEnabledSelector=void 0;const o=r(32034),a=r(7944),i=r(11700),n=r(95458),s=r(72678);t.spacesWithForcedCategorizationEnabledSelector=e=>(e.userSession?.spaceData?.spaces||[]).filter((e=>e?.details?.info&&Array.isArray(e.details.info.teamDomains)&&e.details.info.teamDomains.length>0&&Boolean(e.details.info.forcedDomainsEnabled)));t.forceCategorizableItemsSelector=e=>(0,s.personalDataItemsOfTypeSelector)(e,i.ForceCategorizableKWTypes),t.quarantinedSpacesSelector=(0,o.createSelector)(a.spacesSelector,(e=>e.filter(n.isQuarantined)))},92307:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSmartCategorizedSpace=t.getCategory=void 0;const o=r(16516),a=r(52578);t.getCategory=(0,o.curry)(((e,t)=>e.find((e=>e.Id===t))));t.getSmartCategorizedSpace=e=>t=>{const r=(e=>e.filter((e=>"accepted"===e.details?.status&&e.details?.info?.forcedDomainsEnabled)))(e),o=r?.[0]?.details?.info?.teamDomains??[];return(0,a.isCredentialSmartCategorized)(t,o)?r[0]:null}},76226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTeamSpaceContentControlRules=void 0;const o=r(53576),a=r(70252),i=r(45291),n=r(24525),s=r(45962),c=r(90622);async function l(e,t,r){const{updates:o,deletions:a,changeHistories:n}=r,s=o.length>0,c=function({deletions:e}){return Object.keys(e).reduce(((t,r)=>t+e[r].length),0)}(r)>0;(s||c)&&(t.dispatch((0,i.teamSpaceContentControlApplied)(o,a,n)),await e.getInstance().user.persistPersonalData())}t.applyTeamSpaceContentControlRules=async function(e,t,r,i,d){try{const a=(0,n.teamSpaceContentControlStateSelector)(r.getState()),u=(0,s.controlTeamSpacesContent)(a),p=u.deletions.KWAuthentifiant||[],S=u.updates.filter(o.isCredential).map((e=>e.Id)),g=u.hiddenItemIds,m=[...p,...S,...g];await l(t,r,u);if(function(e,t,r){const o=e.getUserLogin(),a=(0,c.ukiSelector)(e.getState());r.forEach((e=>{t.teamPlans.spaceDeleted({login:o,uki:a,teamId:Number(e.teamId)})}))}(r,i,a.spaces.filter((e=>e.details.shouldDelete))),function(e,t){const{deletions:r,hiddenItemIds:o,updates:a}=t,i={deletedItemIds:Object.keys(r).reduce(((e,t)=>[...e,...r[t]]),[]),hiddenItemIds:o,updatedItemIds:a.map((e=>e.Id))};e.teamSpaceContentControlDone(i)}(e,u),m.length>0){const{commands:{recalculatePasswordHealth:e}}=d.createClients().passwordHealth;e()}}catch(e){const t=new Error(`[Spaces] - runTeamSpaceContentControlJob: ${e}`);(0,a.sendExceptionLog)({error:t})}}},45962:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.controlTeamSpacesContent=void 0;const o=r(53576),a=r(17825),i=r(49901),n=r(68979),s=r(11700),c=r(73566),l=r(85225);function d(e,t){return{...e,SpaceId:t}}function u(e,t,r,s){const{domainsMatchResult:u}=t;switch(u){case n.TeamDomainsMatchResult.SomeFieldsMatch:return function(e,t,r){const{deletions:a,changeHistories:i}=t,{deviceName:n,login:s,personalData:d,platformInfo:u}=e,{kwType:p}=r,S=(0,o.isCredential)(r)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeRemovalChange)(r),deviceName:n,personalData:d,userLogin:s,platformInfo:u}):null;return{...t,deletions:{...a,[p]:a[p].concat(r.Id)},changeHistories:S?i.concat(S):i}}(e,s,r);case n.TeamDomainsMatchResult.NoFieldMatch:return function(e,t,r){const{updates:a,changeHistories:n}=t,{deviceName:s,login:u,personalData:p,platformInfo:S}=e,g=d(r,i.PERSONAL_SPACE_ID),m=(0,o.isCredential)(g)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(g),deviceName:s,personalData:p,userLogin:u,platformInfo:S}):null;return{...t,updates:a.concat(g),changeHistories:m?n.concat(m):n}}(e,s,r);default:return(0,a.assertUnreachable)(u)}}const p=e=>e.info.removeForcedContentEnabled&&e.shouldDelete;function S(e,t,r){const a=e.spaces.map((e=>e.details)),i=(0,s.pickBestTeamSpaceForForcedCategorization)(a,r,e.credentials);if(!i)return t;const{teamSpace:S}=i,{status:g}=S;switch(g){case"accepted":return function(e,t,r,a){const{updates:i,changeHistories:n}=t,{teamId:s}=r,{deviceName:u,login:p,personalData:S,platformInfo:g}=e,m=d(a,s),y=(0,o.isCredential)(m)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(m),deviceName:u,personalData:S,userLogin:p,platformInfo:g}):null;return{...t,updates:i.concat(m),changeHistories:y?n.concat(y):n}}(e,t,S,r);case"revoked":return function(e,t,r,o){const{teamSpace:a,domainsMatchResult:i}=t,{hiddenItemIds:s}=o;return{...p(a)?u(e,t,r,o):o,hiddenItemIds:i===n.TeamDomainsMatchResult.SomeFieldsMatch?[...s,r.Id]:s}}(e,i,r,t);default:return t}}t.controlTeamSpacesContent=function(e){const t={deletions:{KWAuthentifiant:[],KWEmail:[],KWGeneratedPassword:[]},updates:[],changeHistories:[],hiddenItemIds:[]};return 0===e.spaces.length?t:e.items.reduce(((t,r)=>S(e,t,r)),t)}},24525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamSpaceContentControlStateSelector=void 0;const o=r(56915),a=r(16593),i=r(73299),n=r(72678),s=r(7944),c=r(92598),l=r(26147),d=r(74380),u=r(83659),p=r(57989),S=e=>({KWAuthentifiant:(0,d.countAllCredentialsSelector)(e),KWEmail:(0,l.countAllEmailsSelector)(e),KWGeneratedPassword:(0,c.countAllGeneratedPasswordsSelector)(e)});t.teamSpaceContentControlStateSelector=e=>({anonymousSpaceIds:(0,s.anonymousSpaceIdsSelector)(e),credentials:(0,u.unsafeAllCredentialsSelector)(e),itemCountByType:S(e),items:(0,p.forceCategorizableItemsSelector)(e),spaces:(0,p.spacesWithForcedCategorizationEnabledSelector)(e),personalData:(0,n.personalDataSelector)(e),platformInfo:(0,o.platformInfoSelector)(e),login:(0,a.userLoginSelector)(e),deviceName:(0,i.deviceNameSelector)(e)})},67631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(76226);t.setupSubscriptions=async function(e,t){const{sessionService:r,storeService:a,wsService:i,applicationModulesAccess:n}=t;e.sessionOpened.on((()=>{(0,o.applyTeamSpaceContentControlRules)(e,r,a,i,n)}))}},45665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(7944);t.config={commands:{},queries:{getSpace:{selectorFactory:async e=>(await(0,o.makeSpacesSelectors)(e)).viewedSpaceSelector},getSpaces:{selectorFactory:async e=>(await(0,o.makeSpacesSelectors)(e)).viewedSpacesSelector}},liveQueries:{}}},52490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},77163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.associateTeamSpaceId=void 0;const o=r(11700),a=e=>e.filter((e=>e.info.forcedDomainsEnabled&&e.info.teamDomains.length&&!(0,o.isTeamSpaceQuarantined)(e)));t.associateTeamSpaceId=function(e,t,r){if(!(0,o.isItemForceCategorizable)(e)||!t||0===t.length)return e;const i=a(t);if(!i.length)return e;const n=(0,o.pickBestTeamSpaceForForcedCategorization)(i,e,r);return n?{...e,SpaceId:n.teamSpace.teamId}:e}},49901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_SPACE_ID=void 0,t.PERSONAL_SPACE_ID=""},69105:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultPersonalSpace=t.isSpaceItem=void 0;const o=r(53576),a=r(49901);t.isSpaceItem=e=>"SpaceId"in e&&"string"==typeof e.SpaceId;t.getDefaultPersonalSpace=()=>({associatedEmail:null,billingAdmins:[],color:"",companyName:null,info:{name:"",forcedDomainsEnabled:!1,teamDomains:[]},invitationDate:null,isBillingAdmin:!1,isSSOUser:!1,isTeamAdmin:!1,joinDate:null,letter:"",membersNumber:null,planType:null,revokeDate:null,status:o.SpaceStatus.Accepted,teamAdmins:[],teamId:a.PERSONAL_SPACE_ID,teamName:null,tier:o.SpaceTier.Free,shouldDelete:!1})},95458:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isQuarantined=t.isPremiumStatusSpaceQuarantined=void 0;t.isPremiumStatusSpaceQuarantined=e=>e?.status&&"accepted"!==e.status.toLowerCase()&&e.info&&Array.isArray(e.info.teamDomains)&&e.info.teamDomains.length>0&&Boolean(e.info.removeForcedContentEnabled);t.isQuarantined=e=>e&&(0,t.isPremiumStatusSpaceQuarantined)(e.details)},7944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSpacesSelectors=t.anonymousSpaceIdsSelector=t.viewedSpaceSelector=t.viewedSpacesSelector=t.activeSpacesDetailsSelector=t.activeSpacesSelector=t.spacesSelector=void 0;const o=r(69105),a=r(664),i=r(88205),n="onboarding_web_disablepersonalspace_v2_dev";t.spacesSelector=e=>e.userSession?.spaceData?.spaces??[];t.activeSpacesSelector=e=>((0,t.spacesSelector)(e)||[]).filter((e=>e.details&&"accepted"===e.details.status));t.activeSpacesDetailsSelector=e=>(0,t.activeSpacesSelector)(e).map((e=>e.details));t.viewedSpacesSelector=(e,r)=>r&&(0,t.activeSpacesDetailsSelector)(e).length?(0,a.listView)([...(0,t.activeSpacesDetailsSelector)(e)]):(0,a.listView)([...(0,t.activeSpacesDetailsSelector)(e),(0,o.getDefaultPersonalSpace)()]);const s=async e=>{const{applicationModulesAccess:r,storeService:o}=e,a=o.getState(),s=(await(0,i.makeFeatureFlipsSelectors)(r).featureFlipsSelector())[n];return()=>(0,t.viewedSpacesSelector)(a,s)};t.viewedSpaceSelector=(e,r,o)=>(0,t.viewedSpacesSelector)(e,r).find((e=>e.spaceId===o));const c=async e=>{const{applicationModulesAccess:r}=e,o=(await(0,i.makeFeatureFlipsSelectors)(r).featureFlipsSelector())[n];return(e,r)=>(0,t.viewedSpaceSelector)(e,o,r)};t.anonymousSpaceIdsSelector=e=>e.userSession.personalSettings.SpaceAnonIds;t.makeSpacesSelectors=async e=>({viewedSpacesSelector:await s(e),viewedSpaceSelector:await c(e)})},664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;t.itemView=({color:e,letter:t,info:r,teamId:o,isSSOUser:a})=>({spaceId:o,displayName:r.name??"",color:e,letter:t,settings:{enableForcedCategorization:r.forcedDomainsEnabled,spaceForcedDomains:r.teamDomains},isSSOUser:a});t.listView=e=>e.map(t.itemView)},16458:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultConfig=void 0;const o=r(98518),a=r(56316);t.vaultConfig={commands:{disableVaultItemProtection:{handler:o.disableVaultProtectionHandler}},queries:{getAutofillProtectionContext:{selector:a.autofillProtectionContextSelector}},liveQueries:{}}},15874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VaultItemDisableProtectionMode=void 0,function(e){e[e.CannotDisable=0]="CannotDisable",e[e.DisableSpecificVaultItem=1]="DisableSpecificVaultItem",e[e.DisableGeneralSetting=2]="DisableGeneralSetting"}(t.VaultItemDisableProtectionMode||(t.VaultItemDisableProtectionMode={}))},98518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVaultProtectionHandler=void 0;const o=r(19736),a=r(17250),i=r(18344),n=r(16593);t.disableVaultProtectionHandler=async(e,t)=>{const r=e.storeService.getState();if((0,o.credentialSelector)(r,t)){if((0,n.protectPasswordsSettingSelector)(r))return void(0,a.updateProtectPasswordsSettingHandler)(e,!1);(0,i.disableCredentialProtection)(e,t)}}},56316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.autofillProtectionContextSelector=void 0;const o=r(38250),a=r(19736),i=r(27147),n=r(58235),s=r(43767),c=r(81846),l=r(16593);t.autofillProtectionContextSelector=(e,t)=>{if(!t)return{disableMode:o.VaultItemDisableProtectionMode.CannotDisable,isProtected:!1};const r=(0,c.areProtectedItemsUnlockedSelector)(e);if((0,n.paymentCardSelector)(e,t))return{disableMode:o.VaultItemDisableProtectionMode.CannotDisable,isProtected:(0,s.securedDataAutofillCreditcardSelector)(e)&&!r};if((0,i.socialSecurityIdSelector)(e,t))return{disableMode:o.VaultItemDisableProtectionMode.CannotDisable,isProtected:(0,s.securedDataAutofillCreditcardSelector)(e)&&!r};const d=(0,a.credentialSelector)(e,t);if(d){return(0,l.protectPasswordsSettingSelector)(e)?{disableMode:o.VaultItemDisableProtectionMode.DisableGeneralSetting,isProtected:!r}:{disableMode:o.VaultItemDisableProtectionMode.DisableSpecificVaultItem,isProtected:d.AutoProtected&&!r}}return{disableMode:o.VaultItemDisableProtectionMode.CannotDisable,isProtected:!1}}},70660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(76235);t.bootstrap=e=>{e.register(o.config)}},78163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computeAndSendCSVImportActivityLog=t.computeAndSendDeletedCredentialActivityLog=t.computeAndSendModifiedCredentialActivityLog=t.computeAndSendCreatedCredentialActivityLog=t.shouldSendCreateOrModifiedCredentialActivityLog=t.hasVaultAuditLogsFFActivated=t.notifySharersOnUpdate=t.makeNewPersonalDataItemBase=t.makeUpdatedPersonalDataItemBase=void 0;const o=r(16516),a=r(18948),i=r(28354),n=r(53576),s=r(61475),c=r(97494),l=r(21178),d=r(10294),u=r(98892),p=r(58107),S=r(36513),g=r(56915),m=r(53),y=r(78320),h=r(10360),v=r(92310),f=r(11700),A=r(16593),P=r(70252),b=r(88205);function w(e){const t=(0,o.defaultTo)(""),r="MANUAL"===e.updatedItem.origin?{UserModificationDatetime:e.itemUpdateDate}:{};return{LocaleFormat:(0,h.getLocaleFormat)(e.existingItem,e.updatedItem),SpaceId:t(e.updatedItem.content.spaceId),Attachments:e.updatedItem.attachments,...r}}async function T(e){return(await(0,b.makeFeatureFlipsSelectors)(e).featureFlipsSelector()).audit_logs_vault}function _(e){return async(t,r)=>{const o={domain_url:new l.ParsedURL(r.domainUrl).getRootDomain()??""},a={import_count:r.importCount??0},n={category:c.ActivityLogCategory.VaultPasswords,log_type:e,properties:e===c.ActivityLogType.UserImportedCredentials?a:o,is_sensitive:e!==c.ActivityLogType.UserImportedCredentials||void 0,date_time:(new Date).getTime(),schema_version:"1.0.0",uuid:`{${(0,i.v4)().toUpperCase()}}`};await t.createClients().activityLogs.commands.storeActivityLogs({activityLogs:[n]})}}t.makeUpdatedPersonalDataItemBase=w,t.makeNewPersonalDataItemBase=function(e,t=(0,m.getUnixTimestamp)()){return{kwType:e.kwType,Id:(0,y.generateItemUuid)(),AnonId:(0,y.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,...w({updatedItem:e,itemUpdateDate:t})}},t.notifySharersOnUpdate=async function(e,t,r){const o=(0,d.makeItemService)(),i=(0,u.makeItemWS)(),n=e.getSharingData(),c=e.getUserLogin(),l=(0,g.ukiSelector)(e.getState()),{privateKey:m}=e.getUserSession().keyPair,y=(n.items||[]).find((e=>e.itemId===t.Id));if(!y)return;if(r)try{const{queries:e}=r.createClients().sharingCollections,t=await(0,a.firstValueFrom)(e.getSharedCollections());n.collections=(0,s.isSuccess)(t)&&Array.isArray(t.data)?t.data:[]}catch(e){const t=new Error(`[SharingSync] - getSharedCollections failed: ${e}`);(0,P.sendExceptionLog)({error:t})}const h=(n.itemGroups||[]).find((e=>(e.items||[]).map((e=>e.itemId)).includes(t.Id)));if(!h)throw new Error("ItemGroup containing item not found in sharingData");const{timestamp:v}=y,f=await(0,p.getItemGroupKey)(h,n.userGroups,m,c,n.collections);if(!f)throw new Error("Could not decipher itemGroupKey for itemGroup");const A=h.items.find((e=>e.itemId===t.Id));if(!A)throw new Error("Could not find itemKey for item in itemGroup");const b=await(0,S.makeSymmetricEncryption)().decryptAES256(f,A.itemKey),w=await o.makeUpdateItemEvent(v,b,{item:t});return i.updateItem(c,l,w)},t.hasVaultAuditLogsFFActivated=T,t.shouldSendCreateOrModifiedCredentialActivityLog=function(e,t,r,o){const a=(0,v.currentTeamIdSelector)(e.getState()),i=(0,A.activeSpacesSelector)(e.getState())[0],s=(0,f.isItemToForceCategorize)(r,i);return T(t)&&o!==n.SaveOrigin.IMPORT&&(r.SpaceId===a||s)},t.computeAndSendCreatedCredentialActivityLog=_(c.ActivityLogType.UserCreatedCredential),t.computeAndSendModifiedCredentialActivityLog=_(c.ActivityLogType.UserModifiedCredential),t.computeAndSendDeletedCredentialActivityLog=_(c.ActivityLogType.UserDeletedCredential),t.computeAndSendCSVImportActivityLog=_(c.ActivityLogType.UserImportedCredentials)},99293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;const o=r(38390);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return o.setupSubscriptions}});var a=r(70660);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},97006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLiveSelectorGetter=void 0;const o=r(32034),a=r(63566),i=r(24589);t.makeLiveSelectorGetter=(e,t,r,n)=>s=>(0,o.createSelector)(e,n,r,t,((e,t,r,o)=>(0,a.viewListResults)(o)((0,i.applyQuery)(r,t,s,e))))},40602:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutQuarantinedItems=t.itemIsNotQuarantined=void 0;t.itemIsNotQuarantined=(e,t)=>{const r=((e,t)=>{const r=t.find((t=>t.details&&t.teamId===e.SpaceId));return r?r.details:null})(t,e);return!r||!((e,t)=>e.SpaceId===t.teamId)(t,r)};t.filterOutQuarantinedItems=(e,r)=>{if(0===r.length)return e;return e.filter((e=>(0,t.itemIsNotQuarantined)(r,e)))}},24589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyQuery=t.getQuerySelector=void 0;const o=r(35893),a=r(32541);t.getQuerySelector=(e,r,o)=>(a,i)=>{const n=e(a),s=o(a),c=r(a);return(0,t.applyQuery)(c,s,i,n)};t.applyQuery=(e,t,r,i)=>{const{sortToken:n,filterToken:s,limit:c}=r,l=(r=>(0,o.filterData)(t,e,s,r))(i),d=(e=>(0,a.sortData)(t,n,e))(l);return{items:c?d.slice(0,c):d,matchingCount:d.length}}},10360:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getValidState=t.isProposedLocaleLocalized=t.getLocaleFormat=void 0;const o=r(53576),a=r(38495),i=r(86056),n=r(95623);function s(e){return!!o.Country[e]&&[o.Country.NO_TYPE,o.Country.UNIVERSAL].every((t=>t!==e))}t.getLocaleFormat=function(e,t){if(!o.isObjectLocalized(t))return o.Country.UNIVERSAL;const r=o.Country[t.content.localeFormat],a=s(r),n=e&&e.LocaleFormat?e.LocaleFormat:o.Country[(0,i.getPlatformInfo)().country]||o.Country.US;return r&&a?r:n},t.isProposedLocaleLocalized=s,t.getValidState=function(e,t){return(0,a.isStateValid)(e,t)?t:(n.default.log(`[Data] Given value (${t}) is not a valid state value for country code ${e}`),"")}},38390:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(67631),a=r(79405),i=r(8566);t.setupSubscriptions=async function(e,t){(0,o.setupSubscriptions)(e,t),(0,a.setupSubscriptions)(e,t),(0,i.setupSubscriptions)(e,t)}},72883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDataKeyVaultItem=t.PERSONAL_DATA_META_DATA=void 0,t.PERSONAL_DATA_META_DATA=["changeHistories","changesToUpload","generatedPasswords","securityBreaches","securityBreachesMetadata","breachesUpdaterStatus","versionedBreaches","secureFileInfo","noteCategories","paypalAccounts"],t.isDataKeyVaultItem=function(e){return!t.PERSONAL_DATA_META_DATA.includes(e)}},23136:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultSpaceId=t.getCurrentItems=t.getDebounceSync=t.WAIT_MS_BEFORE_SYNC=t.nextTick=void 0,t.nextTick=r(28255);const o=r(88205),a=r(63311),i=r(95623),n=r(58639),s=r(84977),c=r(26634),l=r(49901),d=r(7944);t.WAIT_MS_BEFORE_SYNC=6e4;t.getDebounceSync=(e,r)=>(0,a.debounce)((o=>{i.Debugger.log("DebounceSync called => informClientsAndSyncPersonalDataChange()"),function(e,r,o){(0,n.reportDataUpdate)(e),(0,t.nextTick)((()=>{r.getInstance().user.attemptSync(o)}))}(e,r,o)}),t.WAIT_MS_BEFORE_SYNC);t.getCurrentItems=(e,t)=>{const r=s.default[e];return t?.[r]||[]};t.getDefaultSpaceId=async(e,t)=>{const r=t.getState(),a=(await(0,o.makeFeatureFlipsSelectors)(e).featureFlipsSelector()).onboarding_web_disablepersonalspace_v2_dev&&!(0,c.isPersonalSpaceEnabledSelector)(r),i=(0,d.activeSpacesSelector)(r)[0];return a?i.teamId:l.PERSONAL_SPACE_ID}},82043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.maybeDataModelDetailView=t.dataModelDetailView=t.dataModelItemView=void 0;const r=e=>({id:e.Id});t.dataModelItemView=e=>({...r(e),anonId:e.AnonId,hasAttachments:Array.isArray(e.Attachments)&&e.Attachments.length>0,kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});const o=e=>({id:e.Id});t.dataModelDetailView=e=>({...o(e),anonId:e.AnonId,attachments:e.Attachments||[],kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.maybeDataModelDetailView=e=>t=>t?e(t):void 0},8581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(5600),a=r(56915);t.config={commands:{},queries:{getAnonymousComputerId:{selector:o.anonymousComputerIdSelector},getPlatformInfo:{selector:a.platformInfoSelector}},liveQueries:{}}},9486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerABTestingChanged=void 0;const o=r(19697);t.triggerABTestingChanged=function(e){(0,o.default)().abTestingChanged({version:e.version})}},88322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadAnonymousApplicationId=t.ANONYMOUS_APPLICATION_ID_KEY=void 0;const o=r(28354),a=r(93564),i=r(95623),n=r(70252),s=r(12995);async function c(e){const r=e.getLocalStorage();if(await r.itemExists(t.ANONYMOUS_APPLICATION_ID_KEY)){const e=await r.readItem(t.ANONYMOUS_APPLICATION_ID_KEY);if("string"==typeof e)return e}const i=await async function(e){const r=(0,a.getWindowLocalStorage)();if(!r)return null;const o=r.getItem(t.ANONYMOUS_APPLICATION_ID_KEY);if(!o)return null;const i=o.replaceAll('"',"");return await e.writeItem(t.ANONYMOUS_APPLICATION_ID_KEY,i),i}(r);return i||(0,o.v4)()}t.ANONYMOUS_APPLICATION_ID_KEY="anonymousApplicationId";t.loadAnonymousApplicationId=async(e,t)=>{(0,i.log)({message:"Load anonymousApplicationId"});try{const r=await c(e);(0,i.logInfo)({message:"anonymousApplicationId has been fetched successfully"}),t.dispatch((0,s.loadedAnonymousComputerId)(r))}catch(e){const t=`An error occurred when trying to load anonymousApplicationId ${e} `;(0,n.sendExceptionLog)({message:t})}}},91122:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchStateUpdated=void 0;const o=r(5307);t.killswitchStateUpdated=e=>({type:o.KILLSWITCH_STATE_UPDATED,killswitchState:e})},73651:(e,t)=>{function r(){return{disableAutofill:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyKillswitchState=void 0,t.getEmptyKillswitchState=r,t.default=(e={disableAutofill:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1},t)=>({...e,...t.killswitchState})},5307:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KILLSWITCH_STATE_UPDATED=void 0,t.KILLSWITCH_STATE_UPDATED="KILLSWITCH_STATE_UPDATED"},53439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedDeviceKeys=void 0,t.blacklistedDeviceKeys=["remoteFile"]},3163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(8581);t.bootstrap=e=>{e.register(o.config)}},55861:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(3163);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},19399:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureDeviceName=void 0,t.secureDeviceName=function(e){return e?e.replace(/https?:\/\//g," "):e}},5600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousComputerIdSelector=void 0;const o=r(2246);t.anonymousComputerIdSelector=()=>(0,o.getCommonAppSetting)("anonymousComputerId")},12787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBusConnectors=void 0;const o=r(71796);t.EventBusConnectors={sessionOpened:(0,o.slot)(),syncFailure:(0,o.slot)(),syncSuccess:(0,o.slot)(),teamSpaceContentControlDone:(0,o.slot)(),sessionClosed:(0,o.slot)(),familyMemberLeft:(0,o.slot)(),remoteFileChanged:(0,o.slot)(),appInitialized:(0,o.slot)(),coreServicesReady:(0,o.slot)()}},73297:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventBusService=void 0;const i=r(71796),n=r(12787);t.makeEventBusService=()=>(0,i.createEventBus)({events:n.EventBusConnectors}),a(r(6775),t)},6775:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28207:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonEventHooks=void 0;const o=r(49352);t.carbonEventHooks={iconsUpdates:o.iconsUpdatesHook}},15660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCarbonEventStore=void 0,t.defaultCarbonEventStore={iconsUpdates:[]}},86691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const o=r(42898),a=r(28207);let i=null;t.setInstance=e=>{i=new o.EventStoreConsumer(e,a.carbonEventHooks)};t.getInstance=()=>{if(!i)throw new Error("Cannot get EventStoreConsumer instance");return i};t.clearInstance=()=>{i&&i.teardown(),i=null}},12362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let r=null;t.setInstance=e=>{r=e};t.getInstance=()=>{if(!r)throw new Error("Cannot get EventStore instance");return r};t.clearInstance=()=>{r&&r.teardown(),r=null}},46414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(8821),a=r(306),i=r(99319);t.config={commands:{joinFamily:{handler:o.joinFamilyRequest},leaveFamily:{handler:i.leaveFamilyRequest},removeFamilyMember:{handler:o.removeFamilyMemberRequest},resetFamilyJoinToken:{handler:o.resetFamilyJoinTokenRequest},getFamilyDetails:{handler:a.getFamilyDetailsRequest}},queries:{},liveQueries:{}}},96463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FamilyRenewalPlatform=t.FamilyMemberRole=t.FamilyStatusCode=t.JoinFamilyUserStatus=void 0;var o=r(38443);Object.defineProperty(t,"JoinFamilyUserStatus",{enumerable:!0,get:function(){return o.JoinFamilyUserStatus}}),Object.defineProperty(t,"FamilyStatusCode",{enumerable:!0,get:function(){return o.FamilyStatusCode}}),Object.defineProperty(t,"FamilyMemberRole",{enumerable:!0,get:function(){return o.FamilyMemberRole}}),Object.defineProperty(t,"FamilyRenewalPlatform",{enumerable:!0,get:function(){return o.FamilyRenewalPlatform}})},59047:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(46414);t.bootstrap=e=>{e.register(o.config)}},49409:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0,a(r(96463),t);var i=r(59047);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},306:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFamilyDetailsRequest=void 0;const o=r(38443),a=r(66374),i=r(95623),n=r(46298),s=r(16593),c=r(4933);t.getFamilyDetailsRequest=async function(e){const{storeService:t}=e,r=(0,s.userLoginSelector)(t.getState());try{const e=await(0,n.getFamilyDetails)(t,r);if((0,n.isApiError)(e))return{success:!1,error:{code:(0,n.getCode)(e.code,[c.UserMustBeFamilyAdmin])}};const{name:i,id:s,joinToken:l,statusCode:d,members:u,maxMembers:p}=e;return{success:!0,response:{name:i,id:s,joinToken:l,statusCode:d,members:{admin:(0,a.getAdmin)(u),regular:(0,a.getMembersByRole)(u,o.FamilyMemberRole.REGULAR),removed:(0,a.getMembersByRole)(u,o.FamilyMemberRole.REMOVED)},spots:(0,a.getSpots)(u,p)}}}catch(e){return i.Debugger.error(`[Family] getFamilyDetailsRequest - Failed: ${e}`),{success:!1,error:{code:n.UnknownError}}}}},66374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpots=t.getMembersCount=t.getMembersByRole=t.getAdmin=void 0;const o=r(38443);function a(e,t){return e.filter((e=>e.role===t))}function i(e){return a(e,o.FamilyMemberRole.ADMIN).length+a(e,o.FamilyMemberRole.REGULAR).length}t.getAdmin=function(e){return e.find((e=>e.role===o.FamilyMemberRole.ADMIN))},t.getMembersByRole=a,t.getMembersCount=i,t.getSpots=function(e,t){return t-i(e)}},3698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRenewalInformation=void 0;const o=r(38443),a=r(46298);t.getRenewalInformation=e=>{if(!e||e.state===a.FamilyStopRenewalState.STOPPED)return{showRenewalMessage:!1};const t=(r=e.platform)===a.FamilyStopRenewalPlatform.IOS_APP_STORE?o.FamilyRenewalPlatform.IOS_APP_STORE:r===a.FamilyStopRenewalPlatform.MAC_STORE?o.FamilyRenewalPlatform.MAC_STORE:r===a.FamilyStopRenewalPlatform.PLAY_STORE?o.FamilyRenewalPlatform.PLAY_STORE:null;var r;return t?{showRenewalMessage:!0,platform:t}:{showRenewalMessage:!1}}},68385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserStatus=void 0;const o=r(53576),a=r(38443);t.getUserStatus=(e,t)=>{switch(e){case o.PremiumStatusCode.NEW_USER:return a.JoinFamilyUserStatus.NEW_USER;case o.PremiumStatusCode.NO_PREMIUM:return t?a.JoinFamilyUserStatus.EXISTING_FREE_USER:a.JoinFamilyUserStatus.NEW_USER;case o.PremiumStatusCode.OLD_ACCOUNT:return a.JoinFamilyUserStatus.EXISTING_FREE_USER;case o.PremiumStatusCode.PREMIUM:case o.PremiumStatusCode.PREMIUM_CANCELLED:return a.JoinFamilyUserStatus.EXISTING_PREMIUM_USER;default:throw new Error("Family getUserStatus: impossible to identify user status")}}},8821:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(50794),t),a(r(98995),t),a(r(49828),t)},50794:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.joinFamilyRequest=void 0;const o=r(95623),a=r(46298),i=r(68385),n=r(3698),s=r(4933);t.joinFamilyRequest=async function(e,t){const{storeService:r}=e,{login:c,joinToken:l}=t;try{const e=await(0,a.joinFamily)(r,{login:c,joinToken:l});if((0,a.isApiError)(e))return{success:!1,error:{code:(0,a.getCode)(e.code,s.joinFamilyErrors)}};const{name:t,userExists:o,statusCode:d,stopRenewalResult:u}=e,p=(0,n.getRenewalInformation)(u);return{success:!0,response:{name:t,userExists:o,userStatus:(0,i.getUserStatus)(d,o),renewalInformation:p}}}catch(e){return o.Debugger.error(`[Family] joinFamilyRequest - Failed: ${e}`),{success:!1,error:{code:a.UnknownError}}}}},99319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.leaveFamilyRequest=void 0;const o=r(95623),a=r(46298),i=r(16593),n=r(4933);t.leaveFamilyRequest=async function(e){const{storeService:t,eventBusService:r}=e,s=(0,i.userLoginSelector)(t.getState());try{const e=await(0,a.leaveFamily)(t,s);return(0,a.isApiError)(e)?{success:!1,error:{code:(0,a.getCode)(e.code,n.leaveFamilyErrors)}}:(r.familyMemberLeft(),{success:!0,response:{}})}catch(e){return o.Debugger.error(`[Family] leaveFamilyRequest - Failed: ${e}`),{success:!1,error:{code:a.UnknownError}}}}},98995:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeFamilyMemberRequest=void 0;const o=r(95623),a=r(46298),i=r(16593),n=r(4933);t.removeFamilyMemberRequest=async function(e,t){const{storeService:r}=e,s=(0,i.userLoginSelector)(r.getState());try{const e=await(0,a.removeFamilyMember)(r,s,{userId:t.userId});return(0,a.isApiError)(e)?{success:!1,error:{code:(0,a.getCode)(e.code,n.removeFamilyMemberErrors)}}:{success:!0,response:{}}}catch(e){return o.Debugger.error(`[Family] removeFamilyMemberRequest - Failed: ${e}`),{success:!1,error:{code:a.UnknownError}}}}},49828:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetFamilyJoinTokenRequest=void 0;const o=r(95623),a=r(46298),i=r(16593),n=r(4933);t.resetFamilyJoinTokenRequest=async function(e){const{storeService:t}=e,r=(0,i.userLoginSelector)(t.getState());try{const e=await(0,a.resetFamilyJoinToken)(t,r);if((0,a.isApiError)(e))return{success:!1,error:{code:(0,a.getCode)(e.code,[n.UserMustBeFamilyAdmin])}};const{joinToken:o}=e;return{success:!0,response:{joinToken:o}}}catch(e){return o.Debugger.error(`[Family] resetFamilyJoinTokenRequest - Failed: ${e}`),{success:!1,error:{code:a.UnknownError}}}}},38443:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FamilyRenewalPlatform=t.FamilyMemberRole=t.FamilyStatusCode=t.JoinFamilyUserStatus=void 0,function(e){e.NEW_USER="NEW_USER",e.EXISTING_FREE_USER="EXISTING_FREE_USER",e.EXISTING_PREMIUM_USER="EXISTING_PREMIUM_USER"}(t.JoinFamilyUserStatus||(t.JoinFamilyUserStatus={})),function(e){e[e.DISCONTINUED=0]="DISCONTINUED",e[e.PREMIUM=1]="PREMIUM",e[e.PREMIUM_PLUS=2]="PREMIUM_PLUS"}(t.FamilyStatusCode||(t.FamilyStatusCode={})),function(e){e.ADMIN="admin",e.REGULAR="regular",e.REMOVED="removed"}(t.FamilyMemberRole||(t.FamilyMemberRole={})),function(e){e.IOS_APP_STORE="ios",e.MAC_STORE="mac",e.PLAY_STORE="playstore"}(t.FamilyRenewalPlatform||(t.FamilyRenewalPlatform={}))},57362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(88205);t.config={commands:{},queries:{getHasFeature:{selectorFactory:async e=>(await(0,o.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).getHasFeatureSelector},getFeatures:{selectorFactory:async e=>(await(0,o.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).featureFlipsSelector}},liveQueries:{}}},7279:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},72175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(57362);t.bootstrap=e=>{e.register(o.config)}},43542:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0,a(r(84846),t);var i=r(72175);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},88205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeFeatureFlipsSelectors=t.makeGetHasFeatureSelector=t.makeFeatureFlipsSelector=void 0;const o=r(18948),a=r(61475);t.makeFeatureFlipsSelector=e=>async()=>{const{queries:t}=e.createClients().featureFlips,r=await(0,o.firstValueFrom)(t.userFeatureFlips());return(0,a.isSuccess)(r)?r.data:{}};t.makeGetHasFeatureSelector=e=>async(t,r)=>{const{queries:i}=e.createClients().featureFlips,n=await(0,o.firstValueFrom)(i.userFeatureFlips());if((0,a.isSuccess)(n))return n.data[r]};t.makeFeatureFlipsSelectors=e=>({featureFlipsSelector:(0,t.makeFeatureFlipsSelector)(e),getHasFeatureSelector:(0,t.makeGetHasFeatureSelector)(e)})},84846:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(78671);t.config={commands:{setGlobalExtensionSettings:{handler:o.setGlobalExtensionSettings},getGlobalExtensionSettings:{handler:o.getGlobalExtensionSettings}},queries:{},liveQueries:{}}},17644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettingsState=t.SET_GLOBAL_EXTENSION_SETTINGS=void 0,t.SET_GLOBAL_EXTENSION_SETTINGS="SET_GLOBAL_EXTENSION_SETTINGS";t.setGlobalExtensionSettingsState=e=>({type:t.SET_GLOBAL_EXTENSION_SETTINGS,extensionSettings:e})},45316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;var o=r(22018);Object.defineProperty(t,"globalExtensionSettingsReducer",{enumerable:!0,get:function(){return o.globalExtensionSettingsReducer}})},22018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;const o=r(17644);t.globalExtensionSettingsReducer=(e={},t)=>t.type===o.SET_GLOBAL_EXTENSION_SETTINGS?Object.assign({},e,{extensionSettings:t.extensionSettings}):e},84838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(88485);t.bootstrap=e=>{e.register(o.config)}},78671:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettings=t.getGlobalExtensionSettings=void 0;const o=r(66102),a=r(17644),i=r(70252),n="consents",s={interactionDataConsent:"interactionData",personalDataConsent:"personalData"},c={interactionDataConsent:null,personalDataConsent:null};t.getGlobalExtensionSettings=async e=>{const t=e.storageService.getLocalStorage();try{return((e=null)=>{const t=JSON.parse(e);return!t||"object"!=typeof t||Array.isArray(t)?c:Object.values(s).every((e=>Object.prototype.hasOwnProperty.call(t,e)))?{interactionDataConsent:t[s.interactionDataConsent],personalDataConsent:t[s.personalDataConsent]}:c})(await t.readItem(n))}catch{return console.warn("failed parsing user consent values; proceeding as if they haven't been set."),{interactionDataConsent:null,personalDataConsent:null}}};t.setGlobalExtensionSettings=async(e,t)=>{const r=e.storageService.getLocalStorage();try{await r.writeItem(n,JSON.stringify({[s.interactionDataConsent]:t.interactionDataConsent,[s.personalDataConsent]:t.personalDataConsent})),e.storeService.dispatch((0,a.setGlobalExtensionSettingsState)(t)),(0,i.setAllowedToSendExceptionLog)(!1!==t.interactionDataConsent),(0,o.logToggleAnalyticsEvent)(e)}catch{return{success:!1}}return{success:!0}}},44389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(84838);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},64090:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(47975);t.config={commands:{evaluatePassword:{handler:o.evaluatePassword}},queries:{},liveQueries:{}}},45968:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},10925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;const o=r(55539);t.load=async e=>{const{data:t}=await(0,o.httpGetUsingFetch)(`${e}assets/frequency_lists.json`);return t}},47975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePassword=t.evaluatePasswordStrength=t.loadFrequencyLists=void 0;const o=r(85465),a=r(2646),i=r(10925);let n=()=>{};const s=new Promise((e=>{n=e}));t.loadFrequencyLists=async()=>{const e=(0,a.getPublicPath)(),t=await(0,i.load)(e);(0,o.setFrequencyLists)(t),n()};const c=async e=>(await s,(0,o.evaluate)(e));t.evaluatePasswordStrength=async e=>(await c(e)).score;t.evaluatePassword=async(e,t)=>{const{score:r,feedback:o}=await c(t.password);return{score:r,feedback:o}}},64948:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePasswordStrengthOutOfFive=void 0;const o=r(47975);t.evaluatePasswordStrengthOutOfFive=async e=>{if(e)return await(0,o.evaluatePasswordStrength)(e)/25}},61566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(64090);t.bootstrap=e=>{e.register(o.config)}},16359:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(61566);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})}}]);